!function(){if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");!function(){window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(t,i){var n="function"==typeof t?t():t;if(!n){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(s){i=i+", stack=\n"+s.stack}throw new Error("Assertion failed: "+i)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")}}();var t,i,n;!function(s){function e(t,i){return T.call(t,i)}function r(t,i){var n,s,e,r,h,o,m,a,u,c,f,l=i&&i.split("/"),x=w.map,d=x&&x["*"]||{};if(t&&"."===t.charAt(0))if(i){for(l=l.slice(0,l.length-1),t=t.split("/"),h=t.length-1,w.nodeIdCompat&&g.test(t[h])&&(t[h]=t[h].replace(g,"")),t=l.concat(t),u=0;u<t.length;u+=1)if(f=t[u],"."===f)t.splice(u,1),u-=1;else if(".."===f){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((l||d)&&x){for(n=t.split("/"),u=n.length;u>0;u-=1){if(s=n.slice(0,u).join("/"),l)for(c=l.length;c>0;c-=1)if(e=x[l.slice(0,c).join("/")],e&&(e=e[s])){r=e,o=u;break}if(r)break;!m&&d&&d[s]&&(m=d[s],a=u)}!r&&m&&(r=m,o=a),r&&(n.splice(0,o,r),t=n.join("/"))}return t}function h(t,i){return function(){return l.apply(s,M.call(arguments,0).concat([t,i]))}}function o(t){return function(i){return r(i,t)}}function m(t){return function(i){y[t]=i}}function a(t){if(e(v,t)){var i=v[t];delete v[t],p[t]=!0,f.apply(s,i)}if(!e(y,t)&&!e(p,t))throw new Error("No "+t);return y[t]}function u(t){var i,n=t?t.indexOf("!"):-1;return n>-1&&(i=t.substring(0,n),t=t.substring(n+1,t.length)),[i,t]}function c(t){return function(){return w&&w.config&&w.config[t]||{}}}var f,l,x,d,y={},v={},w={},p={},T=Object.prototype.hasOwnProperty,M=[].slice,g=/\.js$/;x=function(t,i){var n,s=u(t),e=s[0];return t=s[1],e&&(e=r(e,i),n=a(e)),e?t=n&&n.normalize?n.normalize(t,o(i)):r(t,i):(t=r(t,i),s=u(t),e=s[0],t=s[1],e&&(n=a(e))),{f:e?e+"!"+t:t,n:t,pr:e,p:n}},d={require:function(t){return h(t)},exports:function(t){var i=y[t];return"undefined"!=typeof i?i:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:c(t)}}},f=function(t,i,n,r){var o,u,c,f,l,w,T=[],M=typeof n;if(r=r||t,"undefined"===M||"function"===M){for(i=!i.length&&n.length?["require","exports","module"]:i,l=0;l<i.length;l+=1)if(f=x(i[l],r),u=f.f,"require"===u)T[l]=d.require(t);else if("exports"===u)T[l]=d.exports(t),w=!0;else if("module"===u)o=T[l]=d.module(t);else if(e(y,u)||e(v,u)||e(p,u))T[l]=a(u);else{if(!f.p)throw new Error(t+" missing "+u);f.p.load(f.n,h(r,!0),m(u),{}),T[l]=y[u]}c=n?n.apply(y[t],T):void 0,t&&(o&&o.exports!==s&&o.exports!==y[t]?y[t]=o.exports:c===s&&w||(y[t]=c))}else t&&(y[t]=n)},t=i=l=function(t,i,n,e,r){if("string"==typeof t)return d[t]?d[t](i):a(x(t,i).f);if(!t.splice){if(w=t,w.deps&&l(w.deps,w.callback),!i)return;i.splice?(t=i,i=n,n=null):t=s}return i=i||function(){},"function"==typeof n&&(n=e,e=r),e?f(s,t,i,n):setTimeout(function(){f(s,t,i,n)},4),l},l.config=function(t){return l(t)},t._defined=y,n=function(t,i,n){i.splice||(n=i,i=[]),e(y,t)||e(v,t)||(v[t]=[t,i,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("PHET_CORE/core",["require"],function(){return{}}),n("PHET_CORE/phetAllocation",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.phetAllocation=function(t){if(window.alloc){var i;try{throw new Error}catch(n){i=n.stack}window.alloc[t]||(window.alloc[t]={count:0,stacks:{}});var s=window.alloc[t];s.count++,s.stacks[i]?s.stacks[i]+=1:s.stacks[i]=1,s.report=function(){var t=Object.keys(s.stacks);t=_.sortBy(t,function(t){return s.stacks[t]}),_.each(t,function(t){console.log(s.stacks[t]+": "+t)})}}},i.phetAllocation}),n("DOT/dot",["require","PHET_CORE/phetAllocation"],function(t){window.phetAllocation=t("PHET_CORE/phetAllocation"),window.arch=window.arch||null;var i=function n(){switch(arguments.length){case 2:return new n.Vector2(arguments[0],arguments[1]);case 3:return new n.Vector3(arguments[0],arguments[1],arguments[2]);case 4:return new n.Vector4(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw new Error("dot takes 2-4 arguments")}};return i.FastArray=window.Float64Array?window.Float64Array:window.Array,window.phet&&(window.phet.dot=i),i}),n("PHET_CORE/extend",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.extend=function(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var n in i)Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}),t},i.extend}),n("PHET_CORE/Poolable",["require","PHET_CORE/core","PHET_CORE/extend"],function(t){var i=t("PHET_CORE/core"),n=t("PHET_CORE/extend");return i.Poolable={mixin:function(t,i){var s=t.prototype;i=n({maxPoolSize:50,initialSize:0},i);var e=t.pool=[];i.defaultFactory&&(t.dirtyFromPool=function(){return e.length?e.pop():i.defaultFactory()},t.fillPool=function(t){for(;e.length<t;)e.push(i.defaultFactory())},t.fillPool(i.initialSize)),i.constructorDuplicateFactory&&(t.createFromPool=i.constructorDuplicateFactory(e)),s.freeToPool=function(){e.length<i.maxPoolSize&&e.push(this)}}},i.Poolable}),n("PHET_CORE/inherit",["require","PHET_CORE/core","PHET_CORE/extend"],function(t){var i=t("PHET_CORE/core"),n=t("PHET_CORE/extend");return i.inherit=function(t,i,s,e){function r(){}return r.prototype=t.prototype,i.prototype=n(new r,{constructor:i},s),n(i,e),i},i.inherit}),n("DOT/Util",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Util={testAssert:function(){return"assert.dot: false"},clamp:function(t,i,n){return i>t?i:t>n?n:t},moduloBetweenDown:function(t,i,n){var s=n-i,e=(t-i)%s;return 0>e&&(e+=s),e+i},moduloBetweenUp:function(t,i,s){return-n.moduloBetweenDown(-t,-s,-i)},rangeInclusive:function(t,i){if(t>i)return[];for(var n=new Array(i-t+1),s=t;i>=s;s++)n[s-t]=s;return n},rangeExclusive:function(t,i){return n.rangeInclusive(t+1,i-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},gcd:function(t,i){return 0===i?t:this.gcd(i,t%i)},lineLineIntersection:function(t,n,s,e){var r=t.x-n.x,h=s.x-e.x,o=t.y-n.y,m=s.y-e.y,a=r*m-o*h,u=t.x*n.y-t.y*n.x,c=s.x*e.y-s.y*e.x;return new i.Vector2((u*h-r*c)/a,(u*m-o*c)/a)},sphereRayIntersection:function(t,n,s){s=void 0===s?1e-5:s;var e=new i.Vector3,r=n.dir,h=n.pos,o=h.minus(e),m=r.dot(o),a=o.magnitudeSquared(),u=4*m*m-4*(a-t*t);if(s>u)return null;var c=r.dot(e)-r.dot(h),f=Math.sqrt(u)/2,l=c-f,x=c+f;if(s>x)return null;var d=n.pointAtDistance(x),y=d.minus(e).normalized();if(s>l)return{distance:x,hitPoint:d,normal:y.negated(),fromOutside:!1};var v=n.pointAtDistance(l),w=v.minus(e).normalized();return{distance:l,hitPoint:v,normal:w,fromOutside:!0}},solveQuadraticRootsReal:function(t,i,n){var s=1e7;if(0===t||Math.abs(i/t)>s||Math.abs(n/t)>s)return[-n/i];var e=i*i-4*t*n;if(0>e)return[];var r=Math.sqrt(e);return[(-i-r)/(2*t),(-i+r)/(2*t)]},solveCubicRootsReal:function(t,i,s,e){var r=1e7;if(0===t||Math.abs(i/t)>r||Math.abs(s/t)>r||Math.abs(e/t)>r)return n.solveQuadraticRootsReal(i,s,e);if(0===e||Math.abs(t/e)>r||Math.abs(i/e)>r||Math.abs(s/e)>r)return n.solveQuadraticRootsReal(t,i,s);i/=t,s/=t,e/=t;var h=(3*s-i*i)/9,o=(-(27*e)+i*(9*s-2*i*i))/54,m=h*h*h+o*o,a=i/3;if(m>0){var u=Math.sqrt(m);return[n.cubeRoot(o+u)+n.cubeRoot(o-u)-a]}if(0===m){var c=n.cubeRoot(o),f=a-c;return[-a+2*c,f,f]}var l=-h*h*h;l=Math.acos(o/Math.sqrt(l));var x=2*Math.sqrt(-h);return[-a+x*Math.cos(l/3),-a+x*Math.cos((l+2*Math.PI)/3),-a+x*Math.cos((l+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,i,n,s,e){return(s-n)/(i-t)*(e-t)+n},toFixed:function(t,i){var n=Math.pow(10,i),s=Math.round(t*n)/n;return s.toFixed(i)},toFixedNumber:function(t,i){return parseFloat(n.toFixed(t,i))},isInteger:function(t){return"number"==typeof t&&t%1===0},lineSegmentIntersection:function(t,n,s,e,r,h,o,m){var a=(o-r)*(n-h)-(m-h)*(t-r),u=(s-t)*(n-h)-(e-n)*(t-r),c=(m-h)*(s-t)-(o-r)*(e-n);if(0===c)return null;var f=a/c,l=u/c;if(f>=0&&1>=f&&l>=0&&1>=l){var x=t+f*(s-t),d=n+f*(e-n);return new i.Vector2(x,d)}return null},distToSegmentSquared:function(t,n,s){var e=n.distanceSquared(s);if(0===e)return t.distanceSquared(n);var r=((t.x-n.x)*(s.x-n.x)+(t.y-n.y)*(s.y-n.y))/e;return t.distanceSquared(0>r?n:r>1?s:new i.Vector2(n.x+r*(s.x-n.x),n.y+r*(s.y-n.y)))},distToSegment:function(t,i,n){return Math.sqrt(this.distToSegmentSquared(t,i,n))},arePointsCollinear:function(t,i,s,e){return void 0===e&&(e=0),n.triangleArea(t,i,s)<=e},triangleArea:function(t,i,s){return Math.abs(n.triangleAreaSigned(t,i,s))},triangleAreaSigned:function(t,i,n){return t.x*(i.y-n.y)+i.x*(n.y-t.y)+n.x*(t.y-i.y)},log10:function(t){return Math.log(t)/Math.LN10}};var n=i.Util;return i.testAssert=n.testAssert,i.clamp=n.clamp,i.moduloBetweenDown=n.moduloBetweenDown,i.moduloBetweenUp=n.moduloBetweenUp,i.rangeInclusive=n.rangeInclusive,i.rangeExclusive=n.rangeExclusive,i.toRadians=n.toRadians,i.toDegrees=n.toDegrees,i.lineLineIntersection=n.lineLineIntersection,i.sphereRayIntersection=n.sphereRayIntersection,i.solveQuadraticRootsReal=n.solveQuadraticRootsReal,i.solveCubicRootsReal=n.solveCubicRootsReal,i.cubeRoot=n.cubeRoot,i.linear=n.linear,n}),n("DOT/Vector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),i.Vector2=function(t,i){this.x=t||0,this.y=i||0};var e=i.Vector2;e.createPolar=function(t,i){return(new e).setPolar(t,i)},e.prototype={constructor:e,isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,i){var n=this.x-t,s=this.y-i;return Math.sqrt(n*n+s*s)},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n},distanceSquaredXY:function(t,i){var n=this.x-t,s=this.y-i;return n*n+s*s},dot:function(t){return this.x*t.x+this.y*t.y},dotXY:function(t,i){return this.x*t+this.y*i},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,i){return i||(i=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(t){return t?t.set(this):new e(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new e(this.x/t,this.y/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new e(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new e(this.x*t.x,this.y*t.y)},plus:function(t){return new e(this.x+t.x,this.y+t.y)},plusXY:function(t,i){return new e(this.x+t,this.y+i)},plusScalar:function(t){return new e(this.x+t,this.y+t)},minus:function(t){return new e(this.x-t.x,this.y-t.y)},minusXY:function(t,i){return new e(this.x-t,this.y-i)},minusScalar:function(t){return new e(this.x-t,this.y-t)},dividedScalar:function(t){return new e(this.x/t,this.y/t)},negated:function(){return new e(-this.x,-this.y)},angle:function(){return Math.atan2(this.y,this.x)},perpendicular:function(){return new e(this.y,-this.x)},angleBetween:function(t){var n=this.magnitude(),s=t.magnitude();return Math.acos(i.clamp((this.x*t.x+this.y*t.y)/(n*s),-1,1))},rotated:function(t){var i=this.angle()+t,n=this.magnitude();return new e(n*Math.cos(i),n*Math.sin(i))},blend:function(t,i){return new e(this.x+(t.x-this.x)*i,this.y+(t.y-this.y)*i)},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new i.Vector3(this.x,this.y)},setXY:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},set:function(t){return this.setXY(t.x,t.y)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXY(this.x+t.x,this.y+t.y)},addXY:function(t,i){return this.setXY(this.x+t,this.y+i)},addScalar:function(t){return this.setXY(this.x+t,this.y+t)},subtract:function(t){return this.setXY(this.x-t.x,this.y-t.y)},subtractScalar:function(t){return this.setXY(this.x-t,this.y-t)},multiplyScalar:function(t){return this.setXY(this.x*t,this.y*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXY(this.x*t.x,this.y*t.y)},divideScalar:function(t){return this.setXY(this.x/t,this.y/t)},negate:function(){return this.setXY(-this.x,-this.y)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},rotate:function(t){var i=this.angle()+t,n=this.magnitude();return this.setXY(n*Math.cos(i),n*Math.sin(i))},setPolar:function(t,i){return this.setXY(t*Math.cos(i),t*Math.sin(i))}},s.mixin(e,{defaultFactory:function(){return new e},constructorDuplicateFactory:function(t){return function(i,n){return t.length?t.pop().setXY(i,n):new e(i,n)}}}),e.Immutable=function(t,i){e.call(this,t,i)};var r=e.Immutable;return n(e,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},r.mutableOverrideHelper("setXY"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),e.ZERO=new r(0,0),e.X_UNIT=new r(1,0),e.Y_UNIT=new r(0,1),e}),n("DOT/Bounds2",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/Poolable");t("DOT/Vector2");var s=new i.Vector2;i.Bounds2=function(t,i,n,s){this.minX=t,this.minY=i,this.maxX=n,this.maxY=s};var e=i.Bounds2;return e.prototype={constructor:e,isBounds:!0,dimension:2,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getMinX:function(){return this.minX},get left(){return this.minX},getMinY:function(){return this.minY},get top(){return this.minY},getMaxX:function(){return this.maxX},get right(){return this.maxX},getMaxY:function(){return this.maxY},get bottom(){return this.maxY},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getLeftTop:function(){return new i.Vector2(this.minX,this.minY)},get leftTop(){return this.getLeftTop()},getCenterTop:function(){return new i.Vector2(this.getCenterX(),this.minY)},get centerTop(){return this.getCenterTop()},getRightTop:function(){return new i.Vector2(this.maxX,this.minY)},get rightTop(){return this.getRightTop()},getLeftCenter:function(){return new i.Vector2(this.minX,this.getCenterY())},get leftCenter(){return this.getLeftCenter()},getCenter:function(){return new i.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getRightCenter:function(){return new i.Vector2(this.maxX,this.getCenterY())},get rightCenter(){return this.getRightCenter()},getLeftBottom:function(){return new i.Vector2(this.minX,this.maxY)},get leftBottom(){return this.getLeftBottom()},getCenterBottom:function(){return new i.Vector2(this.getCenterX(),this.maxY)},get centerBottom(){return this.getCenterBottom()},getRightBottom:function(){return new i.Vector2(this.maxX,this.maxY)},get rightBottom(){return this.getRightBottom()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},minimumDistanceToPointSquared:function(t){var i,n=t.x<this.minX?this.minX:t.x>this.maxX?this.maxX:null,s=t.y<this.minY?this.minY:t.y>this.maxY?this.maxY:null;if(null===n&&null===s)return 0;if(null===n)return i=s-t.y,i*i;if(null===s)return i=n-t.x,i*i;var e=n-t.x,r=s-t.y;return e*e+r*r},maximumDistanceToPointSquared:function(t){var i=t.x>this.getCenterX()?this.minX:this.maxX,n=t.y>this.getCenterY()?this.minY:this.maxY;return i-=t.x,n-=t.y,i*i+n*n},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,i){i=i||0;var n=this.isFinite(),s=t.isFinite();return n&&s?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i:n!==s?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)},copy:function(t){return t?t.set(this):new e(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new e(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new e(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,i){return new e(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withMinX:function(t){return new e(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new e(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new e(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new e(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new e(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new e(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new e(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilatedX:function(t){return new e(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilatedY:function(t){return new e(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilatedXY:function(t,i){return new e(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedXY:function(t,i){return this.dilatedXY(-t,-i)},shiftedX:function(t){return new e(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new e(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,i){return new e(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},setMinMax:function(t,i,n,s){return this.minX=t,this.minY=i,this.maxX=n,this.maxY=s,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},addCoordinates:function(t,i){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},addPoint:function(t){return this.addCoordinates(t.x,t.y)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transform:function(t){if(this.isEmpty())return this;if(t.isIdentity())return this;var n=this.minX,e=this.minY,r=this.maxX,h=this.maxY;return this.set(i.Bounds2.NOTHING),this.addPoint(t.multiplyVector2(s.setXY(n,e))),this.addPoint(t.multiplyVector2(s.setXY(n,h))),this.addPoint(t.multiplyVector2(s.setXY(r,e))),this.addPoint(t.multiplyVector2(s.setXY(r,h))),this},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilateXY:function(t,i){return this.setMinMax(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeXY:function(t,i){return this.dilateXY(-t,-i)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.maxX,this.maxY+t)},shift:function(t,i){return this.setMinMax(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},getClosestPoint:function(t,n,s){return s?s.setXY(t,n):s=new i.Vector2(t,n),s.x<this.minX&&(s.x=this.minX),s.x>this.maxX&&(s.x=this.maxX),s.y<this.minY&&(s.y=this.minY),s.y>this.maxY&&(s.y=this.maxY),s}},e.rect=function(t,i,n,s){return new e(t,i,t+n,i+s)},e.point=function(t,n){if(t instanceof i.Vector2){var s=t;return new e(s.x,s.y,s.x,s.y)}return new e(t,n,t,n)},n.mixin(e,{defaultFactory:function(){return e.NOTHING.copy()},constructorDuplicateFactory:function(t){return function(i,n,s,r){return t.length?t.pop().setMinMax(i,n,s,r):new e(i,n,s,r)}}}),e.EVERYTHING=new e(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),e.NOTHING=new e(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),e}),n("DOT/Vector4",["require","DOT/dot","DOT/Util"],function(t){var i=t("DOT/dot");t("DOT/Util"),i.Vector4=function(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1};var n=i.Vector4;n.prototype={constructor:n,isVector4:!0,dimension:4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=i},copy:function(t){return t?t.set(this):new n(this.x,this.y,this.z,this.w)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t,this.w/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new n(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new i.Vector3(this.x,this.y,this.z)},setXYZW:function(t,i,n,s){return this.x=t,this.y=i,this.z=n,this.w=s,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},set:function(t){return this.setXYZW(t.x,t.y,t.z,t.w)},add:function(t){return this.setXYZW(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addScalar:function(t){return this.setXYZW(this.x+t,this.y+t,this.z+t,this.w+t)},subtract:function(t){return this.setXYZW(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subtractScalar:function(t){return this.setXYZW(this.x-t,this.y-t,this.z-t,this.w-t)},multiplyScalar:function(t){return this.setXYZW(this.x*t,this.y*t,this.z*t,this.w*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZW(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},divideScalar:function(t){return this.setXYZW(this.x/t,this.y/t,this.z/t,this.w/t)},negate:function(){return this.setXYZW(-this.x,-this.y,-this.z,-this.w)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)}},n.Immutable=function(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1};var s=n.Immutable;return s.prototype=new n,s.prototype.constructor=s,s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},s.mutableOverrideHelper("setXYZW"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),s.mutableOverrideHelper("setZ"),s.mutableOverrideHelper("setW"),n.ZERO=new s(0,0,0,0),n.X_UNIT=new s(1,0,0,0),n.Y_UNIT=new s(0,1,0,0),n.Z_UNIT=new s(0,0,1,0),n.W_UNIT=new s(0,0,0,1),n}),n("DOT/Vector3",["require","DOT/dot","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),i.Vector3=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0};var n=i.Vector3;n.prototype={constructor:n,isVector3:!0,dimension:3,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y,s=this.z-t.z;return i*i+n*n+s*s},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=i},copy:function(t){return t?t.set(this):new n(this.x,this.y,this.z)},cross:function(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t)},negated:function(){return new n(-this.x,-this.y,-this.z)},angleBetween:function(t){return Math.acos(i.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new i.Vector2(this.x,this.y)},toVector4:function(){return new i.Vector4(this.x,this.y,this.z)},setXYZ:function(t,i,n){return this.x=t,this.y=i,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},set:function(t){return this.setXYZ(t.x,t.y,t.z)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},addScalar:function(t){return this.setXYZ(this.x+t,this.y+t,this.z+t)},subtract:function(t){return this.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},subtractScalar:function(t){return this.setXYZ(this.x-t,this.y-t,this.z-t)},multiplyScalar:function(t){return this.setXYZ(this.x*t,this.y*t,this.z*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZ(this.x*t.x,this.y*t.y,this.z*t.z)},divideScalar:function(t){return this.setXYZ(this.x/t,this.y/t,this.z/t)},negate:function(){return this.setXYZ(-this.x,-this.y,-this.z)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)}},n.slerp=function(t,n,s){return i.Quaternion.slerp(new i.Quaternion,i.Quaternion.getRotationQuaternion(t,n),s).timesVector3(t)},n.Immutable=function(t,i,n){this.x=t||0,this.y=i||0,this.z=n||0};var s=n.Immutable;return s.prototype=new n,s.prototype.constructor=s,s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},s.mutableOverrideHelper("setXYZ"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),s.mutableOverrideHelper("setZ"),n.ZERO=new s(0,0,0),n.X_UNIT=new s(1,0,0),n.Y_UNIT=new s(0,1,0),n.Z_UNIT=new s(0,0,1),n}),n("DOT/Bounds3",["require","DOT/dot","DOT/Vector3"],function(t){var i=t("DOT/dot");t("DOT/Vector3"),i.Bounds3=function(t,i,n,s,e,r){this.minX=t,this.minY=i,this.minZ=n,this.maxX=s,this.maxY=e,this.maxZ=r};var n=i.Bounds3;return n.prototype={constructor:n,isBounds:!0,dimension:3,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getDepth:function(){return this.maxZ-this.minZ},get depth(){return this.getDepth()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getZ:function(){return this.minZ},get z(){return this.getZ()},getMinX:function(){return this.minX},get left(){return this.minX},getMinY:function(){return this.minY},get top(){return this.minY},getMinZ:function(){return this.minZ},get back(){return this.minZ},getMaxX:function(){return this.maxX},get right(){return this.maxX},getMaxY:function(){return this.maxY},get bottom(){return this.maxY},getMaxZ:function(){return this.maxZ},get front(){return this.maxZ
},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getCenterZ:function(){return(this.maxZ+this.minZ)/2},get centerZ(){return this.getCenterZ()},getCenter:function(){return new i.Vector3(this.getCenterX(),this.getCenterY(),this.getCenterZ())},get center(){return this.getCenter()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0||this.getDepth()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.minZ)&&isFinite(this.maxX)&&isFinite(this.maxY)&&isFinite(this.maxZ)},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i,n){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY&&this.minZ<=n&&n<=this.maxZ},containsPoint:function(t){return this.containsCoordinates(t.x,t.y,t.z)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY&&this.minZ<=t.minZ&&this.maxZ>=t.maxZ},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+"),z:("+this.minZ+","+this.maxZ+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.minZ===t.minZ&&this.maxX===t.maxX&&this.maxY===t.maxY&&this.maxZ===t.maxZ},equalsEpsilon:function(t,i){i=i||0;var n=this.isFinite(),s=t.isFinite();return n&&s?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.minZ-t.minZ)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i&&Math.abs(this.maxZ-t.maxZ)<i:n!==s?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.minZ+t.minZ)?Math.abs(this.minZ-t.minZ)<i:this.minZ===t.minZ)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)&&(isFinite(this.maxZ+t.maxZ)?Math.abs(this.maxZ-t.maxZ)<i:this.maxZ===t.maxZ)},copy:function(t){return t?t.set(this):new n(this.minX,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},union:function(t){return new n(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},intersection:function(t){return new n(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},withCoordinates:function(t,i,s){return new n(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,s),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,s))},withPoint:function(t){return this.withCoordinates(t.x,t.y,t.z)},withMinX:function(t){return new n(t,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinY:function(t){return new n(this.minX,t,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinZ:function(t){return new n(this.minX,this.minY,t,this.maxX,this.maxY,this.maxZ)},withMaxX:function(t){return new n(this.minX,this.minY,this.minZ,t,this.maxY,this.maxZ)},withMaxY:function(t){return new n(this.minX,this.minY,this.minZ,this.maxX,t,this.maxZ)},withMaxZ:function(t){return new n(this.minX,this.minY,this.minZ,this.maxX,this.maxY,t)},roundedOut:function(){return new n(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundedIn:function(){return new n(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new n(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilatedX:function(t){return new n(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilatedY:function(t){return new n(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilatedZ:function(t){return new n(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilatedXYZ:function(t,i,s){return new n(this.minX-t,this.minY-i,this.minZ-s,this.maxX+t,this.maxY+i,this.maxZ+s)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedZ:function(t){return this.dilatedZ(-t)},erodedXYZ:function(t,i,n){return this.dilatedXYZ(-t,-i,-n)},shiftedX:function(t){return new n(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftedY:function(t){return new n(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftedZ:function(t){return new n(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shifted:function(t,i,s){return new n(this.minX+t,this.minY+i,this.minZ+s,this.maxX+t,this.maxY+i,this.maxZ+s)},setMinMax:function(t,i,n,s,e,r){return this.minX=t,this.minY=i,this.minZ=n,this.maxX=s,this.maxY=e,this.maxZ=r,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMinZ:function(t){return this.minZ=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},setMaxZ:function(t){return this.maxZ=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.minZ,t.maxX,t.maxY,t.maxZ)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},addCoordinates:function(t,i,n){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,n),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,n))},addPoint:function(t){return this.addCoordinates(t.x,t.y,t.z)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transform:function(t){function n(t){s=Math.min(s,t.x),e=Math.min(e,t.y),r=Math.min(r,t.z),h=Math.max(h,t.x),o=Math.max(o,t.y),m=Math.max(m,t.z)}if(this.isEmpty())return this;if(t.isIdentity())return this;var s=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,m=Number.NEGATIVE_INFINITY,a=new i.Vector3;return n(t.multiplyVector3(a.setXYZ(this.minX,this.minY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.minX,this.maxY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.minY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.maxY,this.minZ))),n(t.multiplyVector3(a.setXYZ(this.minX,this.minY,this.maxZ))),n(t.multiplyVector3(a.setXYZ(this.minX,this.maxY,this.maxZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.minY,this.maxZ))),n(t.multiplyVector3(a.setXYZ(this.maxX,this.maxY,this.maxZ))),this.setMinMax(s,e,r,h,o,m)},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilateZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilateXYZ:function(t,i,n){return this.setMinMax(this.minX-t,this.minY-i,this.minZ-n,this.maxX+t,this.maxY+i,this.maxZ+n)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeZ:function(t){return this.dilateZ(-t)},erodeXYZ:function(t,i,n){return this.dilateXYZ(-t,-i,-n)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shift:function(t,i,n){return this.setMinMax(this.minX+t,this.minY+i,this.minZ+n,this.maxX+t,this.maxY+i,this.maxZ+n)}},n.cuboid=function(t,i,s,e,r,h){return new n(t,i,s,t+e,i+r,s+h)},n.point=function(t,i,s){return new n(t,i,s,t,i,s)},n.EVERYTHING=new n(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),n.NOTHING=new n(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n}),n("DOT/Complex",["require","DOT/dot","PHET_CORE/inherit","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("DOT/Vector2");i.Complex=function(t,i){s.call(this,t,i),this.real=t,this.imaginary=i};var e=i.Complex;return e.real=function(t){return new e(t,0)},e.imaginary=function(t){return new e(0,t)},e.createPolar=function(t,i){return new e(t*Math.cos(i),t*Math.sin(i))},n(s.Immutable,e,{phase:s.prototype.angle,times:function(t){return new e(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var i=t.magnitudeSquared();return new e((this.real*t.real+this.imaginary*t.imaginary)/i,(this.imaginary*t.real-this.real*t.imaginary)/i)},sqrt:function(){var t=this.magnitude();return new e(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},conjugate:function(){return new e(this.real,-this.imaginary)},exponentiated:function(){return e.createPolar(Math.exp(this.real),this.imaginary)},toString:function(){return"Complex("+this.x+", "+this.y+")"}}),e.ZERO=new e(0,0),e.ONE=new e(1,0),e.I=new e(0,1),e}),n("DOT/ConvexHull2",["require","DOT/dot"],function(t){function i(t,i,n){return i.minus(t).crossScalar(n.minus(t))}var n=t("DOT/dot");return n.ConvexHull2={grahamScan:function(t,n){if(t.length<=2)return t;var s=Number.POSITIVE_INFINITY,e=null;_.each(t,function(t){t.y<=s&&(t.y===s&&e?t.x<e.x&&(e=t):(s=t.y,e=t))}),t=_.sortBy(t,function(t){return t.minus(e).angle()}),t.splice(_.indexOf(t,e),1);var r=[e];return _.each(t,function(t){function s(){if(r.length<2)return!1;var s=i(r[r.length-2],r[r.length-1],t);return n?0>s:0>=s}if(e.x!==t.x||e.y!==t.y){for(;s();)r.pop();r.push(t)}}),r}},n.ConvexHull2}),n("DOT/Dimension2",["require","DOT/dot","DOT/Bounds2"],function(t){var i=t("DOT/dot");t("DOT/Bounds2"),i.Dimension2=function(t,i){this.width=t,this.height=i};var n=i.Dimension2;return n.prototype={constructor:n,toString:function(){return"["+this.width+"w, "+this.height+"h]"},set:function(t){return this.width=t.width,this.height=t.height,this},setWidth:function(t){return this.width=t,this},setHeight:function(t){return this.width=t,this},copy:function(t){return t?t.set(this):new n(this.width,this.height)},toBounds:function(t,n){return t=t||0,n=n||0,new i.Bounds2(t,n,this.width+t,this.height+n)},equals:function(t){return this.width===t.width&&this.height===t.height}},n}),n("DOT/EigenvalueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.EigenvalueDecomposition=function(t){var i,s,e=t.entries;this.n=t.getColumnDimension();var r=this.n;for(this.V=new n(r*r),this.d=new n(r),this.e=new n(r),this.issymmetric=!0,s=0;r>s&&this.issymmetric;s++)for(i=0;r>i&&this.issymmetric;i++)this.issymmetric=e[i*this.n+s]===e[s*this.n+i];if(this.issymmetric){for(i=0;r>i;i++)for(s=0;r>s;s++)this.V[i*this.n+s]=e[i*this.n+s];this.tred2(),this.tql2()}else{for(this.H=new n(r*r),this.ort=new n(r),s=0;r>s;s++)for(i=0;r>i;i++)this.H[i*this.n+s]=e[i*this.n+s];this.orthes(),this.hqr2()}};var s=i.EigenvalueDecomposition;return s.prototype={constructor:s,getV:function(){return this.V.copy()},getRealEigenvalues:function(){return this.d},getImagEigenvalues:function(){return this.e},getD:function(){for(var t=this.n,n=this.d,s=this.e,e=new i.Matrix(t,t),r=e.entries,h=0;t>h;h++){for(var o=0;t>o;o++)r[h*this.n+o]=0;r[h*this.n+h]=n[h],s[h]>0?r[h*this.n+h+1]=s[h]:s[h]<0&&(r[h*this.n+h-1]=s[h])}return e},tred2:function(){var t,i,n,s,e,r,h=this.n,o=this.V,m=this.d,a=this.e;for(i=0;h>i;i++)m[i]=o[(h-1)*h+i];for(t=h-1;t>0;t--){var u=0;for(r=0,n=0;t>n;n++)u+=Math.abs(m[n]);if(0===u)for(a[t]=m[t-1],i=0;t>i;i++)m[i]=o[(t-1)*h+i],o[t*this.n+i]=0,o[i*this.n+t]=0;else{for(n=0;t>n;n++)m[n]/=u,r+=m[n]*m[n];for(s=m[t-1],e=Math.sqrt(r),s>0&&(e=-e),a[t]=u*e,r-=s*e,m[t-1]=s-e,i=0;t>i;i++)a[i]=0;for(i=0;t>i;i++){for(s=m[i],o[i*this.n+t]=s,e=a[i]+o[i*h+i]*s,n=i+1;t-1>=n;n++)e+=o[n*h+i]*m[n],a[n]+=o[n*h+i]*s;a[i]=e}for(s=0,i=0;t>i;i++)a[i]/=r,s+=a[i]*m[i];var c=s/(r+r);for(i=0;t>i;i++)a[i]-=c*m[i];for(i=0;t>i;i++){for(s=m[i],e=a[i],n=i;t-1>=n;n++)o[n*h+i]-=s*a[n]+e*m[n];m[i]=o[(t-1)*h+i],o[t*this.n+i]=0}}m[t]=r}for(t=0;h-1>t;t++){if(o[(h-1)*h+t]=o[t*h+t],o[t*h+t]=1,r=m[t+1],0!==r){for(n=0;t>=n;n++)m[n]=o[n*h+(t+1)]/r;for(i=0;t>=i;i++){for(e=0,n=0;t>=n;n++)e+=o[n*h+(t+1)]*o[n*h+i];for(n=0;t>=n;n++)o[n*h+i]-=e*m[n]}}for(n=0;t>=n;n++)o[n*h+(t+1)]=0}for(i=0;h>i;i++)m[i]=o[(h-1)*h+i],o[(h-1)*h+i]=0;o[(h-1)*h+(h-1)]=1,a[0]=0},tql2:function(){var t,n,s,e,r,h,o,m=this.n,a=this.V,u=this.d,c=this.e;for(t=1;m>t;t++)c[t-1]=c[t];c[m-1]=0;var f=0,l=0,x=Math.pow(2,-52);for(e=0;m>e;e++){l=Math.max(l,Math.abs(u[e])+Math.abs(c[e]));for(var d=e;m>d&&!(Math.abs(c[d])<=x*l);)d++;if(d>e){o=0;do{o+=1,r=u[e],h=(u[e+1]-r)/(2*c[e]);var y=i.Matrix.hypot(h,1);0>h&&(y=-y),u[e]=c[e]/(h+y),u[e+1]=c[e]*(h+y);var v=u[e+1],w=r-u[e];for(t=e+2;m>t;t++)u[t]-=w;f+=w,h=u[d];var p=1,T=p,M=p,g=c[e+1],O=0,Y=0;for(t=d-1;t>=e;t--)for(M=T,T=p,Y=O,r=p*c[t],w=p*h,y=i.Matrix.hypot(h,c[t]),c[t+1]=O*y,O=c[t]/y,p=h/y,h=p*u[t]-O*r,u[t+1]=w+O*(p*r+O*u[t]),s=0;m>s;s++)w=a[s*m+(t+1)],a[s*m+(t+1)]=O*a[s*m+t]+p*w,a[s*m+t]=p*a[s*m+t]-O*w;h=-O*Y*M*g*c[e]/v,c[e]=O*h,u[e]=p*h}while(Math.abs(c[e])>x*l)}u[e]=u[e]+f,c[e]=0}for(t=0;m-1>t;t++){for(s=t,h=u[t],n=t+1;m>n;n++)u[n]<h&&(s=n,h=u[n]);if(s!==t)for(u[s]=u[t],u[t]=h,n=0;m>n;n++)h=a[n*this.n+t],a[n*this.n+t]=a[n*m+s],a[n*m+s]=h}},orthes:function(){var t,i,n,s,e,r=this.n,h=this.V,o=this.H,m=this.ort,a=0,u=r-1;for(n=a+1;u-1>=n;n++){var c=0;for(t=n;u>=t;t++)c+=Math.abs(o[t*r+(n-1)]);if(0!==c){var f=0;for(t=u;t>=n;t--)m[t]=o[t*r+(n-1)]/c,f+=m[t]*m[t];for(e=Math.sqrt(f),m[n]>0&&(e=-e),f-=m[n]*e,m[n]=m[n]-e,i=n;r>i;i++){for(s=0,t=u;t>=n;t--)s+=m[t]*o[t*this.n+i];for(s/=f,t=n;u>=t;t++)o[t*this.n+i]-=s*m[t]}for(t=0;u>=t;t++){for(s=0,i=u;i>=n;i--)s+=m[i]*o[t*this.n+i];for(s/=f,i=n;u>=i;i++)o[t*this.n+i]-=s*m[i]}m[n]=c*m[n],o[n*r+(n-1)]=c*e}}for(t=0;r>t;t++)for(i=0;r>i;i++)h[t*this.n+i]=t===i?1:0;for(n=u-1;n>=a+1;n--)if(0!==o[n*r+(n-1)]){for(t=n+1;u>=t;t++)m[t]=o[t*r+(n-1)];for(i=n;u>=i;i++){for(e=0,t=n;u>=t;t++)e+=m[t]*h[t*this.n+i];for(e=e/m[n]/o[n*r+(n-1)],t=n;u>=t;t++)h[t*this.n+i]+=e*m[t]}}},cdiv:function(t,i,n,s){var e,r;Math.abs(n)>Math.abs(s)?(e=s/n,r=n+e*s,this.cdivr=(t+e*i)/r,this.cdivi=(i-e*t)/r):(e=n/s,r=s+e*n,this.cdivr=(e*t+i)/r,this.cdivi=(e*i-t)/r)},hqr2:function(){var t,i,n,s,e,r,h,o=this.V,m=this.d,a=this.e,u=this.H,c=this.n;t=c-1;var f,l,x,d,y=0,v=c-1,w=Math.pow(2,-52),p=0,T=0,M=0,g=0,O=0,Y=0,E=0;for(i=0;c>i;i++)for((y>i||i>v)&&(m[i]=u[i*t+i],a[i]=0),n=Math.max(i-1,0);c>n;n++)E+=Math.abs(u[i*this.n+n]);for(h=0;t>=y;){for(e=t;e>y&&(O=Math.abs(u[(e-1)*t+(e-1)])+Math.abs(u[e*t+e]),0===O&&(O=E),!(Math.abs(u[e*t+(e-1)])<w*O));)e--;if(e===t)u[t*t+t]=u[t*t+t]+p,m[t]=u[t*t+t],a[t]=0,t--,h=0;else if(e===t-1){if(l=u[t*t+t-1]*u[(t-1)*t+t],T=(u[(t-1)*t+(t-1)]-u[t*t+t])/2,M=T*T+l,Y=Math.sqrt(Math.abs(M)),u[t*t+t]=u[t*t+t]+p,u[(t-1)*t+(t-1)]=u[(t-1)*t+(t-1)]+p,x=u[t*t+t],M>=0){for(Y=T>=0?T+Y:T-Y,m[t-1]=x+Y,m[t]=m[t-1],0!==Y&&(m[t]=x-l/Y),a[t-1]=0,a[t]=0,x=u[t*t+t-1],O=Math.abs(x)+Math.abs(Y),T=x/O,M=Y/O,g=Math.sqrt(T*T+M*M),T/=g,M/=g,n=t-1;c>n;n++)Y=u[(t-1)*t+n],u[(t-1)*t+n]=M*Y+T*u[t*t+n],u[t*t+n]=M*u[t*t+n]-T*Y;for(i=0;t>=i;i++)Y=u[i*t+t-1],u[i*t+t-1]=M*Y+T*u[i*t+t],u[i*t+t]=M*u[i*t+t]-T*Y;for(i=y;v>=i;i++)Y=o[i*t+t-1],o[i*t+t-1]=M*Y+T*o[i*t+t],o[i*t+t]=M*o[i*t+t]-T*Y}else m[t-1]=x+T,m[t]=x+T,a[t-1]=Y,a[t]=-Y;t-=2,h=0}else{if(x=u[t*t+t],d=0,l=0,t>e&&(d=u[(t-1)*t+(t-1)],l=u[t*t+t-1]*u[(t-1)*t+t]),10===h){for(p+=x,i=y;t>=i;i++)u[i*t+i]-=x;O=Math.abs(u[t*t+t-1])+Math.abs(u[(t-1)*t+t-2]),x=d=.75*O,l=-.4375*O*O}if(30===h&&(O=(d-x)/2,O=O*O+l,O>0)){for(O=Math.sqrt(O),x>d&&(O=-O),O=x-l/((d-x)/2+O),i=y;t>=i;i++)u[i*t+i]-=O;p+=O,x=d=l=.964}for(h+=1,r=t-2;r>=e&&(Y=u[r*t+r],g=x-Y,O=d-Y,T=(g*O-l)/u[(r+1)*t+r]+u[r*t+r+1],M=u[(r+1)*t+r+1]-Y-g-O,g=u[(r+2)*t+r+1],O=Math.abs(T)+Math.abs(M)+Math.abs(g),T/=O,M/=O,g/=O,r!==e)&&!(Math.abs(u[r*t+(r-1)])*(Math.abs(M)+Math.abs(g))<w*Math.abs(T)*(Math.abs(u[(r-1)*t+r-1])+Math.abs(Y)+Math.abs(u[(r+1)*t+r+1])));)r--;for(i=r+2;t>=i;i++)u[i*t+i-2]=0,i>r+2&&(u[i*t+i-3]=0);for(s=r;t-1>=s;s++){var b=s!==t-1;if(s!==r&&(T=u[s*t+s-1],M=u[(s+1)*t+s-1],g=b?u[(s+2)*t+s-1]:0,x=Math.abs(T)+Math.abs(M)+Math.abs(g),0!==x&&(T/=x,M/=x,g/=x)),0===x)break;if(O=Math.sqrt(T*T+M*M+g*g),0>T&&(O=-O),0!==O){for(s!==r?u[s*t+s-1]=-O*x:e!==r&&(u[s*t+s-1]=-u[s*t+s-1]),T+=O,x=T/O,d=M/O,Y=g/O,M/=T,g/=T,n=s;c>n;n++)T=u[s*t+n]+M*u[(s+1)*t+n],b&&(T+=g*u[(s+2)*t+n],u[(s+2)*t+n]=u[(s+2)*t+n]-T*Y),u[s*t+n]=u[s*t+n]-T*x,u[(s+1)*t+n]=u[(s+1)*t+n]-T*d;for(i=0;i<=Math.min(t,s+3);i++)T=x*u[i*t+s]+d*u[i*t+s+1],b&&(T+=Y*u[i*t+s+2],u[i*t+s+2]=u[i*t+s+2]-T*g),u[i*t+s]=u[i*t+s]-T,u[i*t+s+1]=u[i*t+s+1]-T*M;for(i=y;v>=i;i++)T=x*o[i*t+s]+d*o[i*t+s+1],b&&(T+=Y*o[i*t+s+2],o[i*t+s+2]=o[i*t+s+2]-T*g),o[i*t+s]=o[i*t+s]-T,o[i*t+s+1]=o[i*t+s+1]-T*M}}}}if(0!==E){for(t=c-1;t>=0;t--)if(T=m[t],M=a[t],0===M)for(e=t,u[t*t+t]=1,i=t-1;i>=0;i--){for(l=u[i*t+i]-T,g=0,n=e;t>=n;n++)g+=u[i*this.n+n]*u[n*t+t];if(a[i]<0)Y=l,O=g;else if(e=i,0===a[i]?u[i*t+t]=0!==l?-g/l:-g/(w*E):(x=u[i*t+i+1],d=u[(i+1)*t+i],M=(m[i]-T)*(m[i]-T)+a[i]*a[i],f=(x*O-Y*g)/M,u[i*t+t]=f,u[(i+1)*t+t]=Math.abs(x)>Math.abs(Y)?(-g-l*f)/x:(-O-d*f)/Y),f=Math.abs(u[i*t+t]),w*f*f>1)for(n=i;t>=n;n++)u[n*t+t]=u[n*t+t]/f}else if(0>M)for(e=t-1,Math.abs(u[t*t+t-1])>Math.abs(u[(t-1)*t+t])?(u[(t-1)*t+(t-1)]=M/u[t*t+t-1],u[(t-1)*t+t]=-(u[t*t+t]-T)/u[t*t+t-1]):(this.cdiv(0,-u[(t-1)*t+t],u[(t-1)*t+(t-1)]-T,M),u[(t-1)*t+(t-1)]=this.cdivr,u[(t-1)*t+t]=this.cdivi),u[t*t+t-1]=0,u[t*t+t]=1,i=t-2;i>=0;i--){var X,D,I,V;for(X=0,D=0,n=e;t>=n;n++)X+=u[i*this.n+n]*u[n*t+t-1],D+=u[i*this.n+n]*u[n*t+t];if(l=u[i*t+i]-T,a[i]<0)Y=l,g=X,O=D;else if(e=i,0===a[i]?(this.cdiv(-X,-D,l,M),u[i*t+t-1]=this.cdivr,u[i*t+t]=this.cdivi):(x=u[i*t+i+1],d=u[(i+1)*t+i],I=(m[i]-T)*(m[i]-T)+a[i]*a[i]-M*M,V=2*(m[i]-T)*M,0===I&&0===V&&(I=w*E*(Math.abs(l)+Math.abs(M)+Math.abs(x)+Math.abs(d)+Math.abs(Y))),this.cdiv(x*g-Y*X+M*D,x*O-Y*D-M*X,I,V),u[i*t+t-1]=this.cdivr,u[i*t+t]=this.cdivi,Math.abs(x)>Math.abs(Y)+Math.abs(M)?(u[(i+1)*t+t-1]=(-X-l*u[i*t+t-1]+M*u[i*t+t])/x,u[(i+1)*t+t]=(-D-l*u[i*t+t]-M*u[i*t+t-1])/x):(this.cdiv(-g-d*u[i*t+t-1],-O-d*u[i*t+t],Y,M),u[(i+1)*t+t-1]=this.cdivr,u[(i+1)*t+t]=this.cdivi)),f=Math.max(Math.abs(u[i*t+t-1]),Math.abs(u[i*t+t])),w*f*f>1)for(n=i;t>=n;n++)u[n*t+t-1]=u[n*t+t-1]/f,u[n*t+t]=u[n*t+t]/f}for(i=0;c>i;i++)if(y>i||i>v)for(n=i;c>n;n++)o[i*this.n+n]=u[i*this.n+n];for(n=c-1;n>=y;n--)for(i=y;v>=i;i++){for(Y=0,s=y;s<=Math.min(n,v);s++)Y+=o[i*t+s]*u[s*t+n];o[i*this.n+n]=Y}}}},s}),n("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){var i=t("DOT/dot");return t("DOT/Util"),i.LinearFunction=function(t,n,s,e,r){r=_.isUndefined(r)?!1:r;var h=function(t,n,s,e,r,h){var o=i.Util.linear(t,n,s,e,r);if(h){var m=Math.max(s,e),a=Math.min(s,e);o=i.Util.clamp(o,a,m)}return o},o=function(i){return h(t,n,s,e,i,r)};return o.inverse=function(i){return h(s,e,t,n,i,r)},o},i.LinearFunction}),n("DOT/LUDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.LUDecomposition=function(t){var i,s,e;this.matrix=t,this.LU=t.getArrayCopy();var r=this.LU;this.m=t.getRowDimension();var h=this.m;this.n=t.getColumnDimension();var o=this.n;for(this.piv=new Uint32Array(h),i=0;h>i;i++)this.piv[i]=i;this.pivsign=1;var m=new n(h);for(s=0;o>s;s++){for(i=0;h>i;i++)m[i]=r[t.index(i,s)];for(i=0;h>i;i++){var a=Math.min(i,s),u=0;for(e=0;a>e;e++){var c=t.index(i,e);u+=r[c]*m[e]}m[i]-=u,r[t.index(i,s)]=m[i]}var f=s;for(i=s+1;h>i;i++)Math.abs(m[i])>Math.abs(m[f])&&(f=i);if(f!==s){for(e=0;o>e;e++){var l=t.index(f,e),x=t.index(s,e),d=r[l];r[l]=r[x],r[x]=d}e=this.piv[f],this.piv[f]=this.piv[s],this.piv[s]=e,this.pivsign=-this.pivsign}if(h>s&&0!==r[this.matrix.index(s,s)])for(i=s+1;h>i;i++)r[t.index(i,s)]/=r[t.index(s,s)]}};var s=i.LUDecomposition;return s.prototype={constructor:s,isNonsingular:function(){for(var t=0;t<this.n;t++){var i=this.matrix.index(t,t);if(0===this.LU[i])return!1}return!0},getL:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++)t.entries[t.index(n,s)]=n>s?this.LU[this.matrix.index(n,s)]:n===s?1:0;return t},getU:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var s=0;s<this.n;s++)t.entries[t.index(n,s)]=s>=n?this.LU[this.matrix.index(n,s)]:0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},getDoublePivot:function(){for(var t=new n(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},det:function(){if(this.m!==this.n)throw new Error("Matrix must be square.");for(var t=this.pivsign,i=0;i<this.n;i++)t*=this.LU[this.matrix.index(i,i)];return t},solve:function(t){var i,n,s;if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw new Error("Matrix is singular.");var e=t.getColumnDimension(),r=t.getArrayRowMatrix(this.piv,0,e-1);for(s=0;s<this.n;s++)for(i=s+1;i<this.n;i++)for(n=0;e>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(s,n)]*this.LU[this.matrix.index(i,s)];for(s=this.n-1;s>=0;s--){for(n=0;e>n;n++)r.entries[r.index(s,n)]/=this.LU[this.matrix.index(s,s)];for(i=0;s>i;i++)for(n=0;e>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(s,n)]*this.LU[this.matrix.index(i,s)]}return r}},s}),n("PHET_CORE/isArray",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},i.isArray}),n("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.SingularValueDecomposition=function(t){this.matrix=t;var s=t,e=s.getArrayCopy();this.m=s.getRowDimension(),this.n=s.getColumnDimension();var r=this.m,h=this.n,o=Math.min,m=Math.max,a=Math.pow,u=Math.abs,c=o(r,h);this.s=new n(o(r+1,h));var f=this.s;this.U=new n(r*c);var l=this.U;this.V=new n(h*h);var x,d,y,v,w,p,T,M=this.V,g=new n(h),O=new n(r),Y=!0,E=!0,b=i.Matrix.hypot,X=o(r-1,h),D=m(0,o(h-2,r));for(y=0;y<m(X,D);y++){if(X>y){for(f[y]=0,x=y;r>x;x++)f[y]=b(f[y],e[x*h+y]);if(0!==f[y]){for(e[y*h+y]<0&&(f[y]=-f[y]),x=y;r>x;x++)e[x*h+y]/=f[y];e[y*h+y]+=1}f[y]=-f[y]}for(d=y+1;h>d;d++){if(X>y&&0!==f[y]){for(v=0,x=y;r>x;x++)v+=e[x*h+y]*e[x*h+d];for(v=-v/e[y*h+y],x=y;r>x;x++)e[x*h+d]+=v*e[x*h+y]}g[d]=e[y*h+d]}if(Y&&X>y)for(x=y;r>x;x++)l[x*c+y]=e[x*h+y];if(D>y){for(g[y]=0,x=y+1;h>x;x++)g[y]=b(g[y],g[x]);if(0!==g[y]){for(g[y+1]<0&&(g[y]=-g[y]),x=y+1;h>x;x++)g[x]/=g[y];g[y+1]+=1}if(g[y]=-g[y],r>y+1&&0!==g[y]){for(x=y+1;r>x;x++)O[x]=0;for(d=y+1;h>d;d++)for(x=y+1;r>x;x++)O[x]+=g[d]*e[x*h+d];for(d=y+1;h>d;d++)for(v=-g[d]/g[y+1],x=y+1;r>x;x++)e[x*h+d]+=v*O[x]}if(E)for(x=y+1;h>x;x++)M[x*h+y]=g[x]}}var I=o(h,r+1);if(h>X&&(f[X]=e[X*h+X]),I>r&&(f[I-1]=0),I>D+1&&(g[D]=e[D*h+I-1]),g[I-1]=0,Y){for(d=X;c>d;d++){for(x=0;r>x;x++)l[x*c+d]=0;l[d*c+d]=1}for(y=X-1;y>=0;y--)if(0!==f[y]){for(d=y+1;c>d;d++){for(v=0,x=y;r>x;x++)v+=l[x*c+y]*l[x*c+d];for(v=-v/l[y*c+y],x=y;r>x;x++)l[x*c+d]+=v*l[x*c+y]}for(x=y;r>x;x++)l[x*c+y]=-l[x*c+y];for(l[y*c+y]=1+l[y*c+y],x=0;y-1>x;x++)l[x*c+y]=0}else{for(x=0;r>x;x++)l[x*c+y]=0;l[y*c+y]=1}}if(E)for(y=h-1;y>=0;y--){if(D>y&&0!==g[y])for(d=y+1;c>d;d++){for(v=0,x=y+1;h>x;x++)v+=M[x*h+y]*M[x*h+d];for(v=-v/M[(y+1)*h+y],x=y+1;h>x;x++)M[x*h+d]+=v*M[x*h+y]}for(x=0;h>x;x++)M[x*h+y]=0;M[y*h+y]=1}for(var V=I-1,R=0,P=a(2,-52),_=a(2,-966);I>0;){var N;if(R>500)break;for(y=I-2;y>=-1&&-1!==y;y--)if(u(g[y])<=_+P*(u(f[y])+u(f[y+1]))){g[y]=0;break}if(y===I-2)N=4;else{var z;for(z=I-1;z>=y&&z!==y;z--)if(v=(z!==I?u(g[z]):0)+(z!==y+1?u(g[z-1]):0),u(f[z])<=_+P*v){f[z]=0;break}z===y?N=3:z===I-1?N=1:(N=2,y=z)}switch(y++,N){case 1:for(w=g[I-2],g[I-2]=0,d=I-2;d>=y;d--)if(v=b(f[d],w),p=f[d]/v,T=w/v,f[d]=v,d!==y&&(w=-T*g[d-1],g[d-1]=p*g[d-1]),E)for(x=0;h>x;x++)v=p*M[x*h+d]+T*M[x*h+I-1],M[x*h+I-1]=-T*M[x*h+d]+p*M[x*h+I-1],M[x*h+d]=v;break;case 2:for(w=g[y-1],g[y-1]=0,d=y;I>d;d++)if(v=b(f[d],w),p=f[d]/v,T=w/v,f[d]=v,w=-T*g[d],g[d]=p*g[d],Y)for(x=0;r>x;x++)v=p*l[x*c+d]+T*l[x*c+y-1],l[x*c+y-1]=-T*l[x*c+d]+p*l[x*c+y-1],l[x*c+d]=v;break;case 3:var F=m(m(m(m(u(f[I-1]),u(f[I-2])),u(g[I-2])),u(f[y])),u(g[y])),C=f[I-1]/F,S=f[I-2]/F,A=g[I-2]/F,Z=f[y]/F,j=g[y]/F,H=((S+C)*(S-C)+A*A)/2,q=C*A*C*A,L=0;(0!==H||0!==q)&&(L=Math.sqrt(H*H+q),0>H&&(L=-L),L=q/(H+L)),w=(Z+C)*(Z-C)+L;var k=Z*j;for(d=y;I-1>d;d++){if(v=b(w,k),p=w/v,T=k/v,d!==y&&(g[d-1]=v),w=p*f[d]+T*g[d],g[d]=p*g[d]-T*f[d],k=T*f[d+1],f[d+1]=p*f[d+1],E)for(x=0;h>x;x++)v=p*M[x*h+d]+T*M[x*h+d+1],M[x*h+d+1]=-T*M[x*h+d]+p*M[x*h+d+1],M[x*h+d]=v;if(v=b(w,k),p=w/v,T=k/v,f[d]=v,w=p*g[d]+T*f[d+1],f[d+1]=-T*g[d]+p*f[d+1],k=T*g[d+1],g[d+1]=p*g[d+1],Y&&r-1>d)for(x=0;r>x;x++)v=p*l[x*c+d]+T*l[x*c+d+1],l[x*c+d+1]=-T*l[x*c+d]+p*l[x*c+d+1],l[x*c+d]=v}g[I-2]=w,R+=1;break;case 4:if(f[y]<=0&&(f[y]=f[y]<0?-f[y]:0,E))for(x=0;V>=x;x++)M[x*h+y]=-M[x*h+y];for(;V>y&&!(f[y]>=f[y+1]);){if(v=f[y],f[y]=f[y+1],f[y+1]=v,E&&h-1>y)for(x=0;h>x;x++)v=M[x*h+y+1],M[x*h+y+1]=M[x*h+y],M[x*h+y]=v;if(Y&&r-1>y)for(x=0;r>x;x++)v=l[x*c+y+1],l[x*c+y+1]=l[x*c+y],l[x*c+y]=v;y++}R=0,I--}}};var s=i.SingularValueDecomposition;return s.prototype={constructor:s,getU:function(){return new i.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new i.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++){for(var s=0;s<this.n;s++)t.entries[t.index(n,s)]=0;t.entries[t.index(n,n)]=this.s[n]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),i=Math.max(this.m,this.n)*this.s[0]*t,n=0,s=0;s<this.s.length;s++)this.s[s]>i&&n++;return n}},s}),n("DOT/QRDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array;i.QRDecomposition=function(t){this.matrix=t,this.QR=t.getArrayCopy();var s=this.QR;this.m=t.getRowDimension();var e=this.m;this.n=t.getColumnDimension();var r=this.n;this.Rdiag=new n(r);var h,o,m;for(m=0;r>m;m++){var a=0;for(h=m;e>h;h++)a=i.Matrix.hypot(a,s[this.matrix.index(h,m)]);if(0!==a){for(s[this.matrix.index(m,m)]<0&&(a=-a),h=m;e>h;h++)s[this.matrix.index(h,m)]/=a;for(s[this.matrix.index(m,m)]+=1,o=m+1;r>o;o++){var u=0;for(h=m;e>h;h++)u+=s[this.matrix.index(h,m)]*s[this.matrix.index(h,o)];for(u=-u/s[this.matrix.index(m,m)],h=m;e>h;h++)s[this.matrix.index(h,o)]+=u*s[this.matrix.index(h,m)]}}this.Rdiag[m]=-a}};var s=i.QRDecomposition;return s.prototype={constructor:s,isFullRank:function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++)t.entries[t.index(n,s)]=n>=s?this.QR[this.matrix.index(n,s)]:0;return t},getR:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var s=0;s<this.n;s++)t.entries[t.index(n,s)]=s>n?this.QR[this.matrix.index(n,s)]:n===s?this.Rdiag[n]:0;return t},getQ:function(){var t,n,s,e=new i.Matrix(this.m,this.n);for(s=this.n-1;s>=0;s--){for(t=0;t<this.m;t++)e.entries[e.index(t,s)]=0;for(e.entries[e.index(s,s)]=1,n=s;n<this.n;n++)if(0!==this.QR[this.matrix.index(s,s)]){var r=0;for(t=s;t<this.m;t++)r+=this.QR[this.matrix.index(t,s)]*e.entries[e.index(t,n)];for(r=-r/this.QR[this.matrix.index(s,s)],t=s;t<this.m;t++)e.entries[e.index(t,n)]+=r*this.QR[this.matrix.index(t,s)]}}return e},solve:function(t){if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw new Error("Matrix is rank deficient.");var n,s,e,r=t.getColumnDimension(),h=t.getArrayCopy();for(e=0;e<this.n;e++)for(s=0;r>s;s++){var o=0;for(n=e;n<this.m;n++)o+=this.QR[this.matrix.index(n,e)]*h[t.index(n,s)];for(o=-o/this.QR[this.matrix.index(e,e)],n=e;n<this.m;n++)h[t.index(n,s)]+=o*this.QR[this.matrix.index(n,e)]}for(e=this.n-1;e>=0;e--){for(s=0;r>s;s++)h[t.index(e,s)]/=this.Rdiag[e];for(n=0;e>n;n++)for(s=0;r>s;s++)h[t.index(n,s)]-=h[t.index(e,s)]*this.QR[this.matrix.index(n,e)]}return new i.Matrix(h,this.n,r).getMatrix(0,this.n-1,0,r-1)}},s}),n("DOT/Matrix",["require","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/EigenvalueDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot"),n=window.Float32Array||Array,s=t("PHET_CORE/isArray");t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/EigenvalueDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),i.Matrix=function(t,i,e,r){this.m=t,this.n=i;var h=t*i;this.size=h;var o;if(r)this.entries=e;else if(e||(e=0),this.entries=new n(h),s(e))for(o=0;h>o;o++)this.entries[o]=e[o];else for(o=0;h>o;o++)this.entries[o]=e};var e=i.Matrix;return e.hypot=function(t,i){var n;return Math.abs(t)>Math.abs(i)?(n=i/t,n=Math.abs(t)*Math.sqrt(1+n*n)):0!==i?(n=t/i,n=Math.abs(i)*Math.sqrt(1+n*n)):n=0,n},e.prototype={constructor:e,copy:function(){for(var t=new e(this.m,this.n),i=0;i<this.size;i++)t.entries[i]=this.entries[i];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new n(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,i){return t*this.n+i},get:function(t,i){return this.entries[this.index(t,i)]},set:function(t,i,n){this.entries[this.index(t,i)]=n},getMatrix:function(t,i,n,s){for(var r=new e(i-t+1,s-n+1),h=t;i>=h;h++)for(var o=n;s>=o;o++)r.entries[r.index(h-t,o-n)]=this.entries[this.index(h,o)];return r},getArrayRowMatrix:function(t,i,n){for(var s=new e(t.length,n-i+1),r=0;r<t.length;r++)for(var h=i;n>=h;h++)s.entries[s.index(r,h-i)]=this.entries[this.index(t[r],h)];return s},transpose:function(t){t=t||new e(this.n,this.m);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(n,i)]=this.entries[this.index(i,n)];return t},norm1:function(){for(var t=0,i=0;i<this.n;i++){for(var n=0,s=0;s<this.m;s++)n+=Math.abs(this.entries[this.index(s,i)]);t=Math.max(t,n)}return t},norm2:function(){return new i.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,i=0;i<this.m;i++){for(var n=0,s=0;s<this.n;s++)n+=Math.abs(this.entries[this.index(i,s)]);t=Math.max(t,n)}return t},normF:function(){for(var t=0,i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t=e.hypot(t,this.entries[this.index(i,n)]);return t},uminus:function(){for(var t=new e(this.m,this.n),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=-this.entries[this.index(i,n)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=i.index(n,s);i.entries[r]=this.entries[r]+t.entries[r]}return i},plusEquals:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=i.index(n,s);this.entries[r]=this.entries[r]+t.entries[r]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=this.index(n,s);
i.entries[r]=this.entries[r]-t.entries[r]}return i},minusEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var s=this.index(i,n);this.entries[s]=this.entries[s]-t.entries[s]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=i.index(n,s);i.entries[r]=this.entries[r]*t.entries[r]}return i},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var s=this.index(i,n);this.entries[s]=this.entries[s]*t.entries[s]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=this.index(n,s);i.entries[r]=this.entries[r]/t.entries[r]}return i},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var s=this.index(i,n);this.entries[s]=this.entries[s]/t.entries[s]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),n=0;n<this.m;n++)for(var s=0;s<this.n;s++){var r=this.index(n,s);i.entries[r]=t.entries[r]/this.entries[r]}return i},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var s=this.index(i,n);this.entries[s]=t.entries[s]/this.entries[s]}return this},times:function(t){var i,s,r,h,o,m;if(t.isMatrix){if(m=t,m.m!==this.n)throw new Error("Matrix inner dimensions must agree.");i=new e(this.m,m.n);var a=new n(this.n);for(r=0;r<m.n;r++){for(h=0;h<this.n;h++)a[h]=m.entries[m.index(h,r)];for(s=0;s<this.m;s++){for(o=0,h=0;h<this.n;h++)o+=this.entries[this.index(s,h)]*a[h];i.entries[i.index(s,r)]=o}}return i}for(o=t,i=new e(this.m,this.n),s=0;s<this.m;s++)for(r=0;r<this.n;r++)i.entries[i.index(s,r)]=o*this.entries[this.index(s,r)];return i},timesEquals:function(t){for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var s=this.index(i,n);this.entries[s]=t*this.entries[s]}return this},solve:function(t){return this.m===this.n?new i.LUDecomposition(this).solve(t):new i.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(e.identity(this.m,this.m))},det:function(){return new i.LUDecomposition(this).det()},rank:function(){return new i.SingularValueDecomposition(this).rank()},cond:function(){return new i.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,i=0;i<Math.min(this.m,this.n);i++)t+=this.entries[this.index(i,i)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw new Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var i=0;i<this.getRowDimension();i++){for(var n=0;n<this.getColumnDimension();n++)t+=this.get(i,n)+" ";t+="\n"}return t},extractVector2:function(t){return new i.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return new i.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return new i.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},setVectors3:function(t){for(var i=t.length,n=0;i>n;n++){var s=t[n];this.entries[n]=s.x,this.entries[n+i]=s.y,this.entries[n+2*i]=s.z}return this},isMatrix:!0},e.identity=function(t,i){for(var n=new e(t,i),s=0;t>s;s++)for(var r=0;i>r;r++)n.entries[n.index(s,r)]=s===r?1:0;return n},e.rowVector2=function(t){return new e(1,2,[t.x,t.y])},e.rowVector3=function(t){return new e(1,3,[t.x,t.y,t.z])},e.rowVector4=function(t){return new e(1,4,[t.x,t.y,t.z,t.w])},e.rowVector=function(t){if(t.isVector2)return e.rowVector2(t);if(t.isVector3)return e.rowVector3(t);if(t.isVector4)return e.rowVector4(t);throw new Error("undetected type of vector: "+t.toString())},e.columnVector2=function(t){return new e(2,1,[t.x,t.y])},e.columnVector3=function(t){return new e(3,1,[t.x,t.y,t.z])},e.columnVector4=function(t){return new e(4,1,[t.x,t.y,t.z,t.w])},e.columnVector=function(t){if(t.isVector2)return e.columnVector2(t);if(t.isVector3)return e.columnVector3(t);if(t.isVector4)return e.columnVector4(t);throw new Error("undetected type of vector: "+t.toString())},e.fromVectors2=function(t){for(var i=2,s=t.length,r=new n(i*s),h=0;s>h;h++){var o=t[h];r[h]=o.x,r[h+s]=o.y}return new e(i,s,r,!0)},e.fromVectors3=function(t){for(var i=3,s=t.length,r=new n(i*s),h=0;s>h;h++){var o=t[h];r[h]=o.x,r[h+s]=o.y,r[h+2*s]=o.z}return new e(i,s,r,!0)},e.fromVectors4=function(t){for(var i=4,s=t.length,r=new n(i*s),h=0;s>h;h++){var o=t[h];r[h]=o.x,r[h+s]=o.y,r[h+2*s]=o.z,r[h+3*s]=o.w}return new e(i,s,r,!0)},e}),n("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var n=window.Float32Array||Array;i.Matrix4=function(t,i,s,e,r,h,o,m,a,u,c,f,l,x,d,y,v){this.entries=new n(16),this.rowMajor(void 0===t?1:t,i||0,s||0,e||0,r||0,void 0===h?1:h,o||0,m||0,a||0,u||0,void 0===c?1:c,f||0,l||0,x||0,d||0,void 0===y?1:y,v)};var s=i.Matrix4;s.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3,AFFINE:4};var e=s.Types;return s.identity=function(){return new s(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e.IDENTITY)},s.translation=function(t,i,n){return new s(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1,e.TRANSLATION_3D)},s.translationFromVector=function(t){return s.translation(t.x,t.y,t.z)},s.scaling=function(t,i,n){return i=void 0===i?t:i,n=void 0===n?t:n,new s(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1,e.SCALING)},s.rotationAxisAngle=function(t,i){var n=Math.cos(i),r=Math.sin(i),h=1-n;return new s(t.x*t.x*h+n,t.x*t.y*h-t.z*r,t.x*t.z*h+t.y*r,0,t.y*t.x*h+t.z*r,t.y*t.y*h+n,t.y*t.z*h-t.x*r,0,t.z*t.x*h-t.y*r,t.z*t.y*h+t.x*r,t.z*t.z*h+n,0,0,0,0,1,e.AFFINE)},s.rotationX=function(t){var i=Math.cos(t),n=Math.sin(t);return new s(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1,e.AFFINE)},s.rotationY=function(t){var i=Math.cos(t),n=Math.sin(t);return new s(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1,e.AFFINE)},s.rotationZ=function(t){var i=Math.cos(t),n=Math.sin(t);return new s(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1,e.AFFINE)},s.gluPerspective=function(t,i,n,e){var r=Math.cos(t)/Math.sin(t);return new s(r/i,0,0,0,0,r,0,0,0,0,(e+n)/(n-e),2*e*n/(n-e),0,0,-1,0)},s.prototype={constructor:s,rowMajor:function(t,i,n,s,r,h,o,m,a,u,c,f,l,x,d,y,v){return this.entries[0]=t,this.entries[1]=r,this.entries[2]=a,this.entries[3]=l,this.entries[4]=i,this.entries[5]=h,this.entries[6]=u,this.entries[7]=x,this.entries[8]=n,this.entries[9]=o,this.entries[10]=c,this.entries[11]=d,this.entries[12]=s,this.entries[13]=m,this.entries[14]=f,this.entries[15]=y,this.type=void 0===v?0===l&&0===x&&0===d&&1===y?e.AFFINE:e.OTHER:v,this},columnMajor:function(t,i,n,s,e,r,h,o,m,a,u,c,f,l,x,d,y){return this.rowMajor(t,e,m,f,i,r,a,l,n,h,u,x,s,o,c,d,y)},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m03(),t.m10(),t.m11(),t.m12(),t.m13(),t.m20(),t.m21(),t.m22(),t.m23(),t.m30(),t.m31(),t.m32(),t.m33(),t.type)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m03())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m13())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())&&isFinite(this.m23())&&isFinite(this.m30())&&isFinite(this.m31())&&isFinite(this.m32())&&isFinite(this.m33())},getTranslation:function(){return new i.Vector3(this.m03(),this.m13(),this.m23())},get translation(){return this.getTranslation()},getScaleVector:function(){var t=this.m00()+this.m03(),n=this.m10()+this.m13(),s=this.m20()+this.m23(),e=this.m30()+this.m33(),r=this.m01()+this.m03(),h=this.m11()+this.m13(),o=this.m21()+this.m23(),m=this.m31()+this.m33(),a=this.m02()+this.m03(),u=this.m12()+this.m13(),c=this.m22()+this.m23(),f=this.m32()+this.m33();return new i.Vector3(Math.sqrt(t*t+n*n+s*s+e*e),Math.sqrt(r*r+h*h+o*o+m*m),Math.sqrt(a*a+u*u+c*c+f*f))},get scaleVector(){return this.getScaleVector()},getCSSTransform:function(){return"matrix3d("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[2].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[5].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+","+this.entries[8].toFixed(20)+","+this.entries[9].toFixed(20)+","+this.entries[10].toFixed(20)+","+this.entries[11].toFixed(20)+","+this.entries[12].toFixed(20)+","+this.entries[13].toFixed(20)+","+this.entries[14].toFixed(20)+","+this.entries[15].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m03()===t.m03()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m13()===t.m13()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()&&this.m23()===t.m23()&&this.m30()===t.m30()&&this.m31()===t.m31()&&this.m32()===t.m32()&&this.m33()===t.m33()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m03()-t.m03())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m13()-t.m13())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i&&Math.abs(this.m23()-t.m23())<i&&Math.abs(this.m30()-t.m30())<i&&Math.abs(this.m31()-t.m31())<i&&Math.abs(this.m32()-t.m32())<i&&Math.abs(this.m33()-t.m33())<i},copy:function(){return new s(this.m00(),this.m01(),this.m02(),this.m03(),this.m10(),this.m11(),this.m12(),this.m13(),this.m20(),this.m21(),this.m22(),this.m23(),this.m30(),this.m31(),this.m32(),this.m33(),this.type)},plus:function(t){return new s(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new s(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new s(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new s(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){switch(this.type){case e.IDENTITY:return this;case e.TRANSLATION_3D:return new s(1,0,0,-this.m03(),0,1,0,-this.m13(),0,0,1,-this.m23(),0,0,0,1,e.TRANSLATION_3D);case e.SCALING:return new s(1/this.m00(),0,0,0,0,1/this.m11(),0,0,0,0,1/this.m22(),0,0,0,0,1/this.m33(),e.SCALING);case e.AFFINE:case e.OTHER:var t=this.getDeterminant();if(0!==t)return new s((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===e.IDENTITY||t.type===e.IDENTITY)return this.type===e.IDENTITY?t:this;if(this.type===t.type){if(this.type===e.TRANSLATION_3D)return new s(1,0,0,this.m03()+t.m02(),0,1,0,this.m13()+t.m12(),0,0,1,this.m23()+t.m23(),0,0,0,1,e.TRANSLATION_3D);if(this.type===e.SCALING)return new s(this.m00()*t.m00(),0,0,0,0,this.m11()*t.m11(),0,0,0,0,this.m22()*t.m22(),0,0,0,0,1,e.SCALING)}return this.type!==e.OTHER&&t.type!==e.OTHER?new s(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23(),0,0,0,1,e.AFFINE):new s(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33())},timesVector4:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,s=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,e=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,r=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new i.Vector4(n,s,e,r)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var n=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,s=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,e=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,r=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new i.Vector4(n,s,e,r)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var n=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,s=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,e=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new i.Vector3(n,s,e)},getDeterminant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},get determinant(){return this.getDeterminant()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},s.IDENTITY=new s,s.IDENTITY.makeImmutable(),s}),n("DOT/Matrix3",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/Poolable"),s=i.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4");var e=new s(9);e[0]=1,e[4]=1,e[8]=1;var r=s===Array?function(){return[1,0,0,0,1,0,0,0,1]}:function(){return new s(e)};i.Matrix3=function(t){this.entries=r(),this.type=o.IDENTITY};var h=i.Matrix3;h.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var o=h.Types;return h.identity=function(){return h.dirtyFromPool().setToIdentity()},h.translation=function(t,i){return h.dirtyFromPool().setToTranslation(t,i)},h.translationFromVector=function(t){return h.translation(t.x,t.y)},h.scaling=function(t,i){return h.dirtyFromPool().setToScale(t,i)},h.scale=h.scaling,h.affine=function(t,i,n,s,e,r){return h.dirtyFromPool().setToAffine(t,n,e,i,s,r)},h.rowMajor=function(t,i,n,s,e,r,o,m,a,u){return h.dirtyFromPool().rowMajor(t,i,n,s,e,r,o,m,a,u)},h.rotationAxisAngle=function(t,i){return h.dirtyFromPool().setToRotationAxisAngle(t,i)},h.rotationX=function(t){return h.dirtyFromPool().setToRotationX(t)},h.rotationY=function(t){return h.dirtyFromPool().setToRotationY(t)},h.rotationZ=function(t){return h.dirtyFromPool().setToRotationZ(t)},h.rotation2=h.rotationZ,h.rotationAround=function(t,i,n){return h.translation(i,n).timesMatrix(h.rotation2(t)).timesMatrix(h.translation(-i,-n))},h.rotationAroundPoint=function(t,i){return h.rotationAround(t,i.x,i.y)},h.fromSVGMatrix=function(t){return h.dirtyFromPool().setToSVGMatrix(t)},h.rotateAToB=function(t,i){return h.dirtyFromPool().setRotationAToB(t,i)},h.prototype={constructor:h,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isIdentity:function(){return this.type===o.IDENTITY||this.equals(h.IDENTITY)},isAffine:function(){return this.type===o.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isAligned:function(){return this.isAffine()&&0===this.m01()&&0===this.m10()},isAxisAligned:function(){return this.isAffine()&&(0===this.m01()&&0===this.m10()||0===this.m00()&&0===this.m11())},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new i.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new i.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){return Math.atan2(this.m10(),this.m00())},get rotation(){return this.getRotation()},toMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toAffineMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),0,this.m02(),this.m10(),this.m11(),0,this.m12(),0,0,1,0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case o.IDENTITY:return"";case o.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+t(this.entries[7])+")";case o.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i},copy:function(){return h.createFromPool(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return h.createFromPool(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return h.createFromPool(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return h.createFromPool(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negated:function(){return h.createFromPool(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return h.createFromPool(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return h.createFromPool(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(t=this.getDeterminant(),0!==t)return h.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(t=this.getDeterminant(),0!==t)return h.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===o.IDENTITY||t.type===o.IDENTITY)return this.type===o.IDENTITY?t:this;if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return h.createFromPool(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return h.createFromPool(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?h.createFromPool(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):h.createFromPool(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02(),s=this.m10()*t.x+this.m11()*t.y+this.m12();return new i.Vector2(n,s)},timesVector3:function(t){var n=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,s=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,e=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new i.Vector3(n,s,e)},timesTransposeVector2:function(t){var n=this.m00()*t.x+this.m10()*t.y,s=this.m01()*t.x+this.m11()*t.y;return new i.Vector2(n,s)},timesRelativeVector2:function(t){var n=this.m00()*t.x+this.m01()*t.y,s=this.m10()*t.y+this.m11()*t.y;return new i.Vector2(n,s)},rowMajor:function(t,i,n,s,e,r,h,m,a,u){return this.entries[0]=t,this.entries[1]=s,this.entries[2]=h,this.entries[3]=i,this.entries[4]=e,this.entries[5]=m,this.entries[6]=n,this.entries[7]=r,this.entries[8]=a,this.type=void 0===u?0===h&&0===m&&1===a?o.AFFINE:o.OTHER:u,this},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m10(),t.m11(),t.m12(),t.m20(),t.m21(),t.m22(),t.type)},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},columnMajor:function(t,i,n,s,e,r,h,o,m,a){return this.rowMajor(t,s,h,i,e,o,n,r,m,a)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);
throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(t.type===o.IDENTITY)return this;if(this.type===o.IDENTITY)return this.set(t);if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},setToIdentity:function(){return this.rowMajor(1,0,0,0,1,0,0,0,1,o.IDENTITY)},setToTranslation:function(t,i){return this.rowMajor(1,0,t,0,1,i,0,0,1,o.TRANSLATION_2D)},setToScale:function(t,i){return i=void 0===i?t:i,this.rowMajor(t,0,0,0,i,0,0,0,1,o.SCALING)},setToAffine:function(t,i,n,s,e,r){return this.rowMajor(t,i,n,s,e,r,0,0,1,o.AFFINE)},setToRotationAxisAngle:function(t,i){var n=Math.cos(i),s=Math.sin(i),e=1-n;return this.rowMajor(t.x*t.x*e+n,t.x*t.y*e-t.z*s,t.x*t.z*e+t.y*s,t.y*t.x*e+t.z*s,t.y*t.y*e+n,t.y*t.z*e-t.x*s,t.z*t.x*e-t.y*s,t.z*t.y*e+t.x*s,t.z*t.z*e+n,o.OTHER)},setToRotationX:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(1,0,0,0,i,-n,0,n,i,o.OTHER)},setToRotationY:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(i,0,n,0,1,0,-n,0,i,o.OTHER)},setToRotationZ:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(i,-n,0,n,i,0,0,0,1,o.AFFINE)},setToSVGMatrix:function(t){return this.rowMajor(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,o.AFFINE)},setRotationAToB:function(t,n){var s,e,r,h=t,o=n,m=1e-4,a=h.cross(o);if(s=h.dot(o),r=0>s?-s:s,r>1-m){var u,c,f,l=new i.Vector3(h.x>0?h.x:-h.x,h.y>0?h.y:-h.y,h.z>0?h.z:-h.z);l=l.x<l.y?l.x<l.z?i.Vector3.X_UNIT:i.Vector3.Z_UNIT:l.y<l.z?i.Vector3.Y_UNIT:i.Vector3.Z_UNIT;var x=l.minus(h);return a=l.minus(o),u=2/x.dot(x),c=2/a.dot(a),f=u*c*x.dot(a),this.rowMajor(-u*x.x*x.x-c*a.x*a.x+f*a.x*x.x+1,-u*x.x*x.y-c*a.x*a.y+f*a.x*x.y,-u*x.x*x.z-c*a.x*a.z+f*a.x*x.z,-u*x.y*x.x-c*a.y*a.x+f*a.y*x.x,-u*x.y*x.y-c*a.y*a.y+f*a.y*x.y+1,-u*x.y*x.z-c*a.y*a.z+f*a.y*x.z,-u*x.z*x.x-c*a.z*a.x+f*a.z*x.x,-u*x.z*x.y-c*a.z*a.y+f*a.z*x.y,-u*x.z*x.z-c*a.z*a.z+f*a.z*x.z+1)}var d,y,v,w,p;return e=1/(1+s),d=e*a.x,y=e*a.z,v=d*a.y,w=d*a.z,p=y*a.y,this.rowMajor(s+d*a.x,v-a.z,w+a.y,v+a.z,s+e*a.y*a.y,p-a.x,w-a.y,p+a.x,s+y*a.z)},multiplyVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y+this.m02(),this.m10()*t.x+this.m11()*t.y+this.m12())},multiplyVector3:function(t){return t.setXYZ(this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,this.m20()*t.x+this.m21()*t.y+this.m22()*t.z)},multiplyTransposeVector2:function(t){return t.setXY(this.m00()*t.x+this.m10()*t.y,this.m01()*t.x+this.m11()*t.y)},multiplyRelativeVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y,this.m10()*t.y+this.m11()*t.y)},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==o.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},n.mixin(h,{defaultFactory:function(){return new h},constructorDuplicateFactory:function(t){return function(i,n,s,e,r,o,m,a,u,c){var f=t.length?t.pop():new h;return f.rowMajor(i,n,s,e,r,o,m,a,u,c)}}}),h.IDENTITY=h.identity(),h.IDENTITY.makeImmutable(),h.X_REFLECTION=h.createFromPool(-1,0,0,0,1,0,0,0,1,o.AFFINE),h.X_REFLECTION.makeImmutable(),h.Y_REFLECTION=h.createFromPool(1,0,0,0,-1,0,0,0,1,o.AFFINE),h.Y_REFLECTION.makeImmutable(),h.translationTimesMatrix=function(t,i,n){var s;return n.type===o.IDENTITY||n.type===o.TRANSLATION_2D?h.createFromPool(1,0,n.m02()+t,0,1,n.m12()+i,0,0,1,o.TRANSLATION_2D):(s=n.type===o.OTHER?o.OTHER:o.AFFINE,h.createFromPool(n.m00(),n.m01(),n.m02()+t,n.m10(),n.m11(),n.m12()+i,n.m20(),n.m21(),n.m22(),s))},h.printer={print:function(t){console.log(t.toString())}},h}),n("AXON/axon",["require"],function(){var t={};return window.arch=window.arch||null,window.phet&&(window.phet.axon=t),t}),n("AXON/Property",["require","AXON/axon","PHET_CORE/inherit"],function(t){var i=t("AXON/axon"),n=t("PHET_CORE/inherit");return i.Property=function(t,i){this.storeValue(t),this.storeInitialValue(t),this._observers=[],this.propertyID=i?i.propertyID:null,this.sendPhetEvents=!0,this.delay=0},n(Object,i.Property,{get:function(){return this._value},set:function(t){return this.equalsValue(t)||this._setAndNotifyObservers(t),this},equalsValue:function(t){return t===this._value},storeValue:function(t){this._value=t},storeInitialValue:function(t){this._initialValue=t},get initialValue(){return this._initialValue},_setAndNotifyObservers:function(t){var i=this.get();this.storeValue(t),this._notifyObservers(i)},_notifyObservers:function(t){for(var i=this.get(),n=arch&&this.sendPhetEvents&&arch.start("model",this.propertyID,"Property","changed",{value:i}),s=this._observers.slice(),e=0;e<s.length;e++)s[e](i,t);n&&this.sendPhetEvents&&arch.end(n)},notifyObserversStatic:function(){for(var t=this.get(),i=0;i<this._observers.length;i++)this._observers[i](t)},reset:function(){this.set(this._initialValue)},_set:function(t){return this.set.bind(this,t)},get value(){return this.get()},set value(t){this.set(t)},link:function(t){-1===this._observers.indexOf(t)&&(this._observers.push(t),t(this.get(),null))},lazyLink:function(t){-1===this._observers.indexOf(t)&&this._observers.push(t)},unlink:function(t){var i=this._observers.indexOf(t);-1!==i&&this._observers.splice(i,1)},linkAttribute:function(t,i){var n=function(n){t[i]=n};return this.link(n),n},unlinkAttribute:function(t){this.unlink(t)},toString:function(){return"Property{"+this.get()+"}"},valueOf:function(){return this.toString()},once:function(t){var i=this,n=function(s,e){i.unlink(n),t(s,e)};return this.lazyLink(n),n},valueEquals:function(t){return new i.DerivedProperty([this],function(i){return i===t})},and:function(t){return new i.DerivedProperty([this,t],function(t,i){return t&&i})},times:function(t){return new i.DerivedProperty([this],function(i){return i*t})},plus:function(t){return new i.DerivedProperty([this],function(i){return i+t})},lessThanNumber:function(t){return new i.DerivedProperty([this],function(i){return t>i})},greaterThanNumber:function(t){return new i.DerivedProperty([this],function(i){return i>t})},derivedNot:function(){return new i.DerivedProperty([this],function(t){return!t})},not:function(){var t=this,n=new i.Property(!this.value),s=function(t){n.set(!t)};t.link(s);var e=function(i){t.set(!i)};return n.link(e),n.detach=function(){t.unlink(s),n.unlink(e)},n},debug:function(t){var i=function(i){console.log(t,i)};return this.link(i),i},mapValues:function(t){return new i.DerivedProperty([this],function(i){return t[i]})},map:function(t){return new i.DerivedProperty([this],function(i){return t(i)})},get toggleFunction(){return this.toggle.bind(this)},toggle:function(){this.value=!this.value},onValue:function(t,i){var n=function(n){n===t&&i()};return this.link(n),n},setSendPhetEvents:function(t){return this.sendPhetEvents=t,this},throttle:function(t){return this.delay=t,this}},{multilink:function(t,n){return new i.Multilink(t,n,!1)},lazyMultilink:function(t,n){return new i.Multilink(t,n,!0)},unmultilink:function(t){t.detach()}})}),n("DOT/ObservableBounds2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/extend","PHET_CORE/Poolable","AXON/Property","DOT/Bounds2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/extend"),e=t("PHET_CORE/Poolable"),r=t("AXON/Property");t("DOT/Bounds2"),i.ObservableBounds2=function(t,n,s,e){i.Bounds2.call(this,t,n,s,e),this._oldValue=this.copy(),r.call(this,this)};var h=i.ObservableBounds2;return n(i.Bounds2,h,s({},r.prototype,{get:function(){return this},setMinMax:function(t,i,n,s){return(this.minX!==t||this.minY!==i||this.maxX!==n||this.maxY!==s)&&(this._oldValue.minX=this.minX,this._oldValue.minY=this.minY,this._oldValue.maxX=this.maxX,this._oldValue.maxY=this.maxY,this.minX=t,this.minY=i,this.maxX=n,this.maxY=s,this._notifyObservers(this._oldValue)),this},setMinX:function(t){return this.minX!==t&&(this._oldValue.minX=this.minX,this.minX=t,this._notifyObservers(this._oldValue)),this},setMinY:function(t){return this.minY!==t&&(this._oldValue.minY=this.minY,this.minY=t,this._notifyObservers(this._oldValue)),this},setMaxX:function(t){return this.maxX!==t&&(this._oldValue.maxX=this.maxX,this.maxX=t,this._notifyObservers(this._oldValue)),this},setMaxY:function(t){return this.maxY!==t&&(this._oldValue.maxY=this.maxY,this.maxY=t,this._notifyObservers(this._oldValue)),this},set:i.Bounds2.prototype.set,equalsValue:function(t){return this.equals(t)},storeValue:function(){},storeInitialValue:function(t){this._initialMinX=t.minX,this._initialMinY=t.minY,this._initialMaxX=t.maxX,this._initialMaxY=t.maxY},reset:function(){this.setMinMax(this._initialMinX,this._initialMinY,this._initialMaxX,this._initialMaxY)},toString:function(){return"ObservableBounds2("+this.minX+", "+this.minY+", "+this.maxX+", "+this.maxY+")"}})),e.mixin(h,{defaultFactory:function(){return new h},constructorDuplicateFactory:function(t){return function(i,n,s,e){return t.length?t.pop().setMinMax(i,n,s,e):new h(i,n,s,e)}}}),h}),n("DOT/ObservableMatrix3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/extend","PHET_CORE/Poolable","AXON/Property","DOT/Matrix3"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/extend"),e=t("PHET_CORE/Poolable"),r=t("AXON/Property");t("DOT/Matrix3"),i.ObservableMatrix3=function(t,n,s,e,h,o,m,a,u,c){i.Matrix3.call(this,t,n,s,e,h,o,m,a,u,c),this._oldValue=this.copy(),this._skipChecks=!1,r.call(this,this)};var h=i.ObservableMatrix3;return n(i.Matrix3,h,s({},r.prototype,{get:function(){return this},rowMajor:function(t,n,s,e,r,h,o,m,a,u){var c=this._skipChecks,f=c||t!==this.entries[0]||e!==this.entries[1]||o!==this.entries[2]||n!==this.entries[3]||r!==this.entries[4]||m!==this.entries[5]||s!==this.entries[6]||h!==this.entries[7]||a!==this.entries[8]||u!==this.type;return f&&(!c&&this._oldValue&&(this._oldValue.entries[0]=this.entries[0],this._oldValue.entries[1]=this.entries[1],this._oldValue.entries[2]=this.entries[2],this._oldValue.entries[3]=this.entries[3],this._oldValue.entries[4]=this.entries[4],this._oldValue.entries[5]=this.entries[5],this._oldValue.entries[6]=this.entries[6],this._oldValue.entries[7]=this.entries[7],this._oldValue.entries[8]=this.entries[8],this._oldValue.type=this.type),this.entries[0]=t,this.entries[1]=e,this.entries[2]=o,this.entries[3]=n,this.entries[4]=r,this.entries[5]=m,this.entries[6]=s,this.entries[7]=h,this.entries[8]=a,this.type=void 0===u?0===o&&0===m&&1===a?i.Matrix3.Types.AFFINE:i.Matrix3.Types.OTHER:u,this._observers&&this._notifyObservers(c?null:this._oldValue)),this},set:i.Matrix3.prototype.set,equalsValue:function(t){return this.equals(t)},storeValue:function(){},storeInitialValue:function(t){this._initial00=t.m00(),this._initial01=t.m01(),this._initial02=t.m02(),this._initial10=t.m10(),this._initial11=t.m11(),this._initial12=t.m12(),this._initial20=t.m20(),this._initial21=t.m21(),this._initial22=t.m22(),this._initialType=t.type},reset:function(){this.rowMajor(this._initial00,this._initial01,this._initial02,this._initial10,this._initial11,this._initial12,this._initial20,this._initial21,this._initial22,this._initialType)},toString:i.Matrix3.prototype.toString})),e.mixin(h,{defaultFactory:function(){return new h},constructorDuplicateFactory:function(t){return function(i,n,s,e,r,o,m,a,u,c){return t.length?t.pop().rowMajor(i,n,s,e,r,o,m,a,u,c):new h(i,n,s,e,r,o,m,a,u,c)}}}),h}),n("DOT/ObservableVector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/extend","PHET_CORE/Poolable","AXON/Property","DOT/Vector2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("PHET_CORE/extend"),e=t("PHET_CORE/Poolable"),r=t("AXON/Property");t("DOT/Vector2"),i.ObservableVector2=function(t,n){i.Vector2.call(this,t,n),this._oldValue=this.copy(),r.call(this,this)};var h=i.ObservableVector2;return n(i.Vector2,h,s({},r.prototype,{get:function(){return this},setXY:function(t,i){return(this.x!==t||this.y!==i)&&(this._oldValue.x=this.x,this._oldValue.y=this.y,this.x=t,this.y=i,this._notifyObservers(this._oldValue)),this},setX:function(t){return this.x!==t&&(this._oldValue.x=this.x,this.x=t,this._notifyObservers(this._oldValue)),this},setY:function(t){return this.y!==t&&(this._oldValue.y=this.y,this.y=t,this._notifyObservers(this._oldValue)),this},set:i.Vector2.prototype.set,equalsValue:function(t){return this.equals(t)},storeValue:function(){},storeInitialValue:function(t){this._initialX=t.x,this._initialY=t.y},reset:function(){this.setXY(this._initialX,this._initialY)},toString:function(){return"ObservableVector2("+this.x+", "+this.y+")"}})),e.mixin(h,{defaultFactory:function(){return new h},constructorDuplicateFactory:function(t){return function(i,n){return t.length?t.pop().setXY(i,n):new h(i,n)}}}),h}),n("DOT/Permutation",["require","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){function i(t,n,s){if(0===t.length)s.call(void 0,n);else for(var e=0;e<t.length;e++){var r=t[e],h=t.slice(0);h.splice(e,1);var o=n.slice(0);o.push(r),i(h,o,s)}}var n=t("DOT/dot"),s=t("PHET_CORE/isArray");t("DOT/Util");var e=n.Permutation=function(t){this.indices=t};return e.identity=function(t){for(var i=new Array(t),n=0;t>n;n++)i[n]=n;return new e(i)},e.permutations=function(t){var i=[];return e.forEachPermutation(n.rangeInclusive(0,t-1),function(t){i.push(new e(t))}),i},e.forEachPermutation=function(t,n){i(t,[],n)},e.prototype={constructor:e,size:function(){return this.indices.length},apply:function(t){if(s(t)){if(t.length!==this.size())throw new Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=t[this.indices[n]];return i}return this.indices[t]},inverted:function(){for(var t=new Array(this.size()),i=0;i<this.size();i++)t[this.indices[i]]=i;return new e(t)},withIndicesPermuted:function(t){var i=[],n=this;return e.forEachPermutation(t,function(s){for(var r=n.indices,h=r.slice(0),o=0;o<t.length;o++)h[t[o]]=r[s[o]];i.push(new e(h))}),i},toString:function(){return"P["+this.indices.join(", ")+"]"}},e.testMe=function(t){var i=new e([1,4,3,2,0]);t.log(i.toString());var n=i.inverted();t.log(n.toString()),t.log(n.withIndicesPermuted([0,3,4]).toString()),t.log(e.permutations(4).toString())},e}),n("DOT/Plane3",["require","DOT/dot","DOT/Vector3"],function(t){var i=t("DOT/dot"),n=t("DOT/Vector3");i.Plane3=function(t,i){this.normal=t,this.distance=i};var s=i.Plane3;return s.prototype={constructor:s,intersectWithRay:function(t){return t.pointAtDistance(t.distanceToPlane(this))}},s.XY=new s(new n(0,0,1),0),s.XZ=new s(new n(0,1,0),0),s.YZ=new s(new n(1,0,0),0),s.fromTriangle=function(t,i,n){var e=n.minus(t).cross(i.minus(t));return 0===e.magnitude()?null:(e.normalize(),new s(e,e.dot(t)))},s}),n("DOT/Quaternion",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector3","DOT/Matrix3","DOT/Util"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/Poolable");t("DOT/Vector3"),t("DOT/Matrix3"),t("DOT/Util"),i.Quaternion=function(t,i,n,s){this.setXYZW(t,i,n,s)};var s=i.Quaternion;return s.prototype={constructor:s,isQuaternion:!0,setXYZW:function(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1},plus:function(t){return new s(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},timesScalar:function(t){return new s(this.x*t,this.y*t,this.z*t,this.w*t)},timesQuaternion:function(t){return new s(this.x*t.w-this.z*t.y+this.y*t.z+this.w*t.x,-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w)},timesVector3:function(t){return 0===t.magnitude()?new i.Vector3:new i.Vector3(this.w*this.w*t.x+2*this.y*this.w*t.z-2*this.z*this.w*t.y+this.x*this.x*t.x+2*this.y*this.x*t.y+2*this.z*this.x*t.z-this.z*this.z*t.x-this.y*this.y*t.x,2*this.x*this.y*t.x+this.y*this.y*t.y+2*this.z*this.y*t.z+2*this.w*this.z*t.x-this.z*this.z*t.y+this.w*this.w*t.y-2*this.x*this.w*t.z-this.x*this.x*t.y,2*this.x*this.z*t.x+2*this.y*this.z*t.y+this.z*this.z*t.z-2*this.w*this.y*t.x-this.y*this.y*t.z+2*this.w*this.x*t.y-this.x*this.x*t.z+this.w*this.w*t.z)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},normalized:function(){var t=this.magnitude();return this.timesScalar(1/t)},negated:function(){return new s(-this.x,-this.y,-this.z,-this.w)},toRotationMatrix:function(){var t=this.magnitudeSquared(),n=1===t?2:t>0?2/t:0,s=this.x*this.x*n,e=this.x*this.y*n,r=this.x*this.z*n,h=this.w*this.x*n,o=this.y*this.y*n,m=this.y*this.z*n,a=this.w*this.y*n,u=this.z*this.z*n,c=this.w*this.z*n;return i.Matrix3.dirtyFromPool().columnMajor(1-(o+u),e+c,r-a,e-c,1-(s+u),m+h,r+a,m-h,1-(s+o))}},s.fromEulerAngles=function(t,i,n){var e=Math.sin(.5*n),r=Math.cos(.5*n),h=Math.sin(.5*i),o=Math.cos(.5*i),m=Math.sin(.5*t),a=Math.cos(.5*t),u=o*r,c=h*e,f=o*e,l=h*r;return new s(u*m+c*a,l*a+f*m,f*a-l*m,u*a-c*m)},s.fromRotationMatrix=function(t){var i,n=t.m00(),e=t.m01(),r=t.m02(),h=t.m10(),o=t.m11(),m=t.m12(),a=t.m20(),u=t.m21(),c=t.m22(),f=n+o+c;return f>=0?(i=Math.sqrt(f+1),new s(.5*(u-m)/i,.5*(r-a)/i,.5*(h-e)/i,.5*i)):n>o&&n>c?(i=Math.sqrt(1+n-o-c),new s(.5*i,.5*(h+e)/i,.5*(r+a)/i,.5*(u-m)/i)):o>c?(i=Math.sqrt(1+o-n-c),new s(.5*(h+e)/i,.5*i,.5*(u+m)/i,.5*(r-a)/i)):(i=Math.sqrt(1+c-n-o),new s(.5*(r+a)/i,.5*(u+m)/i,.5*i,.5*(h-e)/i))},s.getRotationQuaternion=function(t,n){return s.fromRotationMatrix(i.Matrix3.rotateAToB(t,n))},s.slerp=function(t,i,n){if(t.x===i.x&&t.y===i.y&&t.z===i.z&&t.w===i.w)return t;var e=t.x*i.x+t.y*i.y+t.z*i.z+t.w*i.w;0>e&&(i=i.negated(),e=-e);var r=1-n,h=n;if(1-e>.1){var o=Math.acos(e),m=1/Math.sin(o);r=Math.sin((1-n)*o)*m,h=Math.sin(n*o)*m}return new s(r*t.x+h*i.x,r*t.y+h*i.y,r*t.z+h*i.z,r*t.w+h*i.w)},n.mixin(s,{defaultFactory:function(){return new s},constructorDuplicateFactory:function(t){return function(i,n,e,r){return t.length?t.pop().set(i,n,e,r):new s(i,n,e,r)}}}),s}),n("DOT/Ray2",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray2=function(t,i){this.pos=t,this.dir=i};var n=i.Ray2;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),n("DOT/Ray3",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray3=function(t,i){this.pos=t,this.dir=i};var n=i.Ray3;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},distanceToPlane:function(t){return(t.distance-this.pos.dot(t.normal))/this.dir.dot(t.normal)},toString:function(){return this.pos.toString()+" => "+this.dir.toString()}},n}),n("DOT/Rectangle",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){var i=t("DOT/dot"),n=t("PHET_CORE/inherit"),s=t("DOT/Bounds2");i.Rectangle=function(t,i,n,e){s.call(this,t,i,t+n,i+e)};var e=i.Rectangle;return n(s,e),e}),n("DOT/Sphere3",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Sphere3=function(t,i){this.center=t,this.radius=i};var n=i.Sphere3;return n.prototype={constructor:n,intersect:function(t,i){var n=t.dir,s=t.pos,e=s.minus(this.center),r=n.dot(e),h=e.magnitudeSquared(),o=4*r*r-4*(h-this.radius*this.radius);if(i>o)return null;var m=n.dot(this.center)-n.dot(s),a=Math.sqrt(o)/2,u=m-a,c=m+a;if(i>c)return null;var f=t.pointAtDistance(c),l=f.minus(this.center).normalized();if(i>u)return{distance:c,hitPoint:f,normal:l.negated(),fromOutside:!1};var x=t.pointAtDistance(u),d=x.minus(this.center).normalized();return{distance:u,hitPoint:x,normal:d,fromOutside:!0}},intersections:function(t,i){var n=t.dir,s=t.pos,e=s.minus(this.center),r=n.dot(e),h=e.magnitudeSquared(),o=4*r*r-4*(h-this.radius*this.radius);if(i>o)return[];var m=n.dot(this.center)-n.dot(s),a=Math.sqrt(o)/2,u=m-a,c=m+a;if(i>c)return[];var f=t.pointAtDistance(c),l=f.minus(this.center).normalized(),x=t.pointAtDistance(u),d=x.minus(this.center).normalized(),y={distance:c,hitPoint:f,normal:l.negated(),fromOutside:!1},v={distance:u,hitPoint:x,normal:d,fromOutside:!0};return i>u?[y,v]:[v,y]}},n}),n("DOT/Transform3",["require","DOT/dot","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){var i=t("DOT/dot");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2"),i.Transform3=function(t){this.listeners=[],this.setMatrix(void 0===t?i.Matrix3.IDENTITY:t)};var n=i.Transform3;return n.prototype={constructor:n,setMatrix:function(t){if(t.isFinite()){var i,n=this.matrix,s=this.listeners.length;for(i=0;s>i;i++)this.listeners[i].before(t,n);for(this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null,i=0;s>i;i++)this.listeners[i].after(t,n)}},prepend:function(t){this.setMatrix(t.timesMatrix(this.matrix))},prependTranslation:function(t,n){this.setMatrix(i.Matrix3.translationTimesMatrix(t,n,this.matrix))},append:function(t){this.setMatrix(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new n(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed},deepCopy:function(){var t=new n(this.matrix.copy());t.inverse=this.inverse?this.inverse.copy():null,t.matrixTransposed=this.matrixTransposed?this.matrixTransposed.copy():null,t.inverseTransposed=this.inverseTransposed?this.inverseTransposed.copy():null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===i.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){var n=this.getMatrix();return new i.Vector2(n.m00()*t.x+n.m01()*t.y,n.m10()*t.x+n.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t)},transformX:function(t){var i=this.getMatrix();return i.m00()*t+i.m02()},transformY:function(t){var i=this.getMatrix();return i.m11()*t+i.m12()},transformDeltaX:function(t){var i=this.getMatrix();return i.m00()*t},transformDeltaY:function(t){var i=this.getMatrix();return i.m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new i.Ray2(this.transformPosition2(t.pos),this.transformDelta2(t.dir).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){var n=this.getInverse();return new i.Vector2(n.m00()*t.x+n.m01()*t.y,n.m10()*t.x+n.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t)},inverseX:function(t){var i=this.getInverse();return i.m00()*t+i.m02()},inverseY:function(t){var i=this.getInverse();return i.m11()*t+i.m12()},inverseDeltaX:function(t){var i=this.getInverse();return i.m00()*t},inverseDeltaY:function(t){var i=this.getInverse();return i.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new i.Ray2(this.inversePosition2(t.pos),this.inverseDelta2(t.dir).normalized())},addTransformListener:function(t){this.listeners.push(t)},prependTransformListener:function(t){this.listeners.unshift(t)},removeTransformListener:function(t){this.listeners.splice(_.indexOf(this.listeners,t),1)}},n}),n("DOT/Transform4",["require","DOT/dot","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){var i=t("DOT/dot");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3"),i.Transform4=function(t){this.setMatrix(void 0===t?i.Matrix4.IDENTITY:t)};var n=i.Transform4;return n.prototype={constructor:n,setMatrix:function(t){this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},prepend:function(t){this.setMatrix(t.timesMatrix(this.matrix))},append:function(t){this.setMatrix(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},isIdentity:function(){return this.matrix.type===i.Matrix4.Types.IDENTITY},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new i.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new i.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new i.Vector3(0,0,t)).z},transformRay:function(t){return new i.Ray3(this.transformPosition3(t.pos),this.transformPosition3(t.pos.plus(t.dir)).minus(this.transformPosition3(t.pos)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(i.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new i.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new i.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new i.Vector3(0,0,t)).z},inverseRay:function(t){return new i.Ray3(this.inversePosition3(t.pos),this.inversePosition3(t.pos.plus(t.dir)).minus(this.inversePosition3(t.pos)))}},n}),n("main",["DOT/dot","DOT/Bounds2","DOT/Bounds3","DOT/Complex","DOT/ConvexHull2","DOT/Dimension2","DOT/EigenvalueDecomposition","DOT/LinearFunction","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/ObservableBounds2","DOT/ObservableMatrix3","DOT/ObservableVector2","DOT/Permutation","DOT/Plane3","DOT/QRDecomposition","DOT/Quaternion","DOT/Ray2","DOT/Ray3","DOT/Rectangle","DOT/SingularValueDecomposition","DOT/Sphere3","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){return t}),n("PHET_CORE/arrayRemove",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.arrayRemove=function(t,i){var n=_.indexOf(t,i);t.splice(n,1)},i.arrayRemove}),n("PHET_CORE/cleanArray",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.cleanArray=function(t){if(t){for(;t.length;)t.pop();return t}return[]},i.cleanArray}),n("PHET_CORE/collect",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.collect=function(t){var i=[];return t(function(t){i.push(t)}),i},i.collect}),n("PHET_CORE/detectPrefix",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.detectPrefix=function(t,i){return void 0!==t[i]?i:(i=i.charAt(0).toUpperCase()+i.slice(1),void 0!==t["moz"+i]?"moz"+i:void 0!==t["Moz"+i]?"Moz"+i:void 0!==t["webkit"+i]?"webkit"+i:void 0!==t["ms"+i]?"ms"+i:void 0!==t["o"+i]?"o"+i:void 0)},i.detectPrefix}),n("PHET_CORE/detectPrefixEvent",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.detectPrefixEvent=function(t,i){return void 0!==t["on"+i]?i:void 0!==t["onmoz"+i]?"moz"+i:void 0!==t["onMoz"+i]?"Moz"+i:void 0!==t["onwebkit"+i]?"webkit"+i:void 0!==t["onms"+i]?"ms"+i:void 0!==t["ono"+i]?"o"+i:void 0},i.detectPrefixEvent}),n("PHET_CORE/escapeHTML",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.escapeHTML=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")},i.escapeHTML}),n("PHET_CORE/EventTimer",["require","PHET_CORE/core","PHET_CORE/inherit"],function(t){var i=t("PHET_CORE/core"),n=t("PHET_CORE/inherit");return i.EventTimer=function(t,i){this.eventModel=t,this.eventCallback=i,this.timeBeforeNextEvent=this.eventModel.getPeriodBeforeNextEvent()},n(Object,i.EventTimer,{step:function(t){for(;t>=this.timeBeforeNextEvent;)t-=this.timeBeforeNextEvent,this.timeBeforeNextEvent=this.eventModel.getPeriodBeforeNextEvent(),this.eventCallback(t);this.timeBeforeNextEvent-=t}}),i.EventTimer.ConstantEventModel=n(Object,function(t){this.rate=t},{getPeriodBeforeNextEvent:function(){return 1/this.rate}}),i.EventTimer.UniformEventModel=n(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return 2*t/this.rate}}),i.EventTimer.PoissonEventModel=n(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return-Math.log(t)/this.rate}}),i.EventTimer}),n("PHET_CORE/loadScript",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.loadScript=function(t){"string"==typeof t&&(t={src:t});var i=t.src,n=t.callback,s=void 0===t.async?!0:t.async,e=void 0===t.cacheBuster?!1:t.cacheBuster,r=!1,h=document.createElement("script");h.type="text/javascript",h.async=s,h.onload=h.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||r||(r=!0,n&&n())},h.src=i+(e?"?random="+Math.random().toFixed(10):"");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(h,o)},i.loadScript}),n("PHET_CORE/pairs",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.pairs=function(t){var i=[],n=t.length;
if(n>1)for(var s=0;n-1>s;s++)for(var e=t[s],r=s+1;n>r;r++)i.push([e,t[r]]);return i},i.pairs}),n("PHET_CORE/partition",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core");return i.partition=function(t,i){for(var n=[],s=[],e=t.length,r=0;e>r;r++)i(t[r])?n.push(t[r]):s.push(t[r]);return[n,s]},i.partition}),n("PHET_CORE/platform",["require","PHET_CORE/core"],function(t){function i(t){return n()===t}function n(){var t=-1,i=null;return"Microsoft Internet Explorer"===navigator.appName?(i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==i.exec(e)&&(t=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==i.exec(e)&&(t=parseFloat(RegExp.$1))),t}var s=t("PHET_CORE/core"),e=navigator.userAgent;return s.platform={get firefox(){return e.toLowerCase().indexOf("firefox")>-1},get mobileSafari(){return e.match(/(iPod|iPhone|iPad)/)&&e.match(/AppleWebKit/)},get safari5(){return e.match(/Version\/5\./)&&e.match(/Safari\//)&&e.match(/AppleWebKit/)},get safari6(){return e.match(/Version\/6\./)&&e.match(/Safari\//)&&e.match(/AppleWebKit/)},get safari7(){return e.match(/Version\/7\./)&&e.match(/Safari\//)&&e.match(/AppleWebKit/)},get ie9(){return i(9)},get ie10(){return i(10)},get ie11(){return i(11)},get ie(){return-1!==n()},get android(){return e.indexOf("Android")>0},get chromium(){return/chrom(e|ium)/.test(e.toLowerCase())}},s.platform}),n("PHET_CORE/profiler",["require","PHET_CORE/core"],function(t){var i=t("PHET_CORE/core"),n=[],s={},e=0,r=[];return i.profiler={displayCount:1e3,start:function(t){var i=Date.now();n.push({name:t,time:i})},addListener:function(t){r.push(t)},stop:function(){var t=Date.now(),i=n.pop(),h=t-i.time;if(s[i.name]||(s[i.name]=[]),s[i.name].push(h),e++,e%this.displayCount===0){var o=JSON.stringify(this.toJSON());console.log(o);for(var m=0;m<r.length;m++)r[m](o);s={}}},toJSON:function(){var t,i={};for(var n in s){t=0;for(var e=0;e<s[n].length;e++){var r=s[n][e];t+=r}var h=t/s[n].length;i[n]={average:h,count:s[n].length}}return i},testSelf:function(){var t,i,n=this;this.displayCount=1e7;for(var s=0;10>s;s++){n.start("physics");for(var e=0;1e4>e;e++){n.start("mloop");for(var r=0;1e4>r;r++)t=2e4;n.stop(),n.start("xloop");for(var h=0;2e4>h;h++)i=2e4;n.stop()}n.stop()}console.log("results: ",t,i),console.log(JSON.stringify(this.toJSON()))}},i.profiler}),n("PHET_CORE/main",["PHET_CORE/core","PHET_CORE/arrayRemove","PHET_CORE/cleanArray","PHET_CORE/collect","PHET_CORE/detectPrefix","PHET_CORE/detectPrefixEvent","PHET_CORE/escapeHTML","PHET_CORE/EventTimer","PHET_CORE/extend","PHET_CORE/inherit","PHET_CORE/isArray","PHET_CORE/loadScript","PHET_CORE/pairs","PHET_CORE/partition","PHET_CORE/phetAllocation","PHET_CORE/platform","PHET_CORE/Poolable","PHET_CORE/profiler"],function(t){return t}),i.config({deps:["main","PHET_CORE/main"],paths:{underscore:"../../sherpa/lodash-2.4.1",DOT:".",PHET_CORE:"../../phet-core/js",AXON:"../../axon/js"},shim:{underscore:{exports:"_"}},urlArgs:Date.now()}),n("config",function(){}),window.dot=i("main"),window.core=i("PHET_CORE/main")}();
//# sourceMappingURL=dot.min.js.map