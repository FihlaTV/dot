!function(){if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");!function(){"use strict";window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(t,i){var n="function"==typeof t?t():t;if(!n){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(e){i=i+", stack=\n"+e.stack}throw console&&console.log&&console.log("Assertion failed: "+i),new Error("Assertion failed: "+i)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")}}();var t,i,n;!function(e){function s(t,i){return w.call(t,i)}function r(t,i){var n,e,s,r,h,o,a,m,u,c,f,d=i&&i.split("/"),l=y.map,x=l&&l["*"]||{};if(t&&"."===t.charAt(0))if(i){for(d=d.slice(0,d.length-1),t=t.split("/"),h=t.length-1,y.nodeIdCompat&&M.test(t[h])&&(t[h]=t[h].replace(M,"")),t=d.concat(t),u=0;u<t.length;u+=1)if(f=t[u],"."===f)t.splice(u,1),u-=1;else if(".."===f){if(1===u&&(".."===t[2]||".."===t[0]))break;u>0&&(t.splice(u-1,2),u-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((d||x)&&l){for(n=t.split("/"),u=n.length;u>0;u-=1){if(e=n.slice(0,u).join("/"),d)for(c=d.length;c>0;c-=1)if(s=l[d.slice(0,c).join("/")],s&&(s=s[e])){r=s,o=u;break}if(r)break;!a&&x&&x[e]&&(a=x[e],m=u)}!r&&a&&(r=a,o=m),r&&(n.splice(0,o,r),t=n.join("/"))}return t}function h(t,i){return function(){return d.apply(e,T.call(arguments,0).concat([t,i]))}}function o(t){return function(i){return r(i,t)}}function a(t){return function(i){v[t]=i}}function m(t){if(s(p,t)){var i=p[t];delete p[t],g[t]=!0,f.apply(e,i)}if(!s(v,t)&&!s(g,t))throw new Error("No "+t);return v[t]}function u(t){var i,n=t?t.indexOf("!"):-1;return n>-1&&(i=t.substring(0,n),t=t.substring(n+1,t.length)),[i,t]}function c(t){return function(){return y&&y.config&&y.config[t]||{}}}var f,d,l,x,v={},p={},y={},g={},w=Object.prototype.hasOwnProperty,T=[].slice,M=/\.js$/;l=function(t,i){var n,e=u(t),s=e[0];return t=e[1],s&&(s=r(s,i),n=m(s)),s?t=n&&n.normalize?n.normalize(t,o(i)):r(t,i):(t=r(t,i),e=u(t),s=e[0],t=e[1],s&&(n=m(s))),{f:s?s+"!"+t:t,n:t,pr:s,p:n}},x={require:function(t){return h(t)},exports:function(t){var i=v[t];return"undefined"!=typeof i?i:v[t]={}},module:function(t){return{id:t,uri:"",exports:v[t],config:c(t)}}},f=function(t,i,n,r){var o,u,c,f,d,y,w=[],T=typeof n;if(r=r||t,"undefined"===T||"function"===T){for(i=!i.length&&n.length?["require","exports","module"]:i,d=0;d<i.length;d+=1)if(f=l(i[d],r),u=f.f,"require"===u)w[d]=x.require(t);else if("exports"===u)w[d]=x.exports(t),y=!0;else if("module"===u)o=w[d]=x.module(t);else if(s(v,u)||s(p,u)||s(g,u))w[d]=m(u);else{if(!f.p)throw new Error(t+" missing "+u);f.p.load(f.n,h(r,!0),a(u),{}),w[d]=v[u]}c=n?n.apply(v[t],w):void 0,t&&(o&&o.exports!==e&&o.exports!==v[t]?v[t]=o.exports:c===e&&y||(v[t]=c))}else t&&(v[t]=n)},t=i=d=function(t,i,n,s,r){if("string"==typeof t)return x[t]?x[t](i):m(l(t,i).f);if(!t.splice){if(y=t,y.deps&&d(y.deps,y.callback),!i)return;i.splice?(t=i,i=n,n=null):t=e}return i=i||function(){},"function"==typeof n&&(n=s,s=r),s?f(e,t,i,n):setTimeout(function(){f(e,t,i,n)},4),d},d.config=function(t){return d(t)},t._defined=v,n=function(t,i,n){i.splice||(n=i,i=[]),s(v,t)||s(p,t)||(p[t]=[t,i,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("PHET_CORE/Namespace",["require"],function(t){"use strict";function i(t){this.name=t,window.phet&&(window.phet[t]=this)}return i.prototype={constructor:i,register:function(t,i){if(t.indexOf(".")<0)this[t]=i;else{for(var n=t.split("."),e=this,s=0;s<n.length-1;s++)e=e[n[s]];var r=n[n.length-1];e[r]=i}return i}},i}),n("PHET_CORE/phetCore",["require","PHET_CORE/Namespace"],function(t){"use strict";var i=t("PHET_CORE/Namespace"),n=new i("phetCore");return n.register("Namespace",i),n}),n("PHET_CORE/phetAllocation",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){if(window.alloc){var i;try{throw new Error}catch(n){i=n.stack}window.alloc[t]||(window.alloc[t]={count:0,stacks:{}});var e=window.alloc[t];e.count++,e.stacks[i]?e.stacks[i]+=1:e.stacks[i]=1,e.report=function(){var t=Object.keys(e.stacks);t=_.sortBy(t,function(t){return e.stacks[t]}),_.each(t,function(t){console.log(e.stacks[t]+": "+t)})}}}var n=t("PHET_CORE/phetCore");return n.register("phetAllocation",i),i}),n("DOT/dot",["require","PHET_CORE/Namespace","PHET_CORE/phetAllocation"],function(t){"use strict";var i=t("PHET_CORE/Namespace");window.phetAllocation=t("PHET_CORE/phetAllocation");var n=new i("dot");return n.register("v2",function(t,i){return new n.Vector2(t,i)}),n.register("v3",function(t,i,e){return new n.Vector3(t,i,e)}),n.register("v4",function(t,i,e,s){return new n.Vector4(t,i,e,s)}),n.register("FastArray",window.Float64Array?window.Float64Array:window.Array),n}),n("PHET_CORE/extend",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var n in i)Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}),t}var n=t("PHET_CORE/phetCore");return n.register("extend",i),i}),n("PHET_CORE/inherit",["require","PHET_CORE/phetCore","PHET_CORE/extend"],function(t){"use strict";function i(t,i,n,s){function r(){}return r.prototype=t.prototype,i.prototype=e(new r,{constructor:i},n),e(i,s),i}var n=t("PHET_CORE/phetCore"),e=t("PHET_CORE/extend");return n.register("inherit",i),i}),n("PHET_CORE/Poolable",["require","PHET_CORE/phetCore","PHET_CORE/extend"],function(t){"use strict";var i=t("PHET_CORE/phetCore"),n=t("PHET_CORE/extend"),e={mixin:function(t,i){var e=t.prototype;i=n({maxPoolSize:50,initialSize:0},i);var s=t.pool=[];i.defaultFactory&&(t.dirtyFromPool=function(){return s.length?s.pop():i.defaultFactory()},t.fillPool=function(t){for(;s.length<t;)s.push(i.defaultFactory())},t.fillPool(i.initialSize)),i.constructorDuplicateFactory&&(t.createFromPool=i.constructorDuplicateFactory(s)),e.freeToPool=function(){s.length<i.maxPoolSize&&s.push(this)}}};return i.register("Poolable",e),e}),n("DOT/Util",["require","DOT/dot"],function(t){"use strict";var i,n,e,s=t("DOT/dot"),r=Number.MIN_VALUE,h=2*Math.PI,o={clamp:function(t,i,n){return i>t?i:t>n?n:t},moduloBetweenDown:function(t,i,n){var e=n-i,s=(t-i)%e;return 0>s&&(s+=e),s+i},moduloBetweenUp:function(t,i,n){return-o.moduloBetweenDown(-t,-n,-i)},rangeInclusive:function(t,i){if(t>i)return[];for(var n=new Array(i-t+1),e=t;i>=e;e++)n[e-t]=e;return n},rangeExclusive:function(t,i){return o.rangeInclusive(t+1,i-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},gcd:function(t,i){return 0===i?t:this.gcd(i,t%i)},lineLineIntersection:function(t,i,n,e){var r=t.x-i.x,h=n.x-e.x,o=t.y-i.y,a=n.y-e.y,m=r*a-o*h,u=t.x*i.y-t.y*i.x,c=n.x*e.y-n.y*e.x;return new s.Vector2((u*h-r*c)/m,(u*a-o*c)/m)},sphereRayIntersection:function(t,i,n){n=void 0===n?1e-5:n;var e=new s.Vector3,r=i.direction,h=i.position,o=h.minus(e),a=r.dot(o),m=o.magnitudeSquared(),u=4*a*a-4*(m-t*t);if(n>u)return null;var c=r.dot(e)-r.dot(h),f=Math.sqrt(u)/2,d=c-f,l=c+f;if(n>l)return null;var x=i.pointAtDistance(l),v=x.minus(e).normalized();if(n>d)return{distance:l,hitPoint:x,normal:v.negated(),fromOutside:!1};var p=i.pointAtDistance(d),y=p.minus(e).normalized();return{distance:d,hitPoint:p,normal:y,fromOutside:!0}},solveQuadraticRootsReal:function(t,i,n){var e=1e7;if(0===t||Math.abs(i/t)>e||Math.abs(n/t)>e)return[-n/i];var s=i*i-4*t*n;if(0>s)return[];var r=Math.sqrt(s);return[(-i-r)/(2*t),(-i+r)/(2*t)]},solveCubicRootsReal:function(t,i,n,e){var s=1e7;if(0===t||Math.abs(i/t)>s||Math.abs(n/t)>s||Math.abs(e/t)>s)return o.solveQuadraticRootsReal(i,n,e);if(0===e||Math.abs(t/e)>s||Math.abs(i/e)>s||Math.abs(n/e)>s)return o.solveQuadraticRootsReal(t,i,n);i/=t,n/=t,e/=t;var r=(3*n-i*i)/9,h=(-(27*e)+i*(9*n-2*(i*i)))/54,a=r*r*r+h*h,m=i/3;if(a>0){var u=Math.sqrt(a);return[o.cubeRoot(h+u)+o.cubeRoot(h-u)-m]}if(0===a){var c=o.cubeRoot(h),f=m-c;return[-m+2*c,f,f]}var d=-r*r*r;d=Math.acos(h/Math.sqrt(d));var l=2*Math.sqrt(-r);return[-m+l*Math.cos(d/3),-m+l*Math.cos((d+2*Math.PI)/3),-m+l*Math.cos((d+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,i,n,e,s){return(e-n)/(i-t)*(s-t)+n},roundSymmetric:function(t){return(0>t?-1:1)*Math.round(Math.abs(t))},toFixed:function(t,i){var n=Math.pow(10,i),e=o.roundSymmetric(t*n)/n;return e.toFixed(i)},toFixedNumber:function(t,i){return parseFloat(o.toFixed(t,i))},isInteger:function(t){return"number"==typeof t&&t%1===0},lineSegmentIntersection:function(t,i,n,e,r,h,o,a){var m=(o-r)*(i-h)-(a-h)*(t-r),u=(n-t)*(i-h)-(e-i)*(t-r),c=(a-h)*(n-t)-(o-r)*(e-i);if(0===c)return null;var f=m/c,d=u/c;if(f>=0&&1>=f&&d>=0&&1>=d){var l=t+f*(n-t),x=i+f*(e-i);return new s.Vector2(l,x)}return null},distToSegmentSquared:function(t,i,n){var e=i.distanceSquared(n);if(0===e)return t.distanceSquared(i);var r=((t.x-i.x)*(n.x-i.x)+(t.y-i.y)*(n.y-i.y))/e;return 0>r?t.distanceSquared(i):r>1?t.distanceSquared(n):t.distanceSquared(new s.Vector2(i.x+r*(n.x-i.x),i.y+r*(n.y-i.y)))},distToSegment:function(t,i,n){return Math.sqrt(this.distToSegmentSquared(t,i,n))},arePointsCollinear:function(t,i,n,e){return void 0===e&&(e=0),o.triangleArea(t,i,n)<=e},triangleArea:function(t,i,n){return Math.abs(o.triangleAreaSigned(t,i,n))},triangleAreaSigned:function(t,i,n){return t.x*(i.y-n.y)+i.x*(n.y-t.y)+n.x*(t.y-i.y)},log10:function(t){return Math.log(t)/Math.LN10},boxMullerTransform:function(t,s){if(i=!i,!i)return e*s+t;var o,a;do o=Math.random(),a=Math.random();while(r>=o);return n=Math.sqrt(-2*Math.log(o))*Math.cos(h*a),e=Math.sqrt(-2*Math.log(o))*Math.sin(h*a),n*s+t}};return s.register("Util",o),s.clamp=o.clamp,s.moduloBetweenDown=o.moduloBetweenDown,s.moduloBetweenUp=o.moduloBetweenUp,s.rangeInclusive=o.rangeInclusive,s.rangeExclusive=o.rangeExclusive,s.toRadians=o.toRadians,s.toDegrees=o.toDegrees,s.lineLineIntersection=o.lineLineIntersection,s.sphereRayIntersection=o.sphereRayIntersection,s.solveQuadraticRootsReal=o.solveQuadraticRootsReal,s.solveCubicRootsReal=o.solveCubicRootsReal,s.cubeRoot=o.cubeRoot,s.linear=o.linear,s.boxMullerTransform=o.boxMullerTransform,o}),n("DOT/Vector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){"use strict";function i(t,i){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),n.register("Vector2",i),e(Object,i,{isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,i){var n=this.x-t,e=this.y-i;return Math.sqrt(n*n+e*e)},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y;return i*i+n*n},distanceSquaredXY:function(t,i){var n=this.x-t,e=this.y-i;return n*n+e*e},dot:function(t){return this.x*t.x+this.y*t.y},dotXY:function(t,i){return this.x*t+this.y*i},angle:function(){return Math.atan2(this.y,this.x)},angleBetween:function(t){var i=this.magnitude(),e=t.magnitude();return Math.acos(n.clamp((this.x*t.x+this.y*t.y)/(i*e),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,i){return i||(i=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(t){return t?t.set(this):new i(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new i(this.x/t,this.y/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new i(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new i(this.x*t.x,this.y*t.y)},plus:function(t){return new i(this.x+t.x,this.y+t.y)},plusXY:function(t,n){return new i(this.x+t,this.y+n)},plusScalar:function(t){return new i(this.x+t,this.y+t)},minus:function(t){return new i(this.x-t.x,this.y-t.y)},minusXY:function(t,n){return new i(this.x-t,this.y-n)},minusScalar:function(t){return new i(this.x-t,this.y-t)},dividedScalar:function(t){return new i(this.x/t,this.y/t)},negated:function(){return new i(-this.x,-this.y)},perpendicular:function(){return new i(this.y,-this.x)},rotated:function(t){var n=this.angle()+t,e=this.magnitude();return new i(e*Math.cos(n),e*Math.sin(n))},blend:function(t,n){return new i(this.x+(t.x-this.x)*n,this.y+(t.y-this.y)*n)},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new n.Vector3(this.x,this.y,0)},setXY:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},set:function(t){return this.setXY(t.x,t.y)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXY(this.x+t.x,this.y+t.y)},addXY:function(t,i){return this.setXY(this.x+t,this.y+i)},addScalar:function(t){return this.setXY(this.x+t,this.y+t)},subtract:function(t){return this.setXY(this.x-t.x,this.y-t.y)},subtractXY:function(t,i){return this.setXY(this.x-t,this.y-i)},subtractScalar:function(t){return this.setXY(this.x-t,this.y-t)},multiplyScalar:function(t){return this.setXY(this.x*t,this.y*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXY(this.x*t.x,this.y*t.y)},divideScalar:function(t){return this.setXY(this.x/t,this.y/t)},negate:function(){return this.setXY(-this.x,-this.y)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},rotate:function(t){var i=this.angle()+t,n=this.magnitude();return this.setXY(n*Math.cos(i),n*Math.sin(i))},setPolar:function(t,i){return this.setXY(t*Math.cos(i),t*Math.sin(i))},toStateObject:function(){return{x:this.x,y:this.y}}},{createPolar:function(t,n){return(new i).setPolar(t,n)},fromStateObject:function(t){return new i(t.x,t.y)}}),s.mixin(i,{defaultFactory:function(){return new i},constructorDuplicateFactory:function(t){return function(n,e){return t.length?t.pop().setXY(n,e):new i(n,e)}}}),i.Immutable=function(t,n){i.call(this,t,n)};var r=i.Immutable;return e(i,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},r.mutableOverrideHelper("setXY"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),i.ZERO=new i(0,0),i.X_UNIT=new i(1,0),i.Y_UNIT=new i(0,1),i}),n("DOT/Bounds2",["require","DOT/dot","DOT/Vector2","PHET_CORE/inherit","PHET_CORE/Poolable"],function(t){"use strict";function i(t,i,n,e){this.minX=t,this.minY=i,this.maxX=n,this.maxY=e}var n=t("DOT/dot"),e=t("DOT/Vector2"),s=t("PHET_CORE/inherit"),r=t("PHET_CORE/Poolable"),h=new n.Vector2;return n.register("Bounds2",i),s(Object,i,{isBounds:!0,dimension:2,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getLeftTop:function(){return new n.Vector2(this.minX,this.minY)},get leftTop(){return this.getLeftTop()},getCenterTop:function(){return new n.Vector2(this.getCenterX(),this.minY)},get centerTop(){return this.getCenterTop()},getRightTop:function(){return new n.Vector2(this.maxX,this.minY)},get rightTop(){return this.getRightTop()},getLeftCenter:function(){return new n.Vector2(this.minX,this.getCenterY())},get leftCenter(){return this.getLeftCenter()},getCenter:function(){return new n.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getRightCenter:function(){return new n.Vector2(this.maxX,this.getCenterY())},get rightCenter(){return this.getRightCenter()},getLeftBottom:function(){return new n.Vector2(this.minX,this.maxY)},get leftBottom(){return this.getLeftBottom()},getCenterBottom:function(){return new n.Vector2(this.getCenterX(),this.maxY)},get centerBottom(){return this.getCenterBottom()},getRightBottom:function(){return new n.Vector2(this.maxX,this.maxY)},get rightBottom(){return this.getRightBottom()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},closestPointTo:function(t){if(this.containsCoordinates(t.x,t.y))return t;var i=Math.max(Math.min(t.x,this.maxX),this.x),n=Math.max(Math.min(t.y,this.maxY),this.y);return new e(i,n)},containsCoordinates:function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){var i=Math.max(this.minX,t.minX),n=Math.max(this.minY,t.minY),e=Math.min(this.maxX,t.maxX),s=Math.min(this.maxY,t.maxY);return e-i>=0&&s-n>=0},minimumDistanceToPointSquared:function(t){var i,n=t.x<this.minX?this.minX:t.x>this.maxX?this.maxX:null,e=t.y<this.minY?this.minY:t.y>this.maxY?this.maxY:null;if(null===n&&null===e)return 0;if(null===n)return i=e-t.y,i*i;if(null===e)return i=n-t.x,i*i;var s=n-t.x,r=e-t.y;return s*s+r*r},maximumDistanceToPointSquared:function(t){var i=t.x>this.getCenterX()?this.minX:this.maxX,n=t.y>this.getCenterY()?this.minY:this.maxY;return i-=t.x,n-=t.y,i*i+n*n},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,i){i=void 0!==i?i:0;var n=this.isFinite(),e=t.isFinite();return n&&e?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i:n!==e?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)},copy:function(t){return t?t.set(this):new i(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new i(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new i(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,n){return new i(Math.min(this.minX,t),Math.min(this.minY,n),Math.max(this.maxX,t),Math.max(this.maxY,n))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withMinX:function(t){return new i(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new i(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new i(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new i(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new i(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new i(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new i(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilatedX:function(t){return new i(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilatedY:function(t){return new i(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilatedXY:function(t,n){return new i(this.minX-t,this.minY-n,this.maxX+t,this.maxY+n)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedXY:function(t,i){return this.dilatedXY(-t,-i)},withOffsets:function(t,n,e,s){return new i(this.minX-t,this.minY-n,this.maxX+e,this.maxY+s)},shiftedX:function(t){return new i(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new i(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,n){return new i(this.minX+t,this.minY+n,this.maxX+t,this.maxY+n)},setMinMax:function(t,i,n,e){return this.minX=t,this.minY=i,this.maxX=n,this.maxY=e,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},addCoordinates:function(t,i){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},addPoint:function(t){return this.addCoordinates(t.x,t.y)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transform:function(t){if(this.isEmpty())return this;if(t.isIdentity())return this;var i=this.minX,e=this.minY,s=this.maxX,r=this.maxY;return this.set(n.Bounds2.NOTHING),this.addPoint(t.multiplyVector2(h.setXY(i,e))),this.addPoint(t.multiplyVector2(h.setXY(i,r))),this.addPoint(t.multiplyVector2(h.setXY(s,e))),this.addPoint(t.multiplyVector2(h.setXY(s,r))),this},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilateXY:function(t,i){return this.setMinMax(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeXY:function(t,i){return this.dilateXY(-t,-i)},offset:function(t,n,e,s){return new i(this.minX-t,this.minY-n,this.maxX+e,this.maxY+s)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.maxX,this.maxY+t)},shift:function(t,i){return this.setMinMax(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},getClosestPoint:function(t,i,e){return e?e.setXY(t,i):e=new n.Vector2(t,i),e.x<this.minX&&(e.x=this.minX),e.x>this.maxX&&(e.x=this.maxX),e.y<this.minY&&(e.y=this.minY),e.y>this.maxY&&(e.y=this.maxY),e}},{rect:function(t,n,e,s){return new i(t,n,t+e,n+s)},point:function(t,e){if(t instanceof n.Vector2){var s=t;return new i(s.x,s.y,s.x,s.y)}return new i(t,e,t,e)}}),r.mixin(i,{defaultFactory:function(){return i.NOTHING.copy()},constructorDuplicateFactory:function(t){return function(n,e,s,r){return t.length?t.pop().setMinMax(n,e,s,r):new i(n,e,s,r)}}}),i.NOTHING=new i(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),i.EVERYTHING=new i(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i}),n("DOT/BinPacker",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){"use strict";function i(t){this.rootBin=new n.BinPacker.Bin(t,null)}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("DOT/Bounds2");return n.register("BinPacker",i),e(Object,i,{allocate:function(t,i){var n=this.rootBin.findAvailableBin(t,i);if(n){var e=n.split(t,i);return e.use(),e}return null},deallocate:function(t){t.unuse()},toString:function(){function t(e){i+=n+e.toString()+"\n",n+="  ",_.each(e.children,t),n=n.substring(2)}var i="",n="";return t(this.rootBin),i}}),i.Bin=function(t,i){this.bounds=t,this.parent=i,this.isSplit=!1,this.isUsed=!1,this.children=[]},e(Object,i.Bin,{findAvailableBin:function(t,i){if(this.isUsed)return null;if(this.bounds.width<t||this.bounds.height<i)return null;if(this.isSplit){for(var n=0;n<this.children.length;n++){var e=this.children[n].findAvailableBin(t,i);if(e)return e}return null}return this},split:function(t,i){if(t===this.bounds.width&&i===this.bounds.height)return this;this.isSplit=!0;var e=this.bounds.minX+t,r=this.bounds.minY+i,h=new s(this.bounds.minX,this.bounds.minY,e,r),o=new s(e,this.bounds.minY,this.bounds.maxX,r),a=new s(this.bounds.minX,r,this.bounds.maxX,this.bounds.maxY),m=new n.BinPacker.Bin(h,this);return this.children.push(m),o.hasNonzeroArea()&&this.children.push(new n.BinPacker.Bin(o,this)),a.hasNonzeroArea()&&this.children.push(new n.BinPacker.Bin(a,this)),m},use:function(){this.isUsed=!0},unuse:function(){this.isUsed=!1,this.parent&&this.parent.attemptToCollapse()},attemptToCollapse:function(){for(var t=0;t<this.children.length;t++){var i=this.children[t];if(i.isSplit||i.isUsed)return}this.children=[],this.isSplit=!1,this.parent&&this.parent.attemptToCollapse()},toString:function(){return this.bounds.toString()+(this.isUsed?" used":"")}}),i}),n("DOT/Vector4",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){"use strict";function i(t,i,n,e){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==n?n:0,this.w=void 0!==e?e:1}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),n.register("Vector4",i),e(Object,i,{isVector4:!0,dimension:4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceXYZW:function(t,i,n,e){var s=this.x-t,r=this.y-i,h=this.z-n,o=this.w-e;return Math.sqrt(s*s+r*r+h*h+o*o)},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},distanceSquaredXYZW:function(t,i,n,e){var s=this.x-t,r=this.y-i,h=this.z-n,o=this.w-e;return s*s+r*r+h*h+o*o},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},dotXYZW:function(t,i,n,e){return this.x*t+this.y*i+this.z*n+this.w*e},angleBetween:function(t){return Math.acos(n.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},copy:function(t){return t?t.set(this):new i(this.x,this.y,this.z,this.w)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new i(this.x/t,this.y/t,this.z/t,this.w/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new i(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusXYZW:function(t,n,e,s){return new i(this.x+t,this.y+n,this.z+e,this.w+s)},plusScalar:function(t){return new i(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusXYZW:function(t,n,e,s){return new i(this.x-t,this.y-n,this.z-e,this.w-s)},minusScalar:function(t){return new i(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new i(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new i(-this.x,-this.y,-this.z,-this.w)},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new n.Vector3(this.x,this.y,this.z)},setXYZW:function(t,i,n,e){return this.x=t,this.y=i,this.z=n,this.w=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},set:function(t){return this.setXYZW(t.x,t.y,t.z,t.w)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXYZW(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addXYZW:function(t,i,n,e){return this.setXYZW(this.x+t,this.y+i,this.z+n,this.w+e)},addScalar:function(t){return this.setXYZW(this.x+t,this.y+t,this.z+t,this.w+t)},subtract:function(t){return this.setXYZW(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subtractXYZW:function(t,i,n,e){return this.setXYZW(this.x-t,this.y-i,this.z-n,this.w-e)},subtractScalar:function(t){return this.setXYZW(this.x-t,this.y-t,this.z-t,this.w-t)},multiplyScalar:function(t){return this.setXYZW(this.x*t,this.y*t,this.z*t,this.w*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZW(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},divideScalar:function(t){return this.setXYZW(this.x/t,this.y/t,this.z/t,this.w/t)},negate:function(){return this.setXYZW(-this.x,-this.y,-this.z,-this.w)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)}}),s.mixin(i,{defaultFactory:function(){return new i},constructorDuplicateFactory:function(t){return function(n,e,s,r){return t.length?t.pop().setXY(n,e,s,r):new i(n,e,s,r)}}}),i.Immutable=function(t,i,n,e){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==n?n:0,this.w=void 0!==e?e:1};var r=i.Immutable;return e(i,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},r.mutableOverrideHelper("setXYZW"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("setZ"),r.mutableOverrideHelper("setW"),i.ZERO=new i(0,0,0,0),i.X_UNIT=new i(1,0,0,0),i.Y_UNIT=new i(0,1,0,0),i.Z_UNIT=new i(0,0,1,0),i.W_UNIT=new i(0,0,0,1),i}),n("DOT/Vector3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){"use strict";function i(t,i,n){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==n?n:0}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),n.register("Vector3",i),e(Object,i,{isVector3:!0,dimension:3,magnitude:function(){return Math.sqrt(this.magnitudeSquared());
},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXYZ:function(t,i,n){var e=this.x-t,s=this.y-i,r=this.z-n;return Math.sqrt(e*e+s*s+r*r)},distanceSquared:function(t){var i=this.x-t.x,n=this.y-t.y,e=this.z-t.z;return i*i+n*n+e*e},distanceSquaredXYZ:function(t,i,n){var e=this.x-t,s=this.y-i,r=this.z-n;return e*e+s*s+r*r},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},dotXYZ:function(t,i,n){return this.x*t+this.y*i+this.z*n},angleBetween:function(t){return Math.acos(n.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},copy:function(t){return t?t.set(this):new i(this.x,this.y,this.z)},cross:function(t){return new i(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new i(this.x/t,this.y/t,this.z/t)},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new i(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)},plusXYZ:function(t,n,e){return new i(this.x+t,this.y+n,this.z+e)},plusScalar:function(t){return new i(this.x+t,this.y+t,this.z+t)},minus:function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)},minusXYZ:function(t,n,e){return new i(this.x-t,this.y-n,this.z-e)},minusScalar:function(t){return new i(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new i(this.x/t,this.y/t,this.z/t)},negated:function(){return new i(-this.x,-this.y,-this.z)},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new n.Vector2(this.x,this.y)},toVector4:function(){return new n.Vector4(this.x,this.y,this.z,1)},setXYZ:function(t,i,n){return this.x=t,this.y=i,this.z=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},set:function(t){return this.setXYZ(t.x,t.y,t.z)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},addXYZ:function(t,i,n){return this.setXYZ(this.x+t,this.y+i,this.z+n)},addScalar:function(t){return this.setXYZ(this.x+t,this.y+t,this.z+t)},subtract:function(t){return this.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},subtractXYZ:function(t,i,n){return this.setXYZ(this.x-t,this.y-i,this.z-n)},subtractScalar:function(t){return this.setXYZ(this.x-t,this.y-t,this.z-t)},multiplyScalar:function(t){return this.setXYZ(this.x*t,this.y*t,this.z*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZ(this.x*t.x,this.y*t.y,this.z*t.z)},divideScalar:function(t){return this.setXYZ(this.x/t,this.y/t,this.z/t)},negate:function(){return this.setXYZ(-this.x,-this.y,-this.z)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)}},{slerp:function(t,i,e){return n.Quaternion.slerp(new n.Quaternion,n.Quaternion.getRotationQuaternion(t,i),e).timesVector3(t)}}),s.mixin(i,{defaultFactory:function(){return new i},constructorDuplicateFactory:function(t){return function(n,e,s){return t.length?t.pop().setXY(n,e,s):new i(n,e,s)}}}),i.Immutable=function(t,i,n){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==n?n:0};var r=i.Immutable;return e(i,r),r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},r.mutableOverrideHelper("setXYZ"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("setZ"),i.ZERO=new i(0,0,0),i.X_UNIT=new i(1,0,0),i.Y_UNIT=new i(0,1,0),i.Z_UNIT=new i(0,0,1),i}),n("DOT/Bounds3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Vector3"],function(t){"use strict";function i(t,i,n,e,s,r){this.minX=t,this.minY=i,this.minZ=n,this.maxX=e,this.maxY=s,this.maxZ=r}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("PHET_CORE/Poolable");return t("DOT/Vector3"),n.register("Bounds3",i),e(Object,i,{isBounds:!0,dimension:3,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getDepth:function(){return this.maxZ-this.minZ},get depth(){return this.getDepth()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getZ:function(){return this.minZ},get z(){return this.getZ()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMinZ:function(){return this.minZ},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getMaxZ:function(){return this.maxZ},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getBack:function(){return this.minZ},get back(){return this.minZ},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getFront:function(){return this.maxZ},get front(){return this.maxZ},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getCenterZ:function(){return(this.maxZ+this.minZ)/2},get centerZ(){return this.getCenterZ()},getCenter:function(){return new n.Vector3(this.getCenterX(),this.getCenterY(),this.getCenterZ())},get center(){return this.getCenter()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0||this.getDepth()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.minZ)&&isFinite(this.maxX)&&isFinite(this.maxY)&&isFinite(this.maxZ)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0&&this.getDepth()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i,n){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY&&this.minZ<=n&&n<=this.maxZ},containsPoint:function(t){return this.containsCoordinates(t.x,t.y,t.z)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY&&this.minZ<=t.minZ&&this.maxZ>=t.maxZ},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+"),z:("+this.minZ+","+this.maxZ+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.minZ===t.minZ&&this.maxX===t.maxX&&this.maxY===t.maxY&&this.maxZ===t.maxZ},equalsEpsilon:function(t,i){i=void 0!==i?i:0;var n=this.isFinite(),e=t.isFinite();return n&&e?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.minZ-t.minZ)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i&&Math.abs(this.maxZ-t.maxZ)<i:n!==e?!1:this===t?!0:(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.minZ+t.minZ)?Math.abs(this.minZ-t.minZ)<i:this.minZ===t.minZ)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)&&(isFinite(this.maxZ+t.maxZ)?Math.abs(this.maxZ-t.maxZ)<i:this.maxZ===t.maxZ)},copy:function(t){return t?t.set(this):new i(this.minX,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},union:function(t){return new i(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},intersection:function(t){return new i(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},withCoordinates:function(t,n,e){return new i(Math.min(this.minX,t),Math.min(this.minY,n),Math.min(this.minZ,e),Math.max(this.maxX,t),Math.max(this.maxY,n),Math.max(this.maxZ,e))},withPoint:function(t){return this.withCoordinates(t.x,t.y,t.z)},withMinX:function(t){return new i(t,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinY:function(t){return new i(this.minX,t,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinZ:function(t){return new i(this.minX,this.minY,t,this.maxX,this.maxY,this.maxZ)},withMaxX:function(t){return new i(this.minX,this.minY,this.minZ,t,this.maxY,this.maxZ)},withMaxY:function(t){return new i(this.minX,this.minY,this.minZ,this.maxX,t,this.maxZ)},withMaxZ:function(t){return new i(this.minX,this.minY,this.minZ,this.maxX,this.maxY,t)},roundedOut:function(){return new i(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundedIn:function(){return new i(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new i(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilatedX:function(t){return new i(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilatedY:function(t){return new i(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilatedZ:function(t){return new i(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilatedXYZ:function(t,n,e){return new i(this.minX-t,this.minY-n,this.minZ-e,this.maxX+t,this.maxY+n,this.maxZ+e)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedZ:function(t){return this.dilatedZ(-t)},erodedXYZ:function(t,i,n){return this.dilatedXYZ(-t,-i,-n)},shiftedX:function(t){return new i(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftedY:function(t){return new i(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftedZ:function(t){return new i(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shifted:function(t,n,e){return new i(this.minX+t,this.minY+n,this.minZ+e,this.maxX+t,this.maxY+n,this.maxZ+e)},setMinMax:function(t,i,n,e,s,r){return this.minX=t,this.minY=i,this.minZ=n,this.maxX=e,this.maxY=s,this.maxZ=r,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMinZ:function(t){return this.minZ=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},setMaxZ:function(t){return this.maxZ=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.minZ,t.maxX,t.maxY,t.maxZ)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},addCoordinates:function(t,i,n){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,n),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,n))},addPoint:function(t){return this.addCoordinates(t.x,t.y,t.z)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transform:function(t){function i(t){e=Math.min(e,t.x),s=Math.min(s,t.y),r=Math.min(r,t.z),h=Math.max(h,t.x),o=Math.max(o,t.y),a=Math.max(a,t.z)}if(this.isEmpty())return this;if(t.isIdentity())return this;var e=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,m=new n.Vector3;return i(t.multiplyVector3(m.setXYZ(this.minX,this.minY,this.minZ))),i(t.multiplyVector3(m.setXYZ(this.minX,this.maxY,this.minZ))),i(t.multiplyVector3(m.setXYZ(this.maxX,this.minY,this.minZ))),i(t.multiplyVector3(m.setXYZ(this.maxX,this.maxY,this.minZ))),i(t.multiplyVector3(m.setXYZ(this.minX,this.minY,this.maxZ))),i(t.multiplyVector3(m.setXYZ(this.minX,this.maxY,this.maxZ))),i(t.multiplyVector3(m.setXYZ(this.maxX,this.minY,this.maxZ))),i(t.multiplyVector3(m.setXYZ(this.maxX,this.maxY,this.maxZ))),this.setMinMax(e,s,r,h,o,a)},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilateZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilateXYZ:function(t,i,n){return this.setMinMax(this.minX-t,this.minY-i,this.minZ-n,this.maxX+t,this.maxY+i,this.maxZ+n)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeZ:function(t){return this.dilateZ(-t)},erodeXYZ:function(t,i,n){return this.dilateXYZ(-t,-i,-n)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shift:function(t,i,n){return this.setMinMax(this.minX+t,this.minY+i,this.minZ+n,this.maxX+t,this.maxY+i,this.maxZ+n)}},{cuboid:function(t,n,e,s,r,h){return new i(t,n,e,t+s,n+r,e+h)},point:function(t,n,e){return new i(t,n,e,t,n,e)}}),s.mixin(i,{defaultFactory:function(){return i.NOTHING.copy()},constructorDuplicateFactory:function(t){return function(n,e,s,r,h,o){return t.length?t.pop().setMinMax(n,e,s,r,h,o):new i(n,e,s,r,h,o)}}}),i.NOTHING=new i(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),i.EVERYTHING=new i(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i}),n("DOT/Complex",["require","DOT/dot","PHET_CORE/inherit","DOT/Vector2"],function(t){"use strict";function i(t,i){s.call(this,t,i),this.real=t,this.imaginary=i}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("DOT/Vector2");return n.register("Complex",i),e(s.Immutable,i,{phase:s.prototype.angle,times:function(t){return new i(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var n=t.magnitudeSquared();return new i((this.real*t.real+this.imaginary*t.imaginary)/n,(this.imaginary*t.real-this.real*t.imaginary)/n)},sqrt:function(){var t=this.magnitude();return new i(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},conjugate:function(){return new i(this.real,-this.imaginary)},exponentiated:function(){return i.createPolar(Math.exp(this.real),this.imaginary)},toString:function(){return"Complex("+this.x+", "+this.y+")"}},{real:function(t){return new i(t,0)},imaginary:function(t){return new i(0,t)},createPolar:function(t,n){return new i(t*Math.cos(n),t*Math.sin(n))}}),i.ZERO=new i(0,0),i.ONE=new i(1,0),i.I=new i(0,1),i}),n("DOT/ConvexHull2",["require","DOT/dot"],function(t){"use strict";function i(t,i,n){return i.minus(t).crossScalar(n.minus(t))}var n=t("DOT/dot"),e={grahamScan:function(t,n){if(t.length<=2)return t;var e=Number.POSITIVE_INFINITY,s=null;_.each(t,function(t){t.y<=e&&(t.y===e&&s?t.x<s.x&&(s=t):(e=t.y,s=t))}),t=_.sortBy(t,function(t){return t.minus(s).angle()}),t.splice(_.indexOf(t,s),1);var r=[s];return _.each(t,function(t){function e(){if(r.length<2)return!1;var e=i(r[r.length-2],r[r.length-1],t);return n?0>e:0>=e}if(s.x!==t.x||s.y!==t.y){for(;e();)r.pop();r.push(t)}}),r}};return n.register("ConvexHull2",e),e}),n("DOT/Dimension2",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){"use strict";function i(t,i){this.width=t,this.height=i}var n=t("DOT/dot"),e=t("PHET_CORE/inherit");return t("DOT/Bounds2"),n.register("Dimension2",i),e(Object,i,{toString:function(){return"["+this.width+"w, "+this.height+"h]"},set:function(t){return this.width=t.width,this.height=t.height,this},setWidth:function(t){return this.width=t,this},setHeight:function(t){return this.height=t,this},copy:function(t){return t?t.set(this):new i(this.width,this.height)},toBounds:function(t,i){return t=void 0!==t?t:0,i=void 0!==i?i:0,new n.Bounds2(t,i,this.width+t,this.height+i)},equals:function(t){return this.width===t.width&&this.height===t.height}}),i}),n("DOT/EigenvalueDecomposition",["require","DOT/dot"],function(t){"use strict";function i(t){var i,n,s=t.entries;this.n=t.getColumnDimension();var r=this.n;for(this.V=new e(r*r),this.d=new e(r),this.e=new e(r),this.issymmetric=!0,n=0;r>n&&this.issymmetric;n++)for(i=0;r>i&&this.issymmetric;i++)this.issymmetric=s[i*this.n+n]===s[n*this.n+i];if(this.issymmetric){for(i=0;r>i;i++)for(n=0;r>n;n++)this.V[i*this.n+n]=s[i*this.n+n];this.tred2(),this.tql2()}else{for(this.H=new e(r*r),this.ort=new e(r),n=0;r>n;n++)for(i=0;r>i;i++)this.H[i*this.n+n]=s[i*this.n+n];this.orthes(),this.hqr2()}}var n=t("DOT/dot"),e=window.Float32Array||Array;return n.register("EigenvalueDecomposition",i),i.prototype={constructor:i,getV:function(){return this.V.copy()},getRealEigenvalues:function(){return this.d},getImagEigenvalues:function(){return this.e},getD:function(){for(var t=this.n,i=this.d,e=this.e,s=new n.Matrix(t,t),r=s.entries,h=0;t>h;h++){for(var o=0;t>o;o++)r[h*this.n+o]=0;r[h*this.n+h]=i[h],e[h]>0?r[h*this.n+h+1]=e[h]:e[h]<0&&(r[h*this.n+h-1]=e[h])}return s},tred2:function(){var t,i,n,e,s,r,h=this.n,o=this.V,a=this.d,m=this.e;for(i=0;h>i;i++)a[i]=o[(h-1)*h+i];for(t=h-1;t>0;t--){var u=0;for(r=0,n=0;t>n;n++)u+=Math.abs(a[n]);if(0===u)for(m[t]=a[t-1],i=0;t>i;i++)a[i]=o[(t-1)*h+i],o[t*this.n+i]=0,o[i*this.n+t]=0;else{for(n=0;t>n;n++)a[n]/=u,r+=a[n]*a[n];for(e=a[t-1],s=Math.sqrt(r),e>0&&(s=-s),m[t]=u*s,r-=e*s,a[t-1]=e-s,i=0;t>i;i++)m[i]=0;for(i=0;t>i;i++){for(e=a[i],o[i*this.n+t]=e,s=m[i]+o[i*h+i]*e,n=i+1;t-1>=n;n++)s+=o[n*h+i]*a[n],m[n]+=o[n*h+i]*e;m[i]=s}for(e=0,i=0;t>i;i++)m[i]/=r,e+=m[i]*a[i];var c=e/(r+r);for(i=0;t>i;i++)m[i]-=c*a[i];for(i=0;t>i;i++){for(e=a[i],s=m[i],n=i;t-1>=n;n++)o[n*h+i]-=e*m[n]+s*a[n];a[i]=o[(t-1)*h+i],o[t*this.n+i]=0}}a[t]=r}for(t=0;h-1>t;t++){if(o[(h-1)*h+t]=o[t*h+t],o[t*h+t]=1,r=a[t+1],0!==r){for(n=0;t>=n;n++)a[n]=o[n*h+(t+1)]/r;for(i=0;t>=i;i++){for(s=0,n=0;t>=n;n++)s+=o[n*h+(t+1)]*o[n*h+i];for(n=0;t>=n;n++)o[n*h+i]-=s*a[n]}}for(n=0;t>=n;n++)o[n*h+(t+1)]=0}for(i=0;h>i;i++)a[i]=o[(h-1)*h+i],o[(h-1)*h+i]=0;o[(h-1)*h+(h-1)]=1,m[0]=0},tql2:function(){var t,i,e,s,r,h,o,a=this.n,m=this.V,u=this.d,c=this.e;for(t=1;a>t;t++)c[t-1]=c[t];c[a-1]=0;var f=0,d=0,l=Math.pow(2,-52);for(s=0;a>s;s++){d=Math.max(d,Math.abs(u[s])+Math.abs(c[s]));for(var x=s;a>x&&!(Math.abs(c[x])<=l*d);)x++;if(x>s){o=0;do{o+=1,r=u[s],h=(u[s+1]-r)/(2*c[s]);var v=n.Matrix.hypot(h,1);0>h&&(v=-v),u[s]=c[s]/(h+v),u[s+1]=c[s]*(h+v);var p=u[s+1],y=r-u[s];for(t=s+2;a>t;t++)u[t]-=y;f+=y,h=u[x];var g=1,w=g,T=g,M=c[s+1],E=0,O=0;for(t=x-1;t>=s;t--)for(T=w,w=g,O=E,r=g*c[t],y=g*h,v=n.Matrix.hypot(h,c[t]),c[t+1]=E*v,E=c[t]/v,g=h/v,h=g*u[t]-E*r,u[t+1]=y+E*(g*r+E*u[t]),e=0;a>e;e++)y=m[e*a+(t+1)],m[e*a+(t+1)]=E*m[e*a+t]+g*y,m[e*a+t]=g*m[e*a+t]-E*y;h=-E*O*T*M*c[s]/p,c[s]=E*h,u[s]=g*h}while(Math.abs(c[s])>l*d)}u[s]=u[s]+f,c[s]=0}for(t=0;a-1>t;t++){for(e=t,h=u[t],i=t+1;a>i;i++)u[i]<h&&(e=i,h=u[i]);if(e!==t)for(u[e]=u[t],u[t]=h,i=0;a>i;i++)h=m[i*this.n+t],m[i*this.n+t]=m[i*a+e],m[i*a+e]=h}},orthes:function(){var t,i,n,e,s,r=this.n,h=this.V,o=this.H,a=this.ort,m=0,u=r-1;for(n=m+1;u-1>=n;n++){var c=0;for(t=n;u>=t;t++)c+=Math.abs(o[t*r+(n-1)]);if(0!==c){var f=0;for(t=u;t>=n;t--)a[t]=o[t*r+(n-1)]/c,f+=a[t]*a[t];for(s=Math.sqrt(f),a[n]>0&&(s=-s),f-=a[n]*s,a[n]=a[n]-s,i=n;r>i;i++){for(e=0,t=u;t>=n;t--)e+=a[t]*o[t*this.n+i];for(e/=f,t=n;u>=t;t++)o[t*this.n+i]-=e*a[t]}for(t=0;u>=t;t++){for(e=0,i=u;i>=n;i--)e+=a[i]*o[t*this.n+i];for(e/=f,i=n;u>=i;i++)o[t*this.n+i]-=e*a[i]}a[n]=c*a[n],o[n*r+(n-1)]=c*s}}for(t=0;r>t;t++)for(i=0;r>i;i++)h[t*this.n+i]=t===i?1:0;for(n=u-1;n>=m+1;n--)if(0!==o[n*r+(n-1)]){for(t=n+1;u>=t;t++)a[t]=o[t*r+(n-1)];for(i=n;u>=i;i++){for(s=0,t=n;u>=t;t++)s+=a[t]*h[t*this.n+i];for(s=s/a[n]/o[n*r+(n-1)],t=n;u>=t;t++)h[t*this.n+i]+=s*a[t]}}},cdiv:function(t,i,n,e){var s,r;Math.abs(n)>Math.abs(e)?(s=e/n,r=n+s*e,this.cdivr=(t+s*i)/r,this.cdivi=(i-s*t)/r):(s=n/e,r=e+s*n,this.cdivr=(s*t+i)/r,this.cdivi=(s*i-t)/r)},hqr2:function(){var t,i,n,e,s,r,h,o=this.V,a=this.d,m=this.e,u=this.H,c=this.n;t=c-1;var f,d,l,x,v=0,p=c-1,y=Math.pow(2,-52),g=0,w=0,T=0,M=0,E=0,O=0,Y=0;for(i=0;c>i;i++)for((v>i||i>p)&&(a[i]=u[i*t+i],m[i]=0),n=Math.max(i-1,0);c>n;n++)Y+=Math.abs(u[i*this.n+n]);for(h=0;t>=v;){for(s=t;s>v&&(E=Math.abs(u[(s-1)*t+(s-1)])+Math.abs(u[s*t+s]),0===E&&(E=Y),!(Math.abs(u[s*t+(s-1)])<y*E));)s--;if(s===t)u[t*t+t]=u[t*t+t]+g,a[t]=u[t*t+t],m[t]=0,t--,h=0;else if(s===t-1){if(d=u[t*t+t-1]*u[(t-1)*t+t],w=(u[(t-1)*t+(t-1)]-u[t*t+t])/2,T=w*w+d,O=Math.sqrt(Math.abs(T)),u[t*t+t]=u[t*t+t]+g,u[(t-1)*t+(t-1)]=u[(t-1)*t+(t-1)]+g,l=u[t*t+t],T>=0){for(O=w>=0?w+O:w-O,a[t-1]=l+O,a[t]=a[t-1],0!==O&&(a[t]=l-d/O),m[t-1]=0,m[t]=0,l=u[t*t+t-1],E=Math.abs(l)+Math.abs(O),w=l/E,T=O/E,M=Math.sqrt(w*w+T*T),w/=M,T/=M,n=t-1;c>n;n++)O=u[(t-1)*t+n],u[(t-1)*t+n]=T*O+w*u[t*t+n],u[t*t+n]=T*u[t*t+n]-w*O;for(i=0;t>=i;i++)O=u[i*t+t-1],u[i*t+t-1]=T*O+w*u[i*t+t],u[i*t+t]=T*u[i*t+t]-w*O;for(i=v;p>=i;i++)O=o[i*t+t-1],o[i*t+t-1]=T*O+w*o[i*t+t],o[i*t+t]=T*o[i*t+t]-w*O}else a[t-1]=l+w,a[t]=l+w,m[t-1]=O,m[t]=-O;t-=2,h=0}else{if(l=u[t*t+t],x=0,d=0,t>s&&(x=u[(t-1)*t+(t-1)],d=u[t*t+t-1]*u[(t-1)*t+t]),10===h){for(g+=l,i=v;t>=i;i++)u[i*t+i]-=l;E=Math.abs(u[t*t+t-1])+Math.abs(u[(t-1)*t+t-2]),l=x=.75*E,d=-.4375*E*E}if(30===h&&(E=(x-l)/2,E=E*E+d,E>0)){for(E=Math.sqrt(E),l>x&&(E=-E),E=l-d/((x-l)/2+E),i=v;t>=i;i++)u[i*t+i]-=E;g+=E,l=x=d=.964}for(h+=1,r=t-2;r>=s&&(O=u[r*t+r],M=l-O,E=x-O,w=(M*E-d)/u[(r+1)*t+r]+u[r*t+r+1],T=u[(r+1)*t+r+1]-O-M-E,M=u[(r+2)*t+r+1],E=Math.abs(w)+Math.abs(T)+Math.abs(M),w/=E,T/=E,M/=E,r!==s)&&!(Math.abs(u[r*t+(r-1)])*(Math.abs(T)+Math.abs(M))<y*(Math.abs(w)*(Math.abs(u[(r-1)*t+r-1])+Math.abs(O)+Math.abs(u[(r+1)*t+r+1]))));)r--;for(i=r+2;t>=i;i++)u[i*t+i-2]=0,i>r+2&&(u[i*t+i-3]=0);for(e=r;t-1>=e;e++){var b=e!==t-1;if(e!==r&&(w=u[e*t+e-1],T=u[(e+1)*t+e-1],M=b?u[(e+2)*t+e-1]:0,l=Math.abs(w)+Math.abs(T)+Math.abs(M),0!==l&&(w/=l,T/=l,M/=l)),0===l)break;if(E=Math.sqrt(w*w+T*T+M*M),0>w&&(E=-E),0!==E){for(e!==r?u[e*t+e-1]=-E*l:s!==r&&(u[e*t+e-1]=-u[e*t+e-1]),w+=E,l=w/E,x=T/E,O=M/E,T/=w,M/=w,n=e;c>n;n++)w=u[e*t+n]+T*u[(e+1)*t+n],b&&(w+=M*u[(e+2)*t+n],u[(e+2)*t+n]=u[(e+2)*t+n]-w*O),u[e*t+n]=u[e*t+n]-w*l,u[(e+1)*t+n]=u[(e+1)*t+n]-w*x;for(i=0;i<=Math.min(t,e+3);i++)w=l*u[i*t+e]+x*u[i*t+e+1],b&&(w+=O*u[i*t+e+2],u[i*t+e+2]=u[i*t+e+2]-w*M),u[i*t+e]=u[i*t+e]-w,u[i*t+e+1]=u[i*t+e+1]-w*T;for(i=v;p>=i;i++)w=l*o[i*t+e]+x*o[i*t+e+1],b&&(w+=O*o[i*t+e+2],o[i*t+e+2]=o[i*t+e+2]-w*M),o[i*t+e]=o[i*t+e]-w,o[i*t+e+1]=o[i*t+e+1]-w*T}}}}if(0!==Y){for(t=c-1;t>=0;t--)if(w=a[t],T=m[t],0===T)for(s=t,u[t*t+t]=1,i=t-1;i>=0;i--){for(d=u[i*t+i]-w,M=0,n=s;t>=n;n++)M+=u[i*this.n+n]*u[n*t+t];if(m[i]<0)O=d,E=M;else if(s=i,0===m[i]?0!==d?u[i*t+t]=-M/d:u[i*t+t]=-M/(y*Y):(l=u[i*t+i+1],x=u[(i+1)*t+i],T=(a[i]-w)*(a[i]-w)+m[i]*m[i],f=(l*E-O*M)/T,u[i*t+t]=f,Math.abs(l)>Math.abs(O)?u[(i+1)*t+t]=(-M-d*f)/l:u[(i+1)*t+t]=(-E-x*f)/O),f=Math.abs(u[i*t+t]),y*f*f>1)for(n=i;t>=n;n++)u[n*t+t]=u[n*t+t]/f}else if(0>T)for(s=t-1,Math.abs(u[t*t+t-1])>Math.abs(u[(t-1)*t+t])?(u[(t-1)*t+(t-1)]=T/u[t*t+t-1],u[(t-1)*t+t]=-(u[t*t+t]-w)/u[t*t+t-1]):(this.cdiv(0,-u[(t-1)*t+t],u[(t-1)*t+(t-1)]-w,T),u[(t-1)*t+(t-1)]=this.cdivr,u[(t-1)*t+t]=this.cdivi),u[t*t+t-1]=0,u[t*t+t]=1,i=t-2;i>=0;i--){var X,I,D,N;for(X=0,I=0,n=s;t>=n;n++)X+=u[i*this.n+n]*u[n*t+t-1],I+=u[i*this.n+n]*u[n*t+t];if(d=u[i*t+i]-w,m[i]<0)O=d,M=X,E=I;else if(s=i,0===m[i]?(this.cdiv(-X,-I,d,T),u[i*t+t-1]=this.cdivr,u[i*t+t]=this.cdivi):(l=u[i*t+i+1],x=u[(i+1)*t+i],D=(a[i]-w)*(a[i]-w)+m[i]*m[i]-T*T,N=2*(a[i]-w)*T,0===D&&0===N&&(D=y*Y*(Math.abs(d)+Math.abs(T)+Math.abs(l)+Math.abs(x)+Math.abs(O))),this.cdiv(l*M-O*X+T*I,l*E-O*I-T*X,D,N),u[i*t+t-1]=this.cdivr,u[i*t+t]=this.cdivi,Math.abs(l)>Math.abs(O)+Math.abs(T)?(u[(i+1)*t+t-1]=(-X-d*u[i*t+t-1]+T*u[i*t+t])/l,u[(i+1)*t+t]=(-I-d*u[i*t+t]-T*u[i*t+t-1])/l):(this.cdiv(-M-x*u[i*t+t-1],-E-x*u[i*t+t],O,T),u[(i+1)*t+t-1]=this.cdivr,u[(i+1)*t+t]=this.cdivi)),f=Math.max(Math.abs(u[i*t+t-1]),Math.abs(u[i*t+t])),y*f*f>1)for(n=i;t>=n;n++)u[n*t+t-1]=u[n*t+t-1]/f,u[n*t+t]=u[n*t+t]/f}for(i=0;c>i;i++)if(v>i||i>p)for(n=i;c>n;n++)o[i*this.n+n]=u[i*this.n+n];for(n=c-1;n>=v;n--)for(i=v;p>=i;i++){for(O=0,e=v;e<=Math.min(n,p);e++)O+=o[i*t+e]*u[e*t+n];o[i*this.n+n]=O}}}},i}),n("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){"use strict";function i(t,i,e,s,r){r=_.isUndefined(r)?!1:r;var h=function(t,i,e,s,r,h){var o=n.Util.linear(t,i,e,s,r);if(h){var a=Math.max(e,s),m=Math.min(e,s);o=n.Util.clamp(o,m,a)}return o},o=function(n){return h(t,i,e,s,n,r)};return o.inverse=function(n){return h(e,s,t,i,n,r)},o}var n=t("DOT/dot");return t("DOT/Util"),n.register("LinearFunction",i),i}),n("DOT/LUDecomposition",["require","DOT/dot"],function(t){"use strict";function i(t){var i,n,s;this.matrix=t,this.LU=t.getArrayCopy();var r=this.LU;this.m=t.getRowDimension();var h=this.m;this.n=t.getColumnDimension();var o=this.n;for(this.piv=new Uint32Array(h),i=0;h>i;i++)this.piv[i]=i;this.pivsign=1;var a=new e(h);for(n=0;o>n;n++){for(i=0;h>i;i++)a[i]=r[t.index(i,n)];for(i=0;h>i;i++){var m=Math.min(i,n),u=0;for(s=0;m>s;s++){var c=t.index(i,s);u+=r[c]*a[s]}a[i]-=u,r[t.index(i,n)]=a[i]}var f=n;for(i=n+1;h>i;i++)Math.abs(a[i])>Math.abs(a[f])&&(f=i);if(f!==n){for(s=0;o>s;s++){var d=t.index(f,s),l=t.index(n,s),x=r[d];r[d]=r[l],r[l]=x}s=this.piv[f],this.piv[f]=this.piv[n],this.piv[n]=s,this.pivsign=-this.pivsign}if(h>n&&0!==r[this.matrix.index(n,n)])for(i=n+1;h>i;i++)r[t.index(i,n)]/=r[t.index(n,n)]}}var n=t("DOT/dot"),e=window.Float32Array||Array;return n.register("LUDecomposition",i),i.prototype={constructor:i,isNonsingular:function(){for(var t=0;t<this.n;t++){var i=this.matrix.index(t,t);if(0===this.LU[i])return!1}return!0},getL:function(){for(var t=new n.Matrix(this.m,this.n),i=0;i<this.m;i++)for(var e=0;e<this.n;e++)i>e?t.entries[t.index(i,e)]=this.LU[this.matrix.index(i,e)]:i===e?t.entries[t.index(i,e)]=1:t.entries[t.index(i,e)]=0;return t},getU:function(){for(var t=new n.Matrix(this.n,this.n),i=0;i<this.n;i++)for(var e=0;e<this.n;e++)e>=i?t.entries[t.index(i,e)]=this.LU[this.matrix.index(i,e)]:t.entries[t.index(i,e)]=0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},getDoublePivot:function(){for(var t=new e(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},det:function(){if(this.m!==this.n)throw new Error("Matrix must be square.");for(var t=this.pivsign,i=0;i<this.n;i++)t*=this.LU[this.matrix.index(i,i)];return t},solve:function(t){var i,n,e;if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw new Error("Matrix is singular.");var s=t.getColumnDimension(),r=t.getArrayRowMatrix(this.piv,0,s-1);for(e=0;e<this.n;e++)for(i=e+1;i<this.n;i++)for(n=0;s>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(e,n)]*this.LU[this.matrix.index(i,e)];for(e=this.n-1;e>=0;e--){for(n=0;s>n;n++)r.entries[r.index(e,n)]/=this.LU[this.matrix.index(e,e)];for(i=0;e>i;i++)for(n=0;s>n;n++)r.entries[r.index(i,n)]-=r.entries[r.index(e,n)]*this.LU[this.matrix.index(i,e)]}return r}},i}),n("PHET_CORE/isArray",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return"[object Array]"===Object.prototype.toString.call(t)}var n=t("PHET_CORE/phetCore");return n.register("isArray",i),i}),n("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){"use strict";function i(t){this.matrix=t;var i=t,s=i.getArrayCopy();this.m=i.getRowDimension(),this.n=i.getColumnDimension();var r=this.m,h=this.n,o=Math.min,a=Math.max,m=Math.pow,u=Math.abs,c=o(r,h);this.s=new e(o(r+1,h));var f=this.s;this.U=new e(r*c);var d=this.U;this.V=new e(h*h);var l,x,v,p,y,g,w,T=this.V,M=new e(h),E=new e(r),O=!0,Y=!0,b=n.Matrix.hypot,X=o(r-1,h),I=a(0,o(h-2,r));for(v=0;v<a(X,I);v++){if(X>v){for(f[v]=0,l=v;r>l;l++)f[v]=b(f[v],s[l*h+v]);if(0!==f[v]){for(s[v*h+v]<0&&(f[v]=-f[v]),l=v;r>l;l++)s[l*h+v]/=f[v];s[v*h+v]+=1}f[v]=-f[v]}for(x=v+1;h>x;x++){if(X>v&&0!==f[v]){for(p=0,l=v;r>l;l++)p+=s[l*h+v]*s[l*h+x];for(p=-p/s[v*h+v],l=v;r>l;l++)s[l*h+x]+=p*s[l*h+v]}M[x]=s[v*h+x]}if(O&&X>v)for(l=v;r>l;l++)d[l*c+v]=s[l*h+v];if(I>v){for(M[v]=0,l=v+1;h>l;l++)M[v]=b(M[v],M[l]);if(0!==M[v]){for(M[v+1]<0&&(M[v]=-M[v]),l=v+1;h>l;l++)M[l]/=M[v];M[v+1]+=1}if(M[v]=-M[v],r>v+1&&0!==M[v]){for(l=v+1;r>l;l++)E[l]=0;for(x=v+1;h>x;x++)for(l=v+1;r>l;l++)E[l]+=M[x]*s[l*h+x];for(x=v+1;h>x;x++)for(p=-M[x]/M[v+1],l=v+1;r>l;l++)s[l*h+x]+=p*E[l]}if(Y)for(l=v+1;h>l;l++)T[l*h+v]=M[l]}}var D=o(h,r+1);if(h>X&&(f[X]=s[X*h+X]),D>r&&(f[D-1]=0),D>I+1&&(M[I]=s[I*h+D-1]),M[D-1]=0,O){for(x=X;c>x;x++){for(l=0;r>l;l++)d[l*c+x]=0;d[x*c+x]=1}for(v=X-1;v>=0;v--)if(0!==f[v]){for(x=v+1;c>x;x++){for(p=0,l=v;r>l;l++)p+=d[l*c+v]*d[l*c+x];for(p=-p/d[v*c+v],l=v;r>l;l++)d[l*c+x]+=p*d[l*c+v]}for(l=v;r>l;l++)d[l*c+v]=-d[l*c+v];for(d[v*c+v]=1+d[v*c+v],l=0;v-1>l;l++)d[l*c+v]=0}else{for(l=0;r>l;l++)d[l*c+v]=0;d[v*c+v]=1}}if(Y)for(v=h-1;v>=0;v--){if(I>v&&0!==M[v])for(x=v+1;c>x;x++){for(p=0,l=v+1;h>l;l++)p+=T[l*h+v]*T[l*h+x];for(p=-p/T[(v+1)*h+v],l=v+1;h>l;l++)T[l*h+x]+=p*T[l*h+v]}for(l=0;h>l;l++)T[l*h+v]=0;T[v*h+v]=1}for(var N=D-1,P=0,R=m(2,-52),C=m(2,-966);D>0;){var A;if(P>500)break;for(v=D-2;v>=-1&&-1!==v;v--)if(u(M[v])<=C+R*(u(f[v])+u(f[v+1]))){M[v]=0;break}if(v===D-2)A=4;else{var _;for(_=D-1;_>=v&&_!==v;_--)if(p=(_!==D?u(M[_]):0)+(_!==v+1?u(M[_-1]):0),u(f[_])<=C+R*p){f[_]=0;break}_===v?A=3:_===D-1?A=1:(A=2,v=_)}switch(v++,A){case 1:for(y=M[D-2],M[D-2]=0,x=D-2;x>=v;x--)if(p=b(f[x],y),g=f[x]/p,w=y/p,f[x]=p,x!==v&&(y=-w*M[x-1],M[x-1]=g*M[x-1]),Y)for(l=0;h>l;l++)p=g*T[l*h+x]+w*T[l*h+D-1],T[l*h+D-1]=-w*T[l*h+x]+g*T[l*h+D-1],T[l*h+x]=p;break;case 2:for(y=M[v-1],M[v-1]=0,x=v;D>x;x++)if(p=b(f[x],y),g=f[x]/p,w=y/p,f[x]=p,y=-w*M[x],M[x]=g*M[x],O)for(l=0;r>l;l++)p=g*d[l*c+x]+w*d[l*c+v-1],d[l*c+v-1]=-w*d[l*c+x]+g*d[l*c+v-1],d[l*c+x]=p;break;case 3:var V=a(a(a(a(u(f[D-1]),u(f[D-2])),u(M[D-2])),u(f[v])),u(M[v])),z=f[D-1]/V,F=f[D-2]/V,S=M[D-2]/V,Z=f[v]/V,H=M[v]/V,j=((F+z)*(F-z)+S*S)/2,q=z*S*(z*S),L=0;(0!==j||0!==q)&&(L=Math.sqrt(j*j+q),0>j&&(L=-L),L=q/(j+L)),y=(Z+z)*(Z-z)+L;var k=Z*H;for(x=v;D-1>x;x++){if(p=b(y,k),g=y/p,w=k/p,x!==v&&(M[x-1]=p),y=g*f[x]+w*M[x],M[x]=g*M[x]-w*f[x],k=w*f[x+1],f[x+1]=g*f[x+1],Y)for(l=0;h>l;l++)p=g*T[l*h+x]+w*T[l*h+x+1],T[l*h+x+1]=-w*T[l*h+x]+g*T[l*h+x+1],T[l*h+x]=p;if(p=b(y,k),g=y/p,w=k/p,f[x]=p,y=g*M[x]+w*f[x+1],f[x+1]=-w*M[x]+g*f[x+1],k=w*M[x+1],M[x+1]=g*M[x+1],O&&r-1>x)for(l=0;r>l;l++)p=g*d[l*c+x]+w*d[l*c+x+1],d[l*c+x+1]=-w*d[l*c+x]+g*d[l*c+x+1],d[l*c+x]=p}M[D-2]=y,P+=1;break;case 4:if(f[v]<=0&&(f[v]=f[v]<0?-f[v]:0,
Y))for(l=0;N>=l;l++)T[l*h+v]=-T[l*h+v];for(;N>v&&!(f[v]>=f[v+1]);){if(p=f[v],f[v]=f[v+1],f[v+1]=p,Y&&h-1>v)for(l=0;h>l;l++)p=T[l*h+v+1],T[l*h+v+1]=T[l*h+v],T[l*h+v]=p;if(O&&r-1>v)for(l=0;r>l;l++)p=d[l*c+v+1],d[l*c+v+1]=d[l*c+v],d[l*c+v]=p;v++}P=0,D--}}}var n=t("DOT/dot"),e=window.Float32Array||Array;return n.register("SingularValueDecomposition",i),i.prototype={constructor:i,getU:function(){return new n.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new n.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new n.Matrix(this.n,this.n),i=0;i<this.n;i++){for(var e=0;e<this.n;e++)t.entries[t.index(i,e)]=0;t.entries[t.index(i,i)]=this.s[i]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),i=Math.max(this.m,this.n)*this.s[0]*t,n=0,e=0;e<this.s.length;e++)this.s[e]>i&&n++;return n}},i}),n("DOT/QRDecomposition",["require","DOT/dot"],function(t){"use strict";var i=t("DOT/dot"),n=window.Float32Array||Array;i.QRDecomposition=function(t){this.matrix=t,this.QR=t.getArrayCopy();var e=this.QR;this.m=t.getRowDimension();var s=this.m;this.n=t.getColumnDimension();var r=this.n;this.Rdiag=new n(r);var h,o,a;for(a=0;r>a;a++){var m=0;for(h=a;s>h;h++)m=i.Matrix.hypot(m,e[this.matrix.index(h,a)]);if(0!==m){for(e[this.matrix.index(a,a)]<0&&(m=-m),h=a;s>h;h++)e[this.matrix.index(h,a)]/=m;for(e[this.matrix.index(a,a)]+=1,o=a+1;r>o;o++){var u=0;for(h=a;s>h;h++)u+=e[this.matrix.index(h,a)]*e[this.matrix.index(h,o)];for(u=-u/e[this.matrix.index(a,a)],h=a;s>h;h++)e[this.matrix.index(h,o)]+=u*e[this.matrix.index(h,a)]}}this.Rdiag[a]=-m}};var e=i.QRDecomposition;return e.prototype={constructor:e,isFullRank:function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new i.Matrix(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++)n>=e?t.entries[t.index(n,e)]=this.QR[this.matrix.index(n,e)]:t.entries[t.index(n,e)]=0;return t},getR:function(){for(var t=new i.Matrix(this.n,this.n),n=0;n<this.n;n++)for(var e=0;e<this.n;e++)e>n?t.entries[t.index(n,e)]=this.QR[this.matrix.index(n,e)]:n===e?t.entries[t.index(n,e)]=this.Rdiag[n]:t.entries[t.index(n,e)]=0;return t},getQ:function(){var t,n,e,s=new i.Matrix(this.m,this.n);for(e=this.n-1;e>=0;e--){for(t=0;t<this.m;t++)s.entries[s.index(t,e)]=0;for(s.entries[s.index(e,e)]=1,n=e;n<this.n;n++)if(0!==this.QR[this.matrix.index(e,e)]){var r=0;for(t=e;t<this.m;t++)r+=this.QR[this.matrix.index(t,e)]*s.entries[s.index(t,n)];for(r=-r/this.QR[this.matrix.index(e,e)],t=e;t<this.m;t++)s.entries[s.index(t,n)]+=r*this.QR[this.matrix.index(t,e)]}}return s},solve:function(t){if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw new Error("Matrix is rank deficient.");var n,e,s,r=t.getColumnDimension(),h=t.getArrayCopy();for(s=0;s<this.n;s++)for(e=0;r>e;e++){var o=0;for(n=s;n<this.m;n++)o+=this.QR[this.matrix.index(n,s)]*h[t.index(n,e)];for(o=-o/this.QR[this.matrix.index(s,s)],n=s;n<this.m;n++)h[t.index(n,e)]+=o*this.QR[this.matrix.index(n,s)]}for(s=this.n-1;s>=0;s--){for(e=0;r>e;e++)h[t.index(s,e)]/=this.Rdiag[s];for(n=0;s>n;n++)for(e=0;r>e;e++)h[t.index(n,e)]-=h[t.index(s,e)]*this.QR[this.matrix.index(n,s)]}return new i.Matrix(this.n,r,h,!0).getMatrix(0,this.n-1,0,r-1)}},e}),n("DOT/Matrix",["require","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/EigenvalueDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){"use strict";function i(t,i,n,r){this.m=t,this.n=i;var h=t*i;this.size=h;var o;if(r)this.entries=n;else if(n||(n=0),this.entries=new e(h),s(n))for(o=0;h>o;o++)this.entries[o]=n[o];else for(o=0;h>o;o++)this.entries[o]=n}var n=t("DOT/dot"),e=window.Float32Array||Array,s=t("PHET_CORE/isArray");return t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/EigenvalueDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),n.register("Matrix",i),i.hypot=function(t,i){var n;return Math.abs(t)>Math.abs(i)?(n=i/t,n=Math.abs(t)*Math.sqrt(1+n*n)):0!==i?(n=t/i,n=Math.abs(i)*Math.sqrt(1+n*n)):n=0,n},i.prototype={constructor:i,copy:function(){for(var t=new i(this.m,this.n),n=0;n<this.size;n++)t.entries[n]=this.entries[n];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new e(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,i){return t*this.n+i},get:function(t,i){return this.entries[this.index(t,i)]},set:function(t,i,n){this.entries[this.index(t,i)]=n},getMatrix:function(t,n,e,s){for(var r=new i(n-t+1,s-e+1),h=t;n>=h;h++)for(var o=e;s>=o;o++)r.entries[r.index(h-t,o-e)]=this.entries[this.index(h,o)];return r},getArrayRowMatrix:function(t,n,e){for(var s=new i(t.length,e-n+1),r=0;r<t.length;r++)for(var h=n;e>=h;h++)s.entries[s.index(r,h-n)]=this.entries[this.index(t[r],h)];return s},transpose:function(t){t=t||new i(this.n,this.m);for(var n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t.entries[t.index(e,n)]=this.entries[this.index(n,e)];return t},norm1:function(){for(var t=0,i=0;i<this.n;i++){for(var n=0,e=0;e<this.m;e++)n+=Math.abs(this.entries[this.index(e,i)]);t=Math.max(t,n)}return t},norm2:function(){return new n.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,i=0;i<this.m;i++){for(var n=0,e=0;e<this.n;e++)n+=Math.abs(this.entries[this.index(i,e)]);t=Math.max(t,n)}return t},normF:function(){for(var t=0,n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t=i.hypot(t,this.entries[this.index(n,e)]);return t},uminus:function(){for(var t=new i(this.m,this.n),n=0;n<this.m;n++)for(var e=0;e<this.n;e++)t.entries[t.index(n,e)]=-this.entries[this.index(n,e)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var n=new i(this.m,this.n),e=0;e<this.m;e++)for(var s=0;s<this.n;s++){var r=n.index(e,s);n.entries[r]=this.entries[r]+t.entries[r]}return n},plusEquals:function(t){this.checkMatrixDimensions(t);for(var n=new i(this.m,this.n),e=0;e<this.m;e++)for(var s=0;s<this.n;s++){var r=n.index(e,s);this.entries[r]=this.entries[r]+t.entries[r]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var n=new i(this.m,this.n),e=0;e<this.m;e++)for(var s=0;s<this.n;s++){var r=this.index(e,s);n.entries[r]=this.entries[r]-t.entries[r]}return n},minusEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]-t.entries[e]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var n=new i(this.m,this.n),e=0;e<this.m;e++)for(var s=0;s<this.n;s++){var r=n.index(e,s);n.entries[r]=this.entries[r]*t.entries[r]}return n},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]*t.entries[e]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var n=new i(this.m,this.n),e=0;e<this.m;e++)for(var s=0;s<this.n;s++){var r=this.index(e,s);n.entries[r]=this.entries[r]/t.entries[r]}return n},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=this.entries[e]/t.entries[e]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var n=new i(this.m,this.n),e=0;e<this.m;e++)for(var s=0;s<this.n;s++){var r=this.index(e,s);n.entries[r]=t.entries[r]/this.entries[r]}return n},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=t.entries[e]/this.entries[e]}return this},times:function(t){var n,s,r,h,o,a;if(t.isMatrix){if(a=t,a.m!==this.n)throw new Error("Matrix inner dimensions must agree.");n=new i(this.m,a.n);var m=new e(this.n);for(r=0;r<a.n;r++){for(h=0;h<this.n;h++)m[h]=a.entries[a.index(h,r)];for(s=0;s<this.m;s++){for(o=0,h=0;h<this.n;h++)o+=this.entries[this.index(s,h)]*m[h];n.entries[n.index(s,r)]=o}}return n}for(o=t,n=new i(this.m,this.n),s=0;s<this.m;s++)for(r=0;r<this.n;r++)n.entries[n.index(s,r)]=o*this.entries[this.index(s,r)];return n},timesEquals:function(t){for(var i=0;i<this.m;i++)for(var n=0;n<this.n;n++){var e=this.index(i,n);this.entries[e]=t*this.entries[e]}return this},solve:function(t){return this.m===this.n?new n.LUDecomposition(this).solve(t):new n.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(i.identity(this.m,this.m))},det:function(){return new n.LUDecomposition(this).det()},rank:function(){return new n.SingularValueDecomposition(this).rank()},cond:function(){return new n.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,i=0;i<Math.min(this.m,this.n);i++)t+=this.entries[this.index(i,i)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw new Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var i=0;i<this.getRowDimension();i++){for(var n=0;n<this.getColumnDimension();n++)t+=this.get(i,n)+" ";t+="\n"}return t},extractVector2:function(t){return new n.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return new n.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return new n.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},setVectors3:function(t){for(var i=t.length,n=0;i>n;n++){var e=t[n];this.entries[n]=e.x,this.entries[n+i]=e.y,this.entries[n+2*i]=e.z}return this},isMatrix:!0},i.identity=function(t,n){for(var e=new i(t,n),s=0;t>s;s++)for(var r=0;n>r;r++)e.entries[e.index(s,r)]=s===r?1:0;return e},i.rowVector2=function(t){return new i(1,2,[t.x,t.y])},i.rowVector3=function(t){return new i(1,3,[t.x,t.y,t.z])},i.rowVector4=function(t){return new i(1,4,[t.x,t.y,t.z,t.w])},i.rowVector=function(t){if(t.isVector2)return i.rowVector2(t);if(t.isVector3)return i.rowVector3(t);if(t.isVector4)return i.rowVector4(t);throw new Error("undetected type of vector: "+t.toString())},i.columnVector2=function(t){return new i(2,1,[t.x,t.y])},i.columnVector3=function(t){return new i(3,1,[t.x,t.y,t.z])},i.columnVector4=function(t){return new i(4,1,[t.x,t.y,t.z,t.w])},i.columnVector=function(t){if(t.isVector2)return i.columnVector2(t);if(t.isVector3)return i.columnVector3(t);if(t.isVector4)return i.columnVector4(t);throw new Error("undetected type of vector: "+t.toString())},i.fromVectors2=function(t){for(var n=2,s=t.length,r=new e(n*s),h=0;s>h;h++){var o=t[h];r[h]=o.x,r[h+s]=o.y}return new i(n,s,r,!0)},i.fromVectors3=function(t){for(var n=3,s=t.length,r=new e(n*s),h=0;s>h;h++){var o=t[h];r[h]=o.x,r[h+s]=o.y,r[h+2*s]=o.z}return new i(n,s,r,!0)},i.fromVectors4=function(t){for(var n=4,s=t.length,r=new e(n*s),h=0;s>h;h++){var o=t[h];r[h]=o.x,r[h+s]=o.y,r[h+2*s]=o.z,r[h+3*s]=o.w}return new i(n,s,r,!0)},i}),n("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){"use strict";function i(t,i,n,s,r,h,o,a,m,u,c,f,d,l,x,v,p){this.entries=new e(16),this.rowMajor(void 0!==t?t:1,void 0!==i?i:0,void 0!==n?n:0,void 0!==s?s:0,void 0!==r?r:0,void 0!==h?h:1,void 0!==o?o:0,void 0!==a?a:0,void 0!==m?m:0,void 0!==u?u:0,void 0!==c?c:1,void 0!==f?f:0,void 0!==d?d:0,void 0!==l?l:0,void 0!==x?x:0,void 0!==v?v:1,p)}var n=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var e=window.Float32Array||Array;n.register("Matrix4",i),i.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3,AFFINE:4};var s=i.Types;return i.identity=function(){return new i(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,s.IDENTITY)},i.translation=function(t,n,e){return new i(1,0,0,t,0,1,0,n,0,0,1,e,0,0,0,1,s.TRANSLATION_3D)},i.translationFromVector=function(t){return i.translation(t.x,t.y,t.z)},i.scaling=function(t,n,e){return n=void 0===n?t:n,e=void 0===e?t:e,new i(t,0,0,0,0,n,0,0,0,0,e,0,0,0,0,1,s.SCALING)},i.rotationAxisAngle=function(t,n){var e=Math.cos(n),r=Math.sin(n),h=1-e;return new i(t.x*t.x*h+e,t.x*t.y*h-t.z*r,t.x*t.z*h+t.y*r,0,t.y*t.x*h+t.z*r,t.y*t.y*h+e,t.y*t.z*h-t.x*r,0,t.z*t.x*h-t.y*r,t.z*t.y*h+t.x*r,t.z*t.z*h+e,0,0,0,0,1,s.AFFINE)},i.rotationX=function(t){var n=Math.cos(t),e=Math.sin(t);return new i(1,0,0,0,0,n,-e,0,0,e,n,0,0,0,0,1,s.AFFINE)},i.rotationY=function(t){var n=Math.cos(t),e=Math.sin(t);return new i(n,0,e,0,0,1,0,0,-e,0,n,0,0,0,0,1,s.AFFINE)},i.rotationZ=function(t){var n=Math.cos(t),e=Math.sin(t);return new i(n,-e,0,0,e,n,0,0,0,0,1,0,0,0,0,1,s.AFFINE)},i.gluPerspective=function(t,n,e,s){var r=Math.cos(t)/Math.sin(t);return new i(r/n,0,0,0,0,r,0,0,0,0,(s+e)/(e-s),2*s*e/(e-s),0,0,-1,0)},i.prototype={constructor:i,rowMajor:function(t,i,n,e,r,h,o,a,m,u,c,f,d,l,x,v,p){return this.entries[0]=t,this.entries[1]=r,this.entries[2]=m,this.entries[3]=d,this.entries[4]=i,this.entries[5]=h,this.entries[6]=u,this.entries[7]=l,this.entries[8]=n,this.entries[9]=o,this.entries[10]=c,this.entries[11]=x,this.entries[12]=e,this.entries[13]=a,this.entries[14]=f,this.entries[15]=v,this.type=void 0===p?0===d&&0===l&&0===x&&1===v?s.AFFINE:s.OTHER:p,this},columnMajor:function(t,i,n,e,s,r,h,o,a,m,u,c,f,d,l,x,v){return this.rowMajor(t,s,a,f,i,r,m,d,n,h,u,l,e,o,c,x,v)},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m03(),t.m10(),t.m11(),t.m12(),t.m13(),t.m20(),t.m21(),t.m22(),t.m23(),t.m30(),t.m31(),t.m32(),t.m33(),t.type)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m03())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m13())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())&&isFinite(this.m23())&&isFinite(this.m30())&&isFinite(this.m31())&&isFinite(this.m32())&&isFinite(this.m33())},getTranslation:function(){return new n.Vector3(this.m03(),this.m13(),this.m23())},get translation(){return this.getTranslation()},getScaleVector:function(){var t=this.m00()+this.m03(),i=this.m10()+this.m13(),e=this.m20()+this.m23(),s=this.m30()+this.m33(),r=this.m01()+this.m03(),h=this.m11()+this.m13(),o=this.m21()+this.m23(),a=this.m31()+this.m33(),m=this.m02()+this.m03(),u=this.m12()+this.m13(),c=this.m22()+this.m23(),f=this.m32()+this.m33();return new n.Vector3(Math.sqrt(t*t+i*i+e*e+s*s),Math.sqrt(r*r+h*h+o*o+a*a),Math.sqrt(m*m+u*u+c*c+f*f))},get scaleVector(){return this.getScaleVector()},getCSSTransform:function(){return"matrix3d("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[2].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[5].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+","+this.entries[8].toFixed(20)+","+this.entries[9].toFixed(20)+","+this.entries[10].toFixed(20)+","+this.entries[11].toFixed(20)+","+this.entries[12].toFixed(20)+","+this.entries[13].toFixed(20)+","+this.entries[14].toFixed(20)+","+this.entries[15].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m03()===t.m03()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m13()===t.m13()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()&&this.m23()===t.m23()&&this.m30()===t.m30()&&this.m31()===t.m31()&&this.m32()===t.m32()&&this.m33()===t.m33()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m03()-t.m03())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m13()-t.m13())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i&&Math.abs(this.m23()-t.m23())<i&&Math.abs(this.m30()-t.m30())<i&&Math.abs(this.m31()-t.m31())<i&&Math.abs(this.m32()-t.m32())<i&&Math.abs(this.m33()-t.m33())<i},copy:function(){return new i(this.m00(),this.m01(),this.m02(),this.m03(),this.m10(),this.m11(),this.m12(),this.m13(),this.m20(),this.m21(),this.m22(),this.m23(),this.m30(),this.m31(),this.m32(),this.m33(),this.type)},plus:function(t){return new i(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new i(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new i(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new i(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){switch(this.type){case s.IDENTITY:return this;case s.TRANSLATION_3D:return new i(1,0,0,-this.m03(),0,1,0,-this.m13(),0,0,1,-this.m23(),0,0,0,1,s.TRANSLATION_3D);case s.SCALING:return new i(1/this.m00(),0,0,0,0,1/this.m11(),0,0,0,0,1/this.m22(),0,0,0,0,1/this.m33(),s.SCALING);case s.AFFINE:case s.OTHER:var t=this.getDeterminant();if(0!==t)return new i((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===s.IDENTITY||t.type===s.IDENTITY)return this.type===s.IDENTITY?t:this;if(this.type===t.type){if(this.type===s.TRANSLATION_3D)return new i(1,0,0,this.m03()+t.m02(),0,1,0,this.m13()+t.m12(),0,0,1,this.m23()+t.m23(),0,0,0,1,s.TRANSLATION_3D);if(this.type===s.SCALING)return new i(this.m00()*t.m00(),0,0,0,0,this.m11()*t.m11(),0,0,0,0,this.m22()*t.m22(),0,0,0,0,1,s.SCALING)}return this.type!==s.OTHER&&t.type!==s.OTHER?new i(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23(),0,0,0,1,s.AFFINE):new i(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33())},timesVector4:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,e=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,r=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new n.Vector4(i,e,s,r)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var i=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,e=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,s=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,r=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new n.Vector4(i,e,s,r)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var i=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,e=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,s=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new n.Vector3(i,e,s)},getDeterminant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},get determinant(){return this.getDeterminant()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},i.IDENTITY=new i,i.IDENTITY.makeImmutable(),i}),n("DOT/Matrix3",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){"use strict";function i(t){this.entries=h(),this.type=o.IDENTITY}var n=t("DOT/dot"),e=t("PHET_CORE/Poolable"),s=n.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4");var r=new s(9);r[0]=1,r[4]=1,r[8]=1;var h=s===Array?function(){return[1,0,0,0,1,0,0,0,1]}:function(){return new s(r)};n.register("Matrix3",i),i.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var o=i.Types;return i.identity=function(){return i.dirtyFromPool().setToIdentity()},i.translation=function(t,n){return i.dirtyFromPool().setToTranslation(t,n)},i.translationFromVector=function(t){return i.translation(t.x,t.y)},i.scaling=function(t,n){return i.dirtyFromPool().setToScale(t,n)},i.scale=i.scaling,i.affine=function(t,n,e,s,r,h){return i.dirtyFromPool().setToAffine(t,e,r,n,s,h)},i.rowMajor=function(t,n,e,s,r,h,o,a,m,u){return i.dirtyFromPool().rowMajor(t,n,e,s,r,h,o,a,m,u)},i.rotationAxisAngle=function(t,n){return i.dirtyFromPool().setToRotationAxisAngle(t,n)},i.rotationX=function(t){return i.dirtyFromPool().setToRotationX(t)},i.rotationY=function(t){return i.dirtyFromPool().setToRotationY(t)},i.rotationZ=function(t){return i.dirtyFromPool().setToRotationZ(t)},i.rotation2=i.rotationZ,i.rotationAround=function(t,n,e){return i.translation(n,e).timesMatrix(i.rotation2(t)).timesMatrix(i.translation(-n,-e))},i.rotationAroundPoint=function(t,n){return i.rotationAround(t,n.x,n.y)},i.fromSVGMatrix=function(t){return i.dirtyFromPool().setToSVGMatrix(t)},i.rotateAToB=function(t,n){return i.dirtyFromPool().setRotationAToB(t,n)},i.prototype={constructor:i,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isIdentity:function(){return this.type===o.IDENTITY||this.equals(i.IDENTITY)},isFastIdentity:function(){return this.type===o.IDENTITY},isAffine:function(){return this.type===o.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isAligned:function(){return this.isAffine()&&0===this.m01()&&0===this.m10()},isAxisAligned:function(){return this.isAffine()&&(0===this.m01()&&0===this.m10()||0===this.m00()&&0===this.m11())},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new n.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new n.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){return Math.atan2(this.m10(),this.m00())},get rotation(){return this.getRotation()},toMatrix4:function(){return new n.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toAffineMatrix4:function(){return new n.Matrix4(this.m00(),this.m01(),0,this.m02(),this.m10(),this.m11(),0,this.m12(),0,0,1,0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case o.IDENTITY:return"";case o.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+t(this.entries[7])+")";case o.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles();
},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i},copy:function(){return i.createFromPool(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return i.createFromPool(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return i.createFromPool(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return i.createFromPool(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negated:function(){return i.createFromPool(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return i.createFromPool(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return i.createFromPool(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(t=this.getDeterminant(),0!==t)return i.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(t=this.getDeterminant(),0!==t)return i.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===o.IDENTITY||t.type===o.IDENTITY)return this.type===o.IDENTITY?t:this;if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return i.createFromPool(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return i.createFromPool(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?i.createFromPool(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):i.createFromPool(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02(),e=this.m10()*t.x+this.m11()*t.y+this.m12();return new n.Vector2(i,e)},timesVector3:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,e=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,s=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new n.Vector3(i,e,s)},timesTransposeVector2:function(t){var i=this.m00()*t.x+this.m10()*t.y,e=this.m01()*t.x+this.m11()*t.y;return new n.Vector2(i,e)},timesRelativeVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y,e=this.m10()*t.y+this.m11()*t.y;return new n.Vector2(i,e)},rowMajor:function(t,i,n,e,s,r,h,a,m,u){return this.entries[0]=t,this.entries[1]=e,this.entries[2]=h,this.entries[3]=i,this.entries[4]=s,this.entries[5]=a,this.entries[6]=n,this.entries[7]=r,this.entries[8]=m,this.type=void 0===u?0===h&&0===a&&1===m?o.AFFINE:o.OTHER:u,this},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m10(),t.m11(),t.m12(),t.m20(),t.m21(),t.m22(),t.type)},setArray:function(t){return this.rowMajor(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])},set00:function(t){return this.entries[0]=t,this},set01:function(t){return this.entries[3]=t,this},set02:function(t){return this.entries[6]=t,this},set10:function(t){return this.entries[1]=t,this},set11:function(t){return this.entries[4]=t,this},set12:function(t){return this.entries[7]=t,this},set20:function(t){return this.entries[2]=t,this},set21:function(t){return this.entries[5]=t,this},set22:function(t){return this.entries[8]=t,this},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},columnMajor:function(t,i,n,e,s,r,h,o,a,m){return this.rowMajor(t,e,h,i,s,o,n,r,a,m)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(t.type===o.IDENTITY)return this;if(this.type===o.IDENTITY)return this.set(t);if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},prependTranslation:function(t,i){return this.set02(this.m02()+t),this.set12(this.m12()+i),this.type===o.IDENTITY||this.type===o.TRANSLATION_2D?this.type=o.TRANSLATION_2D:this.type===o.OTHER?this.type=o.OTHER:this.type=o.AFFINE,this},setToIdentity:function(){return this.rowMajor(1,0,0,0,1,0,0,0,1,o.IDENTITY)},setToTranslation:function(t,i){return this.rowMajor(1,0,t,0,1,i,0,0,1,o.TRANSLATION_2D)},setToScale:function(t,i){return i=void 0===i?t:i,this.rowMajor(t,0,0,0,i,0,0,0,1,o.SCALING)},setToAffine:function(t,i,n,e,s,r){return this.rowMajor(t,i,n,e,s,r,0,0,1,o.AFFINE)},setToRotationAxisAngle:function(t,i){var n=Math.cos(i),e=Math.sin(i),s=1-n;return this.rowMajor(t.x*t.x*s+n,t.x*t.y*s-t.z*e,t.x*t.z*s+t.y*e,t.y*t.x*s+t.z*e,t.y*t.y*s+n,t.y*t.z*s-t.x*e,t.z*t.x*s-t.y*e,t.z*t.y*s+t.x*e,t.z*t.z*s+n,o.OTHER)},setToRotationX:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(1,0,0,0,i,-n,0,n,i,o.OTHER)},setToRotationY:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(i,0,n,0,1,0,-n,0,i,o.OTHER)},setToRotationZ:function(t){var i=Math.cos(t),n=Math.sin(t);return this.rowMajor(i,-n,0,n,i,0,0,0,1,o.AFFINE)},setToSVGMatrix:function(t){return this.rowMajor(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,o.AFFINE)},setRotationAToB:function(t,i){var e,s,r,h=t,o=i,a=1e-4,m=h.cross(o);if(e=h.dot(o),r=0>e?-e:e,r>1-a){var u,c,f,d=new n.Vector3(h.x>0?h.x:-h.x,h.y>0?h.y:-h.y,h.z>0?h.z:-h.z);d=d.x<d.y?d.x<d.z?n.Vector3.X_UNIT:n.Vector3.Z_UNIT:d.y<d.z?n.Vector3.Y_UNIT:n.Vector3.Z_UNIT;var l=d.minus(h);return m=d.minus(o),u=2/l.dot(l),c=2/m.dot(m),f=u*c*l.dot(m),this.rowMajor(-u*l.x*l.x-c*m.x*m.x+f*m.x*l.x+1,-u*l.x*l.y-c*m.x*m.y+f*m.x*l.y,-u*l.x*l.z-c*m.x*m.z+f*m.x*l.z,-u*l.y*l.x-c*m.y*m.x+f*m.y*l.x,-u*l.y*l.y-c*m.y*m.y+f*m.y*l.y+1,-u*l.y*l.z-c*m.y*m.z+f*m.y*l.z,-u*l.z*l.x-c*m.z*m.x+f*m.z*l.x,-u*l.z*l.y-c*m.z*m.y+f*m.z*l.y,-u*l.z*l.z-c*m.z*m.z+f*m.z*l.z+1)}var x,v,p,y,g;return s=1/(1+e),x=s*m.x,v=s*m.z,p=x*m.y,y=x*m.z,g=v*m.y,this.rowMajor(e+x*m.x,p-m.z,y+m.y,p+m.z,e+s*m.y*m.y,g-m.x,y-m.y,g+m.x,e+v*m.z)},setTo32Bit:function(){return window.Float32Array&&(this.entries=new window.Float32Array(this.entries)),this},setTo64Bit:function(){return window.Float64Array&&(this.entries=new window.Float64Array(this.entries)),this},multiplyVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y+this.m02(),this.m10()*t.x+this.m11()*t.y+this.m12())},multiplyVector3:function(t){return t.setXYZ(this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,this.m20()*t.x+this.m21()*t.y+this.m22()*t.z)},multiplyTransposeVector2:function(t){return t.setXY(this.m00()*t.x+this.m10()*t.y,this.m01()*t.x+this.m11()*t.y)},multiplyRelativeVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y,this.m10()*t.y+this.m11()*t.y)},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==o.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},e.mixin(i,{defaultFactory:function(){return new i},constructorDuplicateFactory:function(t){return function(n,e,s,r,h,o,a,m,u,c){var f=t.length?t.pop():new i;return f.rowMajor(n,e,s,r,h,o,a,m,u,c)}}}),i.IDENTITY=i.identity(),i.IDENTITY.makeImmutable(),i.X_REFLECTION=i.createFromPool(-1,0,0,0,1,0,0,0,1,o.AFFINE),i.X_REFLECTION.makeImmutable(),i.Y_REFLECTION=i.createFromPool(1,0,0,0,-1,0,0,0,1,o.AFFINE),i.Y_REFLECTION.makeImmutable(),i.translationTimesMatrix=function(t,n,e){var s;return e.type===o.IDENTITY||e.type===o.TRANSLATION_2D?i.createFromPool(1,0,e.m02()+t,0,1,e.m12()+n,0,0,1,o.TRANSLATION_2D):(s=e.type===o.OTHER?o.OTHER:o.AFFINE,i.createFromPool(e.m00(),e.m01(),e.m02()+t,e.m10(),e.m11(),e.m12()+n,e.m20(),e.m21(),e.m22(),s))},i.printer={print:function(t){console.log(t.toString())}},i}),n("DOT/MatrixOps3",["require","DOT/dot"],function(t){"use strict";var i=t("DOT/dot"),n=Math.sqrt(.5),e={Array:i.FastArray,index3:function(t,i){return 3*t+i},set3:function(t,i){i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8]},transpose3:function(t,i){var n=t[3],e=t[6],s=t[1],r=t[7],h=t[2],o=t[5];i[0]=t[0],i[1]=n,i[2]=e,i[3]=s,i[4]=t[4],i[5]=r,i[6]=h,i[7]=o,i[8]=t[8]},det3:function(t){return t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7]-t[2]*t[4]*t[6]-t[1]*t[3]*t[8]-t[0]*t[5]*t[7]},mult3:function(t,i,n){var e=t[0]*i[0]+t[1]*i[3]+t[2]*i[6],s=t[0]*i[1]+t[1]*i[4]+t[2]*i[7],r=t[0]*i[2]+t[1]*i[5]+t[2]*i[8],h=t[3]*i[0]+t[4]*i[3]+t[5]*i[6],o=t[3]*i[1]+t[4]*i[4]+t[5]*i[7],a=t[3]*i[2]+t[4]*i[5]+t[5]*i[8],m=t[6]*i[0]+t[7]*i[3]+t[8]*i[6],u=t[6]*i[1]+t[7]*i[4]+t[8]*i[7],c=t[6]*i[2]+t[7]*i[5]+t[8]*i[8];n[0]=e,n[1]=s,n[2]=r,n[3]=h,n[4]=o,n[5]=a,n[6]=m,n[7]=u,n[8]=c},mult3LeftTranspose:function(t,i,n){var e=t[0]*i[0]+t[3]*i[3]+t[6]*i[6],s=t[0]*i[1]+t[3]*i[4]+t[6]*i[7],r=t[0]*i[2]+t[3]*i[5]+t[6]*i[8],h=t[1]*i[0]+t[4]*i[3]+t[7]*i[6],o=t[1]*i[1]+t[4]*i[4]+t[7]*i[7],a=t[1]*i[2]+t[4]*i[5]+t[7]*i[8],m=t[2]*i[0]+t[5]*i[3]+t[8]*i[6],u=t[2]*i[1]+t[5]*i[4]+t[8]*i[7],c=t[2]*i[2]+t[5]*i[5]+t[8]*i[8];n[0]=e,n[1]=s,n[2]=r,n[3]=h,n[4]=o,n[5]=a,n[6]=m,n[7]=u,n[8]=c},mult3RightTranspose:function(t,i,n){var e=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],s=t[0]*i[3]+t[1]*i[4]+t[2]*i[5],r=t[0]*i[6]+t[1]*i[7]+t[2]*i[8],h=t[3]*i[0]+t[4]*i[1]+t[5]*i[2],o=t[3]*i[3]+t[4]*i[4]+t[5]*i[5],a=t[3]*i[6]+t[4]*i[7]+t[5]*i[8],m=t[6]*i[0]+t[7]*i[1]+t[8]*i[2],u=t[6]*i[3]+t[7]*i[4]+t[8]*i[5],c=t[6]*i[6]+t[7]*i[7]+t[8]*i[8];n[0]=e,n[1]=s,n[2]=r,n[3]=h,n[4]=o,n[5]=a,n[6]=m,n[7]=u,n[8]=c},mult3BothTranspose:function(t,i,n){var e=t[0]*i[0]+t[3]*i[1]+t[6]*i[2],s=t[0]*i[3]+t[3]*i[4]+t[6]*i[5],r=t[0]*i[6]+t[3]*i[7]+t[6]*i[8],h=t[1]*i[0]+t[4]*i[1]+t[7]*i[2],o=t[1]*i[3]+t[4]*i[4]+t[7]*i[5],a=t[1]*i[6]+t[4]*i[7]+t[7]*i[8],m=t[2]*i[0]+t[5]*i[1]+t[8]*i[2],u=t[2]*i[3]+t[5]*i[4]+t[8]*i[5],c=t[2]*i[6]+t[5]*i[7]+t[8]*i[8];n[0]=e,n[1]=s,n[2]=r,n[3]=h,n[4]=o,n[5]=a,n[6]=m,n[7]=u,n[8]=c},mult3Vector3:function(t,i,n){var e=t[0]*i.x+t[1]*i.y+t[2]*i.z,s=t[3]*i.x+t[4]*i.y+t[5]*i.z,r=t[6]*i.x+t[7]*i.y+t[8]*i.z;n.x=e,n.y=s,n.z=r},swapNegateColumn:function(t,i,n){var e=t[i],s=t[i+3],r=t[i+6];t[i]=t[n],t[i+3]=t[n+3],t[i+6]=t[n+6],t[n]=-e,t[n+3]=-s,t[n+6]=-r},setIdentity3:function(t){t[0]=t[4]=t[8]=1,t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0},setGivens3:function(t,i,n,e,s){this.setIdentity3(t),t[this.index3(e,e)]=i,t[this.index3(s,s)]=i,t[this.index3(e,s)]=n,t[this.index3(s,e)]=-n},preMult3Givens:function(t,i,n,e,s){var r=3*e,h=3*s,o=i*t[r+0]+n*t[h+0],a=i*t[h+0]-n*t[r+0],m=i*t[r+1]+n*t[h+1],u=i*t[h+1]-n*t[r+1],c=i*t[r+2]+n*t[h+2],f=i*t[h+2]-n*t[r+2];t[r+0]=o,t[h+0]=a,t[r+1]=m,t[h+1]=u,t[r+2]=c,t[h+2]=f},postMult3Givens:function(t,i,n,e,s){var r=i*t[e+0]+n*t[s+0],h=i*t[s+0]-n*t[e+0],o=i*t[e+3]+n*t[s+3],a=i*t[s+3]-n*t[e+3],m=i*t[e+6]+n*t[s+6],u=i*t[s+6]-n*t[e+6];t[e+0]=r,t[s+0]=h,t[e+3]=o,t[s+3]=a,t[e+6]=m,t[s+6]=u},applyJacobi3:function(t,i,e,s){var r=t[3*e+e],h=t[3*e+s],o=t[3*s+s],a=h*h,m=r-o;m*=m;var u=m>a,c=1/Math.sqrt(a+m),f=u?c*(r-o):n,d=u?c*h:n;this.preMult3Givens(t,f,d,e,s),this.postMult3Givens(t,f,d,e,s),this.preMult3Givens(i,f,d,e,s)},jacobiIteration3:function(t,i,n){for(var e=0;n>e;e++)this.applyJacobi3(t,i,0,1),this.applyJacobi3(t,i,0,2),this.applyJacobi3(t,i,1,2)},qrAnnihilate3:function(t,i,n,e){var s,r,h=1e-10,o=i[this.index3(e,e)],a=i[this.index3(n,e)],m=o*o,u=a*a;if(h>m+u)s=o>0?1:0,r=0;else{var c=1/Math.sqrt(m+u);s=c*o,r=c*a}this.preMult3Givens(i,s,r,e,n),this.postMult3Givens(t,s,r,e,n)},svd3:function(t,i,n,e,s){var r=n,h=s,o=e;this.mult3LeftTranspose(t,t,o),this.setIdentity3(r),this.jacobiIteration3(o,r,i),this.transpose3(r,h),this.mult3(t,h,o);var a,m=o[0]*o[0]+o[3]*o[3]+o[6]*o[6],u=o[1]*o[1]+o[4]*o[4]+o[7]*o[7],c=o[2]*o[2]+o[5]*o[5]+o[8]*o[8];u>m&&(a=m,m=u,u=a,this.swapNegateColumn(o,0,1),this.swapNegateColumn(h,0,1)),c>m&&(a=m,m=c,c=a,this.swapNegateColumn(o,0,2),this.swapNegateColumn(h,0,2)),c>u&&(this.swapNegateColumn(o,1,2),this.swapNegateColumn(h,1,2)),this.setIdentity3(r),this.qrAnnihilate3(r,o,1,0),this.qrAnnihilate3(r,o,2,0),this.qrAnnihilate3(r,o,2,1);var f=.001;r[0]*r[0]+r[1]*r[1]+r[2]*r[2]<f&&(r[0]=1),r[3]*r[3]+r[4]*r[4]+r[5]*r[5]<f&&(r[4]=1),r[6]*r[6]+r[7]*r[7]+r[8]*r[8]<f&&(r[8]=1)},setVectors3:function(t,i){for(var n=t.length,e=0;n>e;e++){var s=t[e];i[e]=s.x,i[e+n]=s.y,i[e+2*n]=s.z}},getColumnVector3:function(t,i,n,e,s){s.x=n[e],s.y=n[e+i],s.z=n[e+2*i]},index:function(t,i,n,e){return i*n+e},transpose:function(t,i,n,e){for(var s=0;t>s;s++)for(var r=0;i>r;r++)e[t*r+s]=n[i*s+r]},mult:function(t,i,n,e,s,r){for(var h=0;t>h;h++)for(var o=0;n>o;o++){for(var a=0,m=0;i>m;m++)a+=e[this.index(t,i,h,m)]*s[this.index(i,n,m,o)];r[this.index(t,n,h,o)]=a}},multRightTranspose:function(t,i,n,e,s,r){for(var h=0;t>h;h++)for(var o=0;n>o;o++){for(var a=0,m=0;i>m;m++)a+=e[this.index(t,i,h,m)]*s[this.index(n,i,o,m)];r[this.index(t,n,h,o)]=a}},permuteColumns:function(t,i,n,e,s){for(var r=0;i>r;r++)for(var h=e.indices[r],o=0;t>o;o++)s[this.index(t,i,o,r)]=n[this.index(t,i,o,h)]}};return i.register("MatrixOps3",e),e}),n("DOT/Permutation",["require","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){"use strict";function i(t){this.indices=t}function n(t,i,e){if(0===t.length)e(i);else for(var s=0;s<t.length;s++){var r=t[s],h=t.slice(0);h.splice(s,1);var o=i.slice(0);o.push(r),n(h,o,e)}}var e=t("DOT/dot"),s=t("PHET_CORE/isArray");return t("DOT/Util"),e.register("Permutation",i),i.identity=function(t){for(var n=new Array(t),e=0;t>e;e++)n[e]=e;return new i(n)},i.permutations=function(t){var n=[];return i.forEachPermutation(e.rangeInclusive(0,t-1),function(t){n.push(new i(t))}),n},i.forEachPermutation=function(t,i){n(t,[],i)},i.prototype={constructor:i,size:function(){return this.indices.length},apply:function(t){if(s(t)){if(t.length!==this.size())throw new Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=t[this.indices[n]];return i}return this.indices[t]},inverted:function(){for(var t=new Array(this.size()),n=0;n<this.size();n++)t[this.indices[n]]=n;return new i(t)},withIndicesPermuted:function(t){var n=[],e=this;return i.forEachPermutation(t,function(s){for(var r=e.indices,h=r.slice(0),o=0;o<t.length;o++)h[t[o]]=r[s[o]];n.push(new i(h))}),n},toString:function(){return"P["+this.indices.join(", ")+"]"}},i.testMe=function(t){var n=new i([1,4,3,2,0]);t.log(n.toString());var e=n.inverted();t.log(e.toString()),t.log(e.withIndicesPermuted([0,3,4]).toString()),t.log(i.permutations(4).toString())},i}),n("DOT/Plane3",["require","DOT/dot","DOT/Vector3"],function(t){"use strict";function i(t,i){this.normal=t,this.distance=i}var n=t("DOT/dot"),e=t("DOT/Vector3");return n.register("Plane3",i),i.prototype={constructor:i,intersectWithRay:function(t){return t.pointAtDistance(t.distanceToPlane(this))}},i.XY=new i(new e(0,0,1),0),i.XZ=new i(new e(0,1,0),0),i.YZ=new i(new e(1,0,0),0),i.fromTriangle=function(t,n,e){var s=e.minus(t).cross(n.minus(t));return 0===s.magnitude()?null:(s.normalize(),new i(s,s.dot(t)))},i}),n("DOT/Quaternion",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector3","DOT/Matrix3","DOT/Util"],function(t){"use strict";function i(t,i,n,e){this.setXYZW(t,i,n,e)}var n=t("DOT/dot"),e=t("PHET_CORE/Poolable");return t("DOT/Vector3"),t("DOT/Matrix3"),t("DOT/Util"),n.register("Quaternion",i),i.prototype={constructor:i,isQuaternion:!0,setXYZW:function(t,i,n,e){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==n?n:0,this.w=void 0!==e?e:1},plus:function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},timesScalar:function(t){return new i(this.x*t,this.y*t,this.z*t,this.w*t)},timesQuaternion:function(t){return new i(this.x*t.w-this.z*t.y+this.y*t.z+this.w*t.x,-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w)},timesVector3:function(t){return 0===t.magnitude()?new n.Vector3:new n.Vector3(this.w*this.w*t.x+2*this.y*this.w*t.z-2*this.z*this.w*t.y+this.x*this.x*t.x+2*this.y*this.x*t.y+2*this.z*this.x*t.z-this.z*this.z*t.x-this.y*this.y*t.x,2*this.x*this.y*t.x+this.y*this.y*t.y+2*this.z*this.y*t.z+2*this.w*this.z*t.x-this.z*this.z*t.y+this.w*this.w*t.y-2*this.x*this.w*t.z-this.x*this.x*t.y,2*this.x*this.z*t.x+2*this.y*this.z*t.y+this.z*this.z*t.z-2*this.w*this.y*t.x-this.y*this.y*t.z+2*this.w*this.x*t.y-this.x*this.x*t.z+this.w*this.w*t.z)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},normalized:function(){var t=this.magnitude();return this.timesScalar(1/t)},negated:function(){return new i(-this.x,-this.y,-this.z,-this.w)},toRotationMatrix:function(){var t=this.magnitudeSquared(),i=1===t?2:t>0?2/t:0,e=this.x*this.x*i,s=this.x*this.y*i,r=this.x*this.z*i,h=this.w*this.x*i,o=this.y*this.y*i,a=this.y*this.z*i,m=this.w*this.y*i,u=this.z*this.z*i,c=this.w*this.z*i;return n.Matrix3.dirtyFromPool().columnMajor(1-(o+u),s+c,r-m,s-c,1-(e+u),a+h,r+m,a-h,1-(e+o))}},i.fromEulerAngles=function(t,n,e){var s=Math.sin(.5*e),r=Math.cos(.5*e),h=Math.sin(.5*n),o=Math.cos(.5*n),a=Math.sin(.5*t),m=Math.cos(.5*t),u=o*r,c=h*s,f=o*s,d=h*r;return new i(u*a+c*m,d*m+f*a,f*m-d*a,u*m-c*a)},i.fromRotationMatrix=function(t){var n,e=t.m00(),s=t.m01(),r=t.m02(),h=t.m10(),o=t.m11(),a=t.m12(),m=t.m20(),u=t.m21(),c=t.m22(),f=e+o+c;return f>=0?(n=Math.sqrt(f+1),new i(.5*(u-a)/n,.5*(r-m)/n,.5*(h-s)/n,.5*n)):e>o&&e>c?(n=Math.sqrt(1+e-o-c),new i(.5*n,.5*(h+s)/n,.5*(r+m)/n,.5*(u-a)/n)):o>c?(n=Math.sqrt(1+o-e-c),new i(.5*(h+s)/n,.5*n,.5*(u+a)/n,.5*(r-m)/n)):(n=Math.sqrt(1+c-e-o),new i(.5*(r+m)/n,.5*(u+a)/n,.5*n,.5*(h-s)/n))},i.getRotationQuaternion=function(t,e){return i.fromRotationMatrix(n.Matrix3.rotateAToB(t,e))},i.slerp=function(t,n,e){if(t.x===n.x&&t.y===n.y&&t.z===n.z&&t.w===n.w)return t;var s=t.x*n.x+t.y*n.y+t.z*n.z+t.w*n.w;0>s&&(n=n.negated(),s=-s);var r=1-e,h=e;if(1-s>.1){var o=Math.acos(s),a=1/Math.sin(o);r=Math.sin((1-e)*o)*a,h=Math.sin(e*o)*a}return new i(r*t.x+h*n.x,r*t.y+h*n.y,r*t.z+h*n.z,r*t.w+h*n.w)},e.mixin(i,{defaultFactory:function(){return new i},constructorDuplicateFactory:function(t){return function(n,e,s,r){return t.length?t.pop().set(n,e,s,r):new i(n,e,s,r)}}}),i}),n("DOT/Random",["require","DOT/Util","DOT/dot"],function(t){"use strict";function i(t){t=_.extend({tandem:null,seed:null,staticSeed:!1},t),null!==t.seed&&t.staticSeed;var i=t.staticSeed?window.phet.chipper.randomSeed:t.seed;this.setSeed(i),t.tandem&&t.tandem.addInstance(this)}var n=t("DOT/Util"),e=t("DOT/dot");return e.register("Random",i),i.prototype={constructor:i,setSeed:function(t){this.seed=t,this.seedrandom=null!==this.seed?new Math.seedrandom(this.seed+""):null},getSeed:function(){return this.seed},random:function(){return null===this.seed?Math.random():this.seedrandom()},nextBoolean:function(){return this.random()>=.5},nextInt:function(t){var i=this.random()*t;return 0|i},nextDouble:function(){var t=this.random();return t},nextGaussian:function(){return n.boxMullerTransform(0,1)}},i}),n("DOT/Ray2",["require","DOT/dot"],function(t){"use strict";function i(t,i){this.position=t,this.direction=i}var n=t("DOT/dot");return n.register("Ray2",i),i.prototype={constructor:i,shifted:function(t){return new i(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},toString:function(){return this.position.toString()+" => "+this.direction.toString()}},i}),n("DOT/Ray3",["require","DOT/dot"],function(t){"use strict";function i(t,i){this.position=t,this.direction=i}var n=t("DOT/dot");return n.register("Ray3",i),i.prototype={constructor:i,shifted:function(t){return new i(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},distanceToPlane:function(t){return(t.distance-this.position.dot(t.normal))/this.direction.dot(t.normal)},toString:function(){return this.position.toString()+" => "+this.direction.toString()}},i}),n("DOT/Rectangle",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){"use strict";function i(t,i,n,e){s.call(this,t,i,t+n,i+e)}var n=t("DOT/dot"),e=t("PHET_CORE/inherit"),s=t("DOT/Bounds2");return n.register("Rectangle",i),e(s,i),i}),n("DOT/Sphere3",["require","DOT/dot"],function(t){"use strict";function i(t,i){this.center=t,this.radius=i}var n=t("DOT/dot");return n.register("Sphere3",i),i.prototype={constructor:i,intersect:function(t,i){var n=t.direction,e=t.position,s=e.minus(this.center),r=n.dot(s),h=s.magnitudeSquared(),o=4*r*r-4*(h-this.radius*this.radius);if(i>o)return null;var a=n.dot(this.center)-n.dot(e),m=Math.sqrt(o)/2,u=a-m,c=a+m;if(i>c)return null;var f=t.pointAtDistance(c),d=f.minus(this.center).normalized();if(i>u)return{distance:c,hitPoint:f,normal:d.negated(),fromOutside:!1};var l=t.pointAtDistance(u),x=l.minus(this.center).normalized();return{distance:u,hitPoint:l,normal:x,fromOutside:!0}},intersections:function(t,i){var n=t.direction,e=t.position,s=e.minus(this.center),r=n.dot(s),h=s.magnitudeSquared(),o=4*r*r-4*(h-this.radius*this.radius);if(i>o)return[];var a=n.dot(this.center)-n.dot(e),m=Math.sqrt(o)/2,u=a-m,c=a+m;if(i>c)return[];var f=t.pointAtDistance(c),d=f.minus(this.center).normalized(),l=t.pointAtDistance(u),x=l.minus(this.center).normalized(),v={distance:c,hitPoint:f,normal:d.negated(),fromOutside:!1},p={distance:u,hitPoint:l,normal:x,fromOutside:!0};return i>u?[v,p]:[p,v]}},i}),n("AXON/axon",["require","PHET_CORE/Namespace"],function(t){"use strict";var i=t("PHET_CORE/Namespace");return new i("axon")}),n("PHET_CORE/cleanArray",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){if(t){for(;t.length;)t.pop();return t}return[]}var n=t("PHET_CORE/phetCore");return n.register("cleanArray",i),i}),n("AXON/Events",["require","AXON/axon","PHET_CORE/cleanArray"],function(t){"use strict";function i(t){this._eventListeners={},this._staticEventListeners={},t&&t.tandem&&t.tandem.addInstance(this),this.disposeEvents=function(){t&&t.tandem&&t.tandem.removeInstance(this)}}var n=t("AXON/axon"),e=t("PHET_CORE/cleanArray");return n.register("Events",i),i.prototype={dispose:function(){this.disposeEvents()},on:function(t,i){this._eventListeners[t]=this._eventListeners[t]||[],this._eventListeners[t].push(i)},onStatic:function(t,i){this._staticEventListeners[t]=this._staticEventListeners[t]||[],this._staticEventListeners[t].push(i)},once:function(t,i){var n=this,e=function(){n.off(t,e),0===arguments.length?i():i.apply(this,Array.prototype.slice.call(arguments,0))};return this.on(t,e),e},off:function(t,i){var n=-1;return this._eventListeners[t]&&(n=this._eventListeners[t].indexOf(i),-1!==n&&this._eventListeners[t].splice(n,1)),n},offStatic:function(t,i){var n=-1;return this._staticEventListeners[t]&&(n=this._staticEventListeners[t].indexOf(i),-1!==n&&this._staticEventListeners[t].splice(n,1)),n},hasListener:function(t,i){var n=this._eventListeners[t];return!!n&&n.indexOf(i)>=0},hasStaticListener:function(t,i){var n=this._staticEventListeners[t];return!!n&&n.indexOf(i)>=0},removeAllEventListeners:function(){var t;for(t in this._eventListeners)e(this._eventListeners[t]);for(t in this._staticEventListeners)e(this._staticEventListeners[t])},trigger:function(t){var i,n=this._eventListeners[t],e=this._staticEventListeners[t],s=n?n.length:0,r=e?e.length:0,h=1===arguments.length;!h&&(s>0||r>0)&&(i=Array.prototype.slice.call(arguments,1)),s>0&&(n=n.slice());var o;for(o=0;s>o;o++){var a=n[o];h?a():a.apply(this,i)}for(o=0;r>o;o++){var m=e[o];h?m(arguments):m.apply(this,i)}},trigger0:function(t){var i=this._eventListeners[t],n=this._staticEventListeners[t],e=i?i.length:0,s=n?n.length:0;e>0&&(i=i.slice());var r;for(r=0;e>r;r++)i[r]();for(r=0;s>r;r++)n[r]()},trigger1:function(t,i){var n=this._eventListeners[t],e=this._staticEventListeners[t],s=n?n.length:0,r=e?e.length:0;s>0&&(n=n.slice());var h;for(h=0;s>h;h++)n[h](i);for(h=0;r>h;h++)e[h](i)},trigger2:function(t,i,n){var e=this._eventListeners[t],s=this._staticEventListeners[t],r=e?e.length:0,h=s?s.length:0;r>0&&(e=e.slice());var o;for(o=0;r>o;o++)e[o](i,n);for(o=0;h>o;o++)s[o](i,n)}},i}),n("DOT/Transform3",["require","PHET_CORE/inherit","AXON/Events","DOT/dot","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){"use strict";function i(t){e.call(this),this.matrix=s.Matrix3.IDENTITY.copy(),this.inverse=s.Matrix3.IDENTITY.copy(),this.matrixTransposed=s.Matrix3.IDENTITY.copy(),this.inverseTransposed=s.Matrix3.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,t&&this.setMatrix(t)}var n=t("PHET_CORE/inherit"),e=t("AXON/Events"),s=t("DOT/dot");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2");var r=new s.Matrix3;return s.register("Transform3",i),n(e,i,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.trigger0("change")},prepend:function(t){r.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(r),this.invalidate()},prependTranslation:function(t,i){this.matrix.prependTranslation(t,i),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new i(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===s.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){var i=this.getMatrix();return new s.Vector2(i.m00()*t.x+i.m01()*t.y,i.m10()*t.x+i.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t).normalize()},transformX:function(t){var i=this.getMatrix();return i.m00()*t+i.m02()},transformY:function(t){
var i=this.getMatrix();return i.m11()*t+i.m12()},transformDeltaX:function(t){var i=this.getMatrix();return i.m00()*t},transformDeltaY:function(t){var i=this.getMatrix();return i.m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new s.Ray2(this.transformPosition2(t.position),this.transformDelta2(t.direction).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){var i=this.getInverse();return new s.Vector2(i.m00()*t.x+i.m01()*t.y,i.m10()*t.x+i.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t).normalize()},inverseX:function(t){var i=this.getInverse();return i.m00()*t+i.m02()},inverseY:function(t){var i=this.getInverse();return i.m11()*t+i.m12()},inverseDeltaX:function(t){var i=this.getInverse();return i.m00()*t},inverseDeltaY:function(t){var i=this.getInverse();return i.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new s.Ray2(this.inversePosition2(t.position),this.inverseDelta2(t.direction).normalized())}}),i}),n("DOT/Transform4",["require","DOT/dot","AXON/Events","PHET_CORE/inherit","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){"use strict";function i(t){e.call(this),this.matrix=n.Matrix4.IDENTITY.copy(),this.inverse=n.Matrix4.IDENTITY.copy(),this.matrixTransposed=n.Matrix4.IDENTITY.copy(),this.inverseTransposed=n.Matrix4.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,t&&this.setMatrix(t)}var n=t("DOT/dot"),e=t("AXON/Events"),s=t("PHET_CORE/inherit");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3");var r=new n.Matrix4;return n.register("Transform4",i),s(e,i,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.trigger0("change")},prepend:function(t){r.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(r),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},copy:function(){var t=new i(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===n.Matrix4.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new n.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new n.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new n.Vector3(0,0,t)).z},transformRay:function(t){return new n.Ray3(this.transformPosition3(t.position),this.transformPosition3(t.position.plus(t.direction)).minus(this.transformPosition3(t.position)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(n.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new n.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new n.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new n.Vector3(0,0,t)).z},inverseRay:function(t){return new n.Ray3(this.inversePosition3(t.position),this.inversePosition3(t.position.plus(t.direction)).minus(this.inversePosition3(t.position)))}}),i}),n("main",["DOT/dot","DOT/BinPacker","DOT/Bounds2","DOT/Bounds3","DOT/Complex","DOT/ConvexHull2","DOT/Dimension2","DOT/EigenvalueDecomposition","DOT/LinearFunction","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/MatrixOps3","DOT/Permutation","DOT/Plane3","DOT/QRDecomposition","DOT/Quaternion","DOT/Random","DOT/Ray2","DOT/Ray3","DOT/Rectangle","DOT/SingularValueDecomposition","DOT/Sphere3","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){"use strict";return t}),n("PHET_CORE/arrayRemove",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){var n=_.indexOf(t,i);t.splice(n,1)}var n=t("PHET_CORE/phetCore");return n.register("arrayRemove",i),i}),n("PHET_CORE/collect",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){var i=[];return t(function(t){i.push(t)}),i}var n=t("PHET_CORE/phetCore");return n.register("collect",i),i}),n("PHET_CORE/detectPrefix",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){return void 0!==t[i]?i:(i=i.charAt(0).toUpperCase()+i.slice(1),void 0!==t["moz"+i]?"moz"+i:void 0!==t["Moz"+i]?"Moz"+i:void 0!==t["webkit"+i]?"webkit"+i:void 0!==t["ms"+i]?"ms"+i:void 0!==t["o"+i]?"o"+i:void 0)}var n=t("PHET_CORE/phetCore");return n.register("detectPrefix",i),i}),n("PHET_CORE/detectPrefixEvent",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i,n){return void 0!==t["on"+i]?i:void 0!==t["onmoz"+i]?"moz"+i:void 0!==t["onMoz"+i]?"Moz"+i:void 0!==t["onwebkit"+i]?"webkit"+i:void 0!==t["onms"+i]?"ms"+i:void 0!==t["ono"+i]?"o"+i:void 0}var n=t("PHET_CORE/phetCore");return n.register("detectPrefixEvent",i),i}),n("PHET_CORE/escapeHTML",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")}var n=t("PHET_CORE/phetCore");return n.register("escapeHTML",i),i}),n("PHET_CORE/EventTimer",["require","PHET_CORE/phetCore","PHET_CORE/inherit"],function(t){"use strict";function i(t,i){this.eventModel=t,this.eventCallback=i,this.timeBeforeNextEvent=this.eventModel.getPeriodBeforeNextEvent()}var n=t("PHET_CORE/phetCore"),e=t("PHET_CORE/inherit");return n.register("EventTimer",i),e(Object,i,{step:function(t){for(;t>=this.timeBeforeNextEvent;)t-=this.timeBeforeNextEvent,this.timeBeforeNextEvent=this.eventModel.getPeriodBeforeNextEvent(),this.eventCallback(t);this.timeBeforeNextEvent-=t}}),i.ConstantEventModel=e(Object,function(t){this.rate=t},{getPeriodBeforeNextEvent:function(){return 1/this.rate}}),i.UniformEventModel=e(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return 2*t/this.rate}}),i.PoissonEventModel=e(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return-Math.log(t)/this.rate}}),i}),n("PHET_CORE/loadScript",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){"string"==typeof t&&(t={src:t});var i=t.src,n=t.callback,e=void 0===t.async?!0:t.async,s=void 0===t.cacheBuster?!1:t.cacheBuster,r=!1,h=document.createElement("script");h.type="text/javascript",h.async=e,h.onload=h.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||r||(r=!0,n&&n())},h.src=i+(s?"?random="+Math.random().toFixed(10):"");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(h,o)}var n=t("PHET_CORE/phetCore");return n.register("loadScript",i),i}),n("PHET_CORE/pairs",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){var i=[],n=t.length;if(n>1)for(var e=0;n-1>e;e++)for(var s=t[e],r=e+1;n>r;r++)i.push([s,t[r]]);return i}var n=t("PHET_CORE/phetCore");return n.register("pairs",i),i}),n("PHET_CORE/partition",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){for(var n=[],e=[],s=t.length,r=0;s>r;r++)i(t[r])?n.push(t[r]):e.push(t[r]);return[n,e]}var n=t("PHET_CORE/phetCore");return n.register("partition",i),i}),n("PHET_CORE/platform",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return n()===t}function n(){var t=-1,i=null;return"Microsoft Internet Explorer"===navigator.appName?(i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==i.exec(s)&&(t=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(i=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==i.exec(s)&&(t=parseFloat(RegExp.$1))),t}var e=t("PHET_CORE/phetCore"),s=navigator.userAgent,r={firefox:s.toLowerCase().indexOf("firefox")>-1,mobileSafari:!(!s.match(/(iPod|iPhone|iPad)/)||!s.match(/AppleWebKit/)),safari5:!!(s.match(/Version\/5\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari6:!!(s.match(/Version\/6\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari7:!!(s.match(/Version\/7\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),ie:-1!==n(),ie9:i(9),ie10:i(10),ie11:i(11),android:s.indexOf("Android")>0,edge:!!s.match(/Edge\//),chromium:/chrom(e|ium)/.test(s.toLowerCase())&&!s.match(/Edge\//)};return e.register("platform",r),r}),n("PHET_CORE/main",["PHET_CORE/phetCore","PHET_CORE/arrayRemove","PHET_CORE/cleanArray","PHET_CORE/collect","PHET_CORE/detectPrefix","PHET_CORE/detectPrefixEvent","PHET_CORE/escapeHTML","PHET_CORE/EventTimer","PHET_CORE/extend","PHET_CORE/inherit","PHET_CORE/isArray","PHET_CORE/loadScript","PHET_CORE/pairs","PHET_CORE/partition","PHET_CORE/phetAllocation","PHET_CORE/platform","PHET_CORE/Poolable"],function(t){"use strict";return t}),n("AXON/Emitter",["require","PHET_CORE/inherit","AXON/axon"],function(t){"use strict";function i(){this.listeners=[],this.listenersToEmitTo=[]}var n=t("PHET_CORE/inherit"),e=t("AXON/axon");return e.register("Emitter",i),n(Object,i,{addListener:function(t){this.defendCallbacks(),this.listeners.push(t)},removeListener:function(t){var i=this.listeners.indexOf(t);this.defendCallbacks(),this.listeners.splice(i,1)},removeAllListeners:function(){for(;this.listeners.length>0;)this.removeListener(this.listeners[0])},defendCallbacks:function(){for(var t=this.listenersToEmitTo.length-1;t>=0&&!this.listenersToEmitTo[t].defended;t--){var i=this.listeners.slice();i.defended=!0,this.listenersToEmitTo[t]=i}},emit:function(){this.listenersToEmitTo.push(this.listeners);for(var t=this.listenersToEmitTo.length-1,i=0;i<this.listenersToEmitTo[t].length;i++)this.listenersToEmitTo[t][i]();this.listenersToEmitTo.pop()},emit1:function(t){this.listenersToEmitTo.push(this.listeners);for(var i=this.listenersToEmitTo.length-1,n=0;n<this.listenersToEmitTo[i].length;n++)this.listenersToEmitTo[i][n](t);this.listenersToEmitTo.pop()},emit2:function(t,i){this.listenersToEmitTo.push(this.listeners);for(var n=this.listenersToEmitTo.length-1,e=0;e<this.listenersToEmitTo[n].length;e++)this.listenersToEmitTo[n][e](t,i);this.listenersToEmitTo.pop()},hasListener:function(t){return this.listeners.indexOf(t)>=0},hasListeners:function(){return this.listeners.length>0}})}),n("AXON/Multilink",["require","AXON/axon","PHET_CORE/inherit"],function(t){"use strict";function i(t,i,n){this.dependencies=t,this.dependencyValues=t.map(function(t){return t.get()});var e=this;this.dependencyListeners=[];for(var s=0;s<t.length;s++){var r=t[s];!function(t,n){var s=function(t){e.dependencyValues[n]=t,i.apply(null,e.dependencyValues)};e.dependencyListeners.push(s),t.lazyLink(s)}(r,s)}n||i.apply(null,this.dependencyValues)}var n=t("AXON/axon"),e=t("PHET_CORE/inherit");return n.register("Multilink",i),e(Object,i,{dispose:function(){for(var t=0;t<this.dependencies.length;t++){var i=this.dependencies[t];i.unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,this.dependencyValues=null}})}),n("AXON/Property",["require","AXON/axon","PHET_CORE/inherit","AXON/Events","AXON/Emitter","AXON/Multilink"],function(t){"use strict";function i(t,i){i&&i.isTandem,i=_.extend({tandem:null},i),this.events=new s,this._value=t,this._initialValue=t,this.changedEmitter=new r,i.tandem&&i.tandem.addInstance(this),this.disposeProperty=function(){i.tandem&&i.tandem.removeInstance(this)}}var n=t("AXON/axon"),e=t("PHET_CORE/inherit"),s=t("AXON/Events"),r=t("AXON/Emitter"),h=t("AXON/Multilink");return n.register("Property",i),e(Object,i,{get:function(){return this._value},set:function(t){return this.equalsValue(t)||this._setAndNotifyObservers(t),this},equalsValue:function(t){return this.areValuesEqual(t,this._value)},areValuesEqual:function(t,i){return t===i},get initialValue(){return this._initialValue},_setAndNotifyObservers:function(t){var i=this.get();this._value=t,this._notifyObservers(i)},_notifyObservers:function(t){var i=this.get();this.events.trigger2("startedCallbacksForChanged",i,t),this.changedEmitter.emit2(i,t),this.events.trigger0("endedCallbacksForChanged")},notifyObserversStatic:function(){this.changedEmitter.emit1(this.get())},reset:function(){this.set(this._initialValue)},get value(){return this.get()},set value(t){this.set(t)},link:function(t){this.changedEmitter.hasListener(t)||(this.changedEmitter.addListener(t),t(this.get(),null))},lazyLink:function(t){this.changedEmitter.addListener(t)},unlink:function(t){this.changedEmitter.hasListener(t)&&this.changedEmitter.removeListener(t)},unlinkAll:function(){this.changedEmitter.removeAllListeners()},linkAttribute:function(t,i){var n=function(n){t[i]=n};return this.link(n),n},unlinkAttribute:function(t){this.unlink(t)},toString:function(){return"Property{"+this.get()+"}"},valueOf:function(){return this.toString()},once:function(t){var i=this,n=function(e,s){i.unlink(n),t(e,s)};return this.lazyLink(n),n},debug:function(t){var i=function(i){console.log(t,i)};return this.link(i),i},get toggleFunction(){return this.toggle.bind(this)},toggle:function(){this.value=!this.value},onValue:function(t,i){var n=this,e=function(e){n.areValuesEqual(e,t)&&i()};return this.link(e),e},dispose:function(){this.disposeProperty()},hasListeners:function(){return this.changedEmitter.hasListeners()}},{multilink:function(t,i){return new h(t,i,!1)},lazyMultilink:function(t,i){return new h(t,i,!0)},unmultilink:function(t){t.dispose()},addProperty:function(t,n,e){var s=t[n+"Property"]=new i(e);Object.defineProperty(t,n,{get:function(){return s.get()},set:function(t){s.set(t)},configurable:!0,enumerable:!0})}})}),n("AXON/DerivedProperty",["require","AXON/Property","AXON/axon","PHET_CORE/inherit"],function(t){"use strict";function i(t,i){return t===i}function n(t){return!t}function e(t,i){return t&&i.value}function s(t,i){return t||i.value}function r(t,i){return t+i.value}function h(t,i){return t*i.value}function o(t,i,n){this.dependencies=t,this.dependencyValues=t.map(function(t){return t.get()});var e=i.apply(null,this.dependencyValues);a.call(this,e,n);var s=this;this.dependencyListeners=[];for(var r=0;r<t.length;r++){var h=t[r];!function(t,n){var e=function(t){s.dependencyValues[n]=t,a.prototype.set.call(s,i.apply(null,s.dependencyValues))};s.dependencyListeners.push(e),t.lazyLink(e)}(h,r)}}var a=t("AXON/Property"),m=t("AXON/axon"),u=t("PHET_CORE/inherit");return m.register("DerivedProperty",o),u(a,o,{dispose:function(){a.prototype.dispose.call(this);for(var t=0;t<this.dependencies.length;t++){var i=this.dependencies[t];i.unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,this.dependencyValues=null},set:function(t){throw new Error("Cannot set values directly to a derived property, tried to set: "+t)},set value(t){throw new Error("Cannot es5-set values directly to a derived property, tried to set: "+t)},get value(){return a.prototype.get.call(this)},reset:function(){throw new Error("Cannot reset a derived property directly")}},{valueEquals:function(t,n,e){return new o([t,n],i,e)},and:function(t,i){return new o(t,_.reduce.bind(null,t,e,!0),i)},or:function(t,i){return new o(t,_.reduce.bind(null,t,s,!1),i)},sum:function(t,i){return new o(t,_.reduce.bind(null,t,r,0),i)},plus:function(t,i,n){return o.sum([t,i],n)},product:function(t,i){return new o(t,_.reduce.bind(null,t,h,1),i)},times:function(t,i,n){return o.product([t,i],n)},lessThanNumber:function(t,i,n){return new o([t],function(t){return i>t},n)},lessThanEqualNumber:function(t,i,n){return new o([t],function(t){return i>=t},n)},greaterThanNumber:function(t,i,n){return new o([t],function(t){return t>i},n)},greaterThanEqualNumber:function(t,i,n){return new o([t],function(t){return t>=i},n)},derivedNot:function(t,i){return new o([t],n,i)},mapValues:function(t,i,n){return new o([t],function(t){return i[t]},n)}})}),n("AXON/ObservableArray",["require","AXON/Property","AXON/axon","PHET_CORE/inherit","AXON/Emitter"],function(t){"use strict";function i(t,i){t instanceof Object&&!(t instanceof Array)&&(i=t,t=null),this._options=_.extend({allowDuplicates:!1,tandem:null},i),this._array=t||[],this._addedListeners=[],this._removedListeners=[],this.lengthProperty=new n(this._array.length),this.initialArray=t?t.slice():[],this.startedCallbacksForItemAddedEmitter=new r,this.endedCallbacksForItemAddedEmitter=new r,this.startedCallbacksForItemRemovedEmitter=new r,this.endedCallbacksForItemRemovedEmitter=new r,i&&i.tandem&&i.tandem.addInstance(this),this.disposeObservableArray=function(){i&&i.tandem&&i.tandem.removeInstance(this)}}var n=t("AXON/Property"),e=t("AXON/axon"),s=t("PHET_CORE/inherit"),r=t("AXON/Emitter");return e.register("ObservableArray",i),s(Object,i,{dispose:function(){this.disposeObservableArray()},reset:function(){for(var t=0;t<this._array.length;t++)this._fireItemRemoved(this._array[t]);for(this._array=this.initialArray.slice(),t=0;t<this._array.length;t++)this._fireItemAdded(this._array[t])},get length(){return this._array.length},addItemAddedListener:function(t){this._addedListeners.push(t)},removeItemAddedListener:function(t){var i=this._addedListeners.indexOf(t);this._addedListeners.splice(i,1)},addItemRemovedListener:function(t){this._removedListeners.push(t)},removeItemRemovedListener:function(t){var i=this._removedListeners.indexOf(t);this._removedListeners.splice(i,1)},addListeners:function(t,i){this.addItemAddedListener(t),this.addItemRemovedListener(i)},_fireItemAdded:function(t){this.startedCallbacksForItemAddedEmitter.emit1(t);for(var i=this._addedListeners.slice(0),n=0;n<i.length;n++)i[n](t,this);this.endedCallbacksForItemAddedEmitter.emit()},_fireItemRemoved:function(t){this.startedCallbacksForItemRemovedEmitter.emit1(t);for(var i=this._removedListeners.slice(0),n=0;n<i.length;n++)i[n](t,this);this.endedCallbacksForItemRemovedEmitter.emit()},add:function(t){this.push(t)},addAll:function(t){for(var i=0;i<t.length;i++)this.add(t[i])},remove:function(t){var i=this._array.indexOf(t);-1!==i&&(this._array.splice(i,1),this.lengthProperty.set(this._array.length),this._fireItemRemoved(t))},removeAll:function(t){for(var i=0;i<t.length;i++){var n=t[i];this.remove(n)}},push:function(t){if(!this._options.allowDuplicates&&this.contains(t))throw new Error("duplicates are not allowed");this._array.push(t),this.lengthProperty.set(this._array.length),this._fireItemAdded(t)},pop:function(){var t=this._array.pop();return void 0!==t&&(this.lengthProperty.set(this._array.length),this._fireItemRemoved(t)),t},shift:function(){var t=this._array.shift();return void 0!==t&&(this.lengthProperty.set(this._array.length),this._fireItemRemoved(t)),t},contains:function(t){return-1!==this.indexOf(t)},get:function(t){return this._array[t]},indexOf:function(t){return this._array.indexOf(t)},clear:function(){for(var t=this._array.slice(0),i=0;i<t.length;i++)this.remove(t[i])},forEach:function(t){this._array.slice().forEach(t)},map:function(t){return new e.ObservableArray(this._array.map(t))},filter:function(t){return new e.ObservableArray(this._array.filter(t))},reduce:function(t,i){for(var n=0;n<this._array.length;n++)t=i(t,this._array[n]);return t},getArray:function(){return this._array}})}),n("AXON/PropertySet",["require","AXON/Property","AXON/DerivedProperty","AXON/Multilink","AXON/Events","AXON/axon","PHET_CORE/inherit"],function(t){"use strict";function i(t,i){i=_.extend({tandemSet:{}},i);var n=this;r.call(this),this.keys=[],Object.getOwnPropertyNames(t).forEach(function(e){n.addProperty(e,t[e],i.tandemSet[e])})}var n=t("AXON/Property"),e=t("AXON/DerivedProperty"),s=t("AXON/Multilink"),r=t("AXON/Events"),h=t("AXON/axon"),o=t("PHET_CORE/inherit"),a="Property";return h.register("PropertySet",i),o(r,i,{addProperty:function(t,i,e){this[t+a]=new n(i,{tandem:e}),this.addGetterAndSetter(t),this.keys.push(t)},removeProperty:function(t){var i=this.keys.indexOf(t);-1!==i&&this.keys.splice(i,1),this[t+a].dispose(),delete this[t+a],delete this[t]},addGetterAndSetter:function(t){var i=this[t+a];Object.defineProperty(this,t,{get:function(){return i.get()},set:function(t){i.set(t)},configurable:!0,enumerable:!0})},addGetter:function(t){var i=this[t+a];Object.defineProperty(this,t,{get:function(){return i.get()},configurable:!0,enumerable:!0})},reset:function(){var t=this;this.keys.forEach(function(i){t[i+a].reset()})},toDerivedProperty:function(t,i,n){return new e(this.getProperties(t),i,{tandem:n})},addDerivedProperty:function(t,i,n,e){this[t+a]=this.toDerivedProperty(i,n,e),this.addGetter(t)},getProperties:function(t){var i=this;return t.map(function(t){var n=t+a;return i[n]})},setValues:function(t){var i=this;Object.getOwnPropertyNames(t).forEach(function(n){i[n+a].set(t[n])})},getValues:function(){for(var t={},i=0;i<this.keys.length;i++){var n=this.keys[i];t[n]=this.property(n).value}return t},link:function(t,i){this[t+a].link(i)},unlink:function(t,i){this[t+a].unlink(i)},linkAttribute:function(t,i,n){return this.property(t).linkAttribute(i,n)},unlinkAttribute:function(t,i){this.property(t).unlink(i)},multilink:function(t,i){return new s(this.getProperties(t),i,!1)},lazyMultilink:function(t,i){return new s(this.getProperties(t),i,!0)},unmultilink:function(t){t.dispose()},toString:function(){for(var t="PropertySet{",i=this,n=0;n<this.keys.length;n++){var e=this.keys[n];t=t+e+":"+i[e].toString(),n<this.keys.length-1&&(t+=",")}return t+"}"},unlinkAll:function(){var t=this;this.keys.forEach(function(i){t[i+a].unlinkAll()})},property:function(t){return this[t+a]},dispose:function(){for(var t=0;t<this.keys.length;t++)this[this.keys[t]+a].dispose()}})}),n("AXON/main",["AXON/axon","AXON/Property","AXON/DerivedProperty","AXON/Emitter","AXON/Events","AXON/ObservableArray","AXON/PropertySet","AXON/Multilink"],function(t){"use strict";return t}),i.config({deps:["main","PHET_CORE/main","AXON/main"],paths:{DOT:".",PHET_CORE:"../../phet-core/js",AXON:"../../axon/js"},urlArgs:Date.now()}),n("config",function(){}),window.dot=i("main"),window.axon=i("AXON/main"),window.phetCore=i("PHET_CORE/main")}();
//# sourceMappingURL=dot.min.js.map