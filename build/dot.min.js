!function(){if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");!function(){"use strict";window.assertions=window.assertions||{},window.assertions.assertFunction=window.assertions.assertFunction||function(t,i){if(!t){if(window.navigator&&"Microsoft Internet Explorer"===window.navigator.appName)try{throw new Error}catch(t){i=i+", stack=\n"+t.stack}var e=i?"Assertion failed: "+i:"Assertion failed";throw console&&console.log&&console.log(e),new Error(e)}},window.assert=window.assert||null,window.assertSlow=window.assertSlow||null,window.assertions.enableAssert=function(){window.assert=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assert")},window.assertions.disableAssert=function(){window.assert=null,window.console&&window.console.log&&window.console.log("disabling assert")},window.assertions.enableAssertSlow=function(){window.assertSlow=window.assertions.assertFunction,window.console&&window.console.log&&window.console.log("enabling assertSlow")},window.assertions.disableAssertSlow=function(){window.assertSlow=null,window.console&&window.console.log&&window.console.log("disabling assertSlow")}}(),function(){"use strict";window.phetio=window.phetio||{};window.phetio.PhetioIDUtils={append:function(t,i){return t+"."+i},getComponentName:function(t){var i=t.lastIndexOf(".");return-1===i?t:t.substring(i+1,t.length)},getParentID:function(t){var i=t.lastIndexOf(".");return t.substring(0,i)},getDOMElementID:function(t){return"phetioID:"+t},SEPARATOR:"."}}();var t,i,e;!function(n){function r(t,i){return y.call(t,i)}function s(t,i){var e,n,r,s,h,o,a,u,m,c,f,l=i&&i.split("/"),d=x.map,p=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(i){for(l=l.slice(0,l.length-1),h=(t=t.split("/")).length-1,x.nodeIdCompat&&T.test(t[h])&&(t[h]=t[h].replace(T,"")),t=l.concat(t),m=0;m<t.length;m+=1)if("."===(f=t[m]))t.splice(m,1),m-=1;else if(".."===f){if(1===m&&(".."===t[2]||".."===t[0]))break;m>0&&(t.splice(m-1,2),m-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((l||p)&&d){for(m=(e=t.split("/")).length;m>0;m-=1){if(n=e.slice(0,m).join("/"),l)for(c=l.length;c>0;c-=1)if((r=d[l.slice(0,c).join("/")])&&(r=r[n])){s=r,o=m;break}if(s)break;!a&&p&&p[n]&&(a=p[n],u=m)}!s&&a&&(s=a,o=u),s&&(e.splice(0,o,s),t=e.join("/"))}return t}function h(t,i){return function(){return c.apply(n,v.call(arguments,0).concat([t,i]))}}function o(t){return function(i){d[t]=i}}function a(t){if(r(p,t)){var i=p[t];delete p[t],g[t]=!0,m.apply(n,i)}if(!r(d,t)&&!r(g,t))throw new Error("No "+t);return d[t]}function u(t){var i,e=t?t.indexOf("!"):-1;return e>-1&&(i=t.substring(0,e),t=t.substring(e+1,t.length)),[i,t]}var m,c,f,l,d={},p={},x={},g={},y=Object.prototype.hasOwnProperty,v=[].slice,T=/\.js$/;f=function(t,i){var e,n=u(t),r=n[0];return t=n[1],r&&(e=a(r=s(r,i))),r?t=e&&e.normalize?e.normalize(t,function(t){return function(i){return s(i,t)}}(i)):s(t,i):(r=(n=u(t=s(t,i)))[0],t=n[1],r&&(e=a(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:e}},l={require:function(t){return h(t)},exports:function(t){var i=d[t];return void 0!==i?i:d[t]={}},module:function(t){return{id:t,uri:"",exports:d[t],config:function(t){return function(){return x&&x.config&&x.config[t]||{}}}(t)}}},m=function(t,i,e,s){var u,m,c,x,y,v,T=[],E=typeof e;if(s=s||t,"undefined"===E||"function"===E){for(i=!i.length&&e.length?["require","exports","module"]:i,y=0;y<i.length;y+=1)if(x=f(i[y],s),"require"===(m=x.f))T[y]=l.require(t);else if("exports"===m)T[y]=l.exports(t),v=!0;else if("module"===m)u=T[y]=l.module(t);else if(r(d,m)||r(p,m)||r(g,m))T[y]=a(m);else{if(!x.p)throw new Error(t+" missing "+m);x.p.load(x.n,h(s,!0),o(m),{}),T[y]=d[m]}c=e?e.apply(d[t],T):void 0,t&&(u&&u.exports!==n&&u.exports!==d[t]?d[t]=u.exports:c===n&&v||(d[t]=c))}else t&&(d[t]=e)},t=i=c=function(t,i,e,r,s){if("string"==typeof t)return l[t]?l[t](i):a(f(t,i).f);if(!t.splice){if((x=t).deps&&c(x.deps,x.callback),!i)return;i.splice?(t=i,i=e,e=null):t=n}return i=i||function(){},"function"==typeof e&&(e=r,r=s),r?m(n,t,i,e):setTimeout(function(){m(n,t,i,e)},4),c},c.config=function(t){return c(t)},t._defined=d,(e=function(t,i,e){i.splice||(e=i,i=[]),r(d,t)||r(p,t)||(p[t]=[t,i,e])}).amd={jQuery:!0}}(),e("almond",function(){}),e("PHET_CORE/Namespace",["require"],function(t){"use strict";function i(t){this.name=t,window.phet&&(window.phet[t]=this)}return i.prototype={constructor:i,register:function(t,i){if(t.indexOf(".")<0)this[t]=i;else{for(var e=t.split("."),n=this,r=0;r<e.length-1;r++)n=n[e[r]];var s=e[e.length-1];n[s]=i}return i}},i}),e("AXON/axon",["require","PHET_CORE/Namespace"],function(t){"use strict";return new(t("PHET_CORE/Namespace"))("axon")}),e("PHET_CORE/phetCore",["require","PHET_CORE/Namespace"],function(t){"use strict";var i=t("PHET_CORE/Namespace"),e=new i("phetCore");return e.register("Namespace",i),e}),e("PHET_CORE/extend",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var e in i)Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}),t}return t("PHET_CORE/phetCore").register("extend",i),i}),e("PHET_CORE/inherit",["require","PHET_CORE/extend","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i,n,r){function s(){}return s.prototype=t.prototype,i.prototype=e(new s,{constructor:i},n),e(i,r),i}var e=t("PHET_CORE/extend");return t("PHET_CORE/phetCore").register("inherit",i),i}),e("ifphetio",["require"],function(t){"use strict";var i={};return{load:function(e,n,r,s){if(s.isBuild){var h=n.toUrl(e);!1===/\.js$/.test(h)&&(h+=".js"),global.phet&&global.phet.chipper&&"phet-io"===global.phet.chipper.brand?(i[e]={content:global.phet.chipper.grunt.file.read(h),attach:t.attach},n([e],r)):r()}else{if("phet-io"===(window.phet&&window.phet.chipper&&window.phet.chipper.brand))n([e],r);else{var o=function(){};"PHET_IO/phetioEvents"===e&&(o.start=function(){},o.end=function(){}),r(o)}}},write:function(t,e,n){var r=null;global.phet&&global.phet.chipper&&"phet-io"===global.phet.chipper.brand?(r='define("'+e+'", function(){'+i[e].content+"});",n.asModule(e,r,i[e].content)):n(r="PHET_IO/phetioEvents"===e?'define("'+e+'", function(){return function(){ var f = function() {}; f.start = function() {}; f.end = function() {}; return f; };});':'define("'+e+'", function(){return function(){ return function(){}; };});')}}}),e("PHET_IO/assertInstanceOf",function(){return function(){return function(){}}}),e("PHET_IO/types/FunctionIO",function(){return function(){return function(){}}}),e("PHET_IO/types/ObjectIO",function(){return function(){return function(){}}}),e("PHET_IO/phetioInherit",function(){return function(){return function(){}}}),e("PHET_IO/types/VoidIO",function(){return function(){return function(){}}}),e("AXON/EmitterIO",["require","AXON/axon","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/FunctionIO","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function i(t){return s(r,"EmitterIO",function(t,i){r.call(this,t,i)},{addListener:{returnType:h,parameterTypes:[n(h,t)],implementation:function(t){this.instance.addListener(t)},documentation:"Add a listener which will be called when the emitter emits."},emit:{returnType:h,parameterTypes:[],implementation:function(){this.instance.emit()},documentation:"Emit a single event with no arguments to all added listeners.",canBeInvokedForReadOnlyInstances:!1}},{documentation:"Emitters indicate when events have occurred, with optional arguments describing the event",events:["emitted"],parameterTypes:t})}var e=t("AXON/axon"),n=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/FunctionIO")),r=t("ifphetio!PHET_IO/types/ObjectIO"),s=t("ifphetio!PHET_IO/phetioInherit"),h=t("ifphetio!PHET_IO/types/VoidIO");return e.register("EmitterIO",i),i}),e("TANDEM/tandemNamespace",["require","PHET_CORE/Namespace"],function(t){"use strict";return new(t("PHET_CORE/Namespace"))("tandem")}),e("PHET_CORE/toCamelCase",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return t.toLowerCase().replace(/-(.)/g,function(t,i){return i.toUpperCase()})}return t("PHET_CORE/phetCore").register("toCamelCase",i),i}),e("text",["module"],function(t){"use strict";var e,n,r,s,h,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,u=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,m="undefined"!=typeof location&&location.href,c=m&&location.protocol&&location.protocol.replace(/\:/,""),f=m&&location.hostname,l=m&&(location.port||void 0),d={},p=t.config&&t.config()||{};return e={version:"2.0.12",strip:function(t){if(t){var i=(t=t.replace(a,"")).match(u);i&&(t=i[1])}else t="";return t},jsEscape:function(t){return t.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var t,i,e;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(i=0;i<3;i+=1){e=o[i];try{t=new ActiveXObject(e)}catch(t){}if(t){o=[e];break}}return t},parseName:function(t){var i,e,n,r=!1,s=t.indexOf("."),h=0===t.indexOf("./")||0===t.indexOf("../");return-1!==s&&(!h||s>1)?(i=t.substring(0,s),e=t.substring(s+1,t.length)):i=t,n=e||i,-1!==(s=n.indexOf("!"))&&(r="strip"===n.substring(s+1),n=n.substring(0,s),e?e=n:i=n),{moduleName:i,ext:e,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(t,i,n,r){var s,h,o,a=e.xdRegExp.exec(t);return!a||(s=a[2],h=a[3],h=h.split(":"),o=h[1],h=h[0],!(s&&s!==i||h&&h.toLowerCase()!==n.toLowerCase()||(o||h)&&o!==r))},finishLoad:function(t,i,n,r){n=i?e.strip(n):n,p.isBuild&&(d[t]=n),r(n)},load:function(t,i,n,r){if(r&&r.isBuild&&!r.inlineText)n();else{p.isBuild=r&&r.isBuild;var s=e.parseName(t),h=s.moduleName+(s.ext?"."+s.ext:""),o=i.toUrl(h),a=p.useXhr||e.useXhr;0!==o.indexOf("empty:")?!m||a(o,c,f,l)?e.get(o,function(i){e.finishLoad(t,s.strip,i,n)},function(t){n.error&&n.error(t)}):i([h],function(t){e.finishLoad(s.moduleName+"."+s.ext,s.strip,t,n)}):n()}},write:function(t,i,n,r){if(d.hasOwnProperty(i)){var s=e.jsEscape(d[i]);n.asModule(t+"!"+i,"define(function () { return '"+s+"';});\n")}},writeFile:function(t,i,n,r,s){var h=e.parseName(i),o=h.ext?"."+h.ext:"",a=h.moduleName+o,u=n.toUrl(h.moduleName+o)+".js";e.load(a,n,function(i){var n=function(t){return r(u,t)};n.asModule=function(t,i){return r.asModule(t,u,i)},e.write(t,a,n,s)},s)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=i.nodeRequire("fs"),e.get=function(t,i,e){try{var r=n.readFileSync(t,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),i(r)}catch(t){e&&e(t)}}):"xhr"===p.env||!p.env&&e.createXhr()?e.get=function(t,i,n,r){var s,h=e.createXhr();if(h.open("GET",t,!0),r)for(s in r)r.hasOwnProperty(s)&&h.setRequestHeader(s.toLowerCase(),r[s]);p.onXhr&&p.onXhr(h,t),h.onreadystatechange=function(e){var r,s;4===h.readyState&&((r=h.status||0)>399&&r<600?((s=new Error(t+" HTTP status: "+r)).xhr=h,n&&n(s)):i(h.responseText),p.onXhrComplete&&p.onXhrComplete(h,t))},h.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(t,i){var e,n,r=new java.io.File(t),s=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),"utf-8")),o="";try{for(e=new java.lang.StringBuffer,(n=h.readLine())&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&e.append(n);null!==(n=h.readLine());)e.append(s),e.append(n);o=String(e.toString())}finally{h.close()}i(o)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,s=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),h="@mozilla.org/windows-registry-key;1"in r,e.get=function(t,i){var e,n,o,a={};h&&(t=t.replace(/\//g,"\\")),o=new FileUtils.File(t);try{(e=r["@mozilla.org/network/file-input-stream;1"].createInstance(s.nsIFileInputStream)).init(o,1,0,!1),(n=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(s.nsIConverterInputStream)).init(e,"utf-8",e.available(),s.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),n.readString(e.available(),a),n.close(),e.close(),i(a.value)}catch(t){throw new Error((o&&o.path||"")+": "+t)}}),e}),e("text!REPOSITORY/package.json",[],function(){return'{\n  "name": "dot",\n  "version": "0.0.0",\n  "license": "MIT",\n  "repository": {\n    "type": "git",\n    "url": "https://github.com/phetsims/dot.git"\n  },\n  "devDependencies": {\n    "grunt": "~1.0.0",\n    "esprima": "~2.7.0",\n    "js-beautify": "~1.5.10"\n  },\n  "phet": {\n    "generatedUnitTests": true,\n    "requirejsNamespace": "DOT",\n    "buildStandalone": true,\n    "isJSOnly": true,\n    "requiresLodash": true,\n    "assignGlobals": {\n      "dot": "DOT/main",\n      "axon": "AXON/main",\n      "phetCore": "PHET_CORE/main"\n    }\n  }\n}\n'}),e("TANDEM/Tandem",["require","PHET_CORE/inherit","TANDEM/tandemNamespace","PHET_CORE/toCamelCase","text!REPOSITORY/package.json"],function(t){"use strict";function i(t,i){i=_.extend({enabled:!0,supplied:!0,required:!0},i),this.phetioID=void 0!==t?t:"",this.required=i.required,this.supplied=i.supplied,this.enabled=i.enabled}function e(t){i.call(this,t),this.groupElementIndex=0}var n=t("PHET_CORE/inherit"),r=t("TANDEM/tandemNamespace"),s=t("PHET_CORE/toCamelCase"),h=t("text!REPOSITORY/package.json"),o=JSON.parse(h),a=!(!window.phet||!window.phet.phetio),u=[],m=!1,c=[],f=0;return r.register("Tandem",i),n(Object,i,{addInstance:function(t){if(a&&this.enabled){if(phet.phetio.queryParameters.phetioValidateTandems,phet.phetio.queryParameters.printMissingTandems&&this.required&&!this.supplied&&console.log("Required Tandem not supplied.\nthis.phetioID = "+this.phetioID+"\nStack trace: "+(new Error).stack),!this.required&&!this.supplied){if(phet.phetio.queryParameters.printMissingTandems){var i=(new Error).stack;-1===i.indexOf("PhetFont")&&console.log("Optional Tandem not supplied.\nthis.phetioID = "+this.phetioID+"\nStack trace: "+i)}return}if(m)for(var e=0;e<u.length;e++)u[e].addInstance(t);else c.push(t)}},removeInstance:function(t){if((this.required||this.supplied)&&a&&this.enabled)for(var i=0;i<u.length;i++)u[i].removeInstance(t)},createTandem:function(t,e){var n=this.phetioID.length>0?phetio.PhetioIDUtils.append(this.phetioID,t):t;return e=_.extend({enabled:this.enabled,supplied:this.supplied,required:this.required},e),new i(n,e)},createGroupTandem:function(t){return new e(phetio.PhetioIDUtils.append(this.phetioID,t))},get tail(){return phetio.PhetioIDUtils.getComponentName(this.phetioID)},get parentTandem(){return new i(phetio.PhetioIDUtils.getParentID(this.phetioID),{required:this.required,supplied:this.supplied,enabled:this.enabled})},isSuppliedAndEnabled:function(){return this.supplied&&a}},{addInstanceListener:function(t){u.push(t)},launch:function(){for(m=!0;c.length>0;){var t=c.shift();t.tandem.addInstance(t)}},disallowTandem:function(t){i.validationEnabled()},indicateUninstrumentedCode:function(){if(a&&(phet.phetio.queryParameters.phetioValidateTandems,phet.phetio.queryParameters.printMissingTandems)){var t=(new Error).stack;console.log("Uninstrumented Code! Tandem not supplied: "+f+++".\nStack trace: "+t)}},validationEnabled:function(){return a&&phet.phetio.queryParameters.phetioValidateTandems}}),i.rootTandem=new i(s(o.name)),i.optional=i.rootTandem.createTandem("optionalTandem",{required:!1,supplied:!1}),i.required=i.rootTandem.createTandem("requiredTandem",{required:!0,supplied:!1}),r.register("Tandem.GroupTandem",e),n(i,e,{createNextTandem:function(){return new i(this.phetioID+"_"+this.groupElementIndex++)}}),i}),e("PHET_IO/phetioEvents",function(){return function(){var t=function(){};return t.start=function(){},t.end=function(){},t}}),e("TANDEM/PhetioObject",["require","PHET_CORE/inherit","TANDEM/tandemNamespace","TANDEM/Tandem","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetioEvents"],function(t){"use strict";function i(t){this.tandem=null,this.phetioType=null,this.phetioState=null,this.phetioReadOnly=null,this.phetioInstanceDocumentation=null,this.phetioWrapper=null,this.phetioObjectInitialized=!1,this.phetioMessageStack=[],this.phetioObjectDisposed=!1,this.phetioEventType=null,t&&this.initializePhetioObject({},t)}var e=t("PHET_CORE/inherit"),n=t("TANDEM/tandemNamespace"),r=t("TANDEM/Tandem"),s=t("ifphetio!PHET_IO/types/ObjectIO"),h=t("ifphetio!PHET_IO/phetioEvents"),o=!(!window.phet||!window.phet.phetio),a={tandem:r.optional,phetioType:s,phetioState:!0,phetioReadOnly:!1,phetioInstanceDocumentation:null,phetioEventType:"model"},u={highFrequencyEvent:!1},m=_.keys(a);return n.register("PhetioObject",i),e(Object,i,{initializePhetioObject:function(t,i){if(0!==_.intersection(_.keys(i),m).length){i=_.extend({},a,t,i),this.tandem=i.tandem,this.phetioType=i.phetioType,this.phetioState=i.phetioState,this.phetioReadOnly=i.phetioReadOnly,this.phetioEventType=i.phetioEventType,this.phetioInstanceDocumentation=i.phetioInstanceDocumentation,o&&this.tandem.enabled&&this.tandem.supplied&&(this.phetioWrapper=new this.phetioType(this,this.tandem.phetioID)),this.tandem.addInstance(this),this.phetioObjectInitialized=!0}},phetioStartEvent:function(t,i,e){var n=(e=e||u).phetioEventType||this.phetioEventType;e.phetioEventType&&delete e.phetioEventType,window.phet&&window.phet.phetio&&!window.phet.phetio.queryParameters.phetioEmitHighFrequencyEvents&&e.highFrequency?this.phetioMessageStack.push(-1):this.tandem.isSuppliedAndEnabled()&&this.phetioMessageStack.push(h.start(n,this,t,i))},phetioEndEvent:function(){var t=this.phetioMessageStack.pop();-1!==t&&this.tandem.isSuppliedAndEnabled()&&h.end(t)},dispose:function(){this.phetioObjectInitialized&&(this.tandem.removeInstance(this),this.phetioWrapper&&this.phetioWrapper.dispose&&this.phetioWrapper.dispose()),this.phetioObjectDisposed=!0}},{DEFAULT_OPTIONS:a})}),e("AXON/Emitter",["require","AXON/axon","AXON/EmitterIO","PHET_CORE/inherit","TANDEM/PhetioObject","TANDEM/Tandem"],function(t){"use strict";function i(t){t=_.extend({tandem:h.optional,phetioState:!1,phetioType:n([])},t),this.listeners=[],this.activeListenersStack=[],s.call(this,t)}var e=t("AXON/axon"),n=t("AXON/EmitterIO"),r=t("PHET_CORE/inherit"),s=t("TANDEM/PhetioObject"),h=t("TANDEM/Tandem");return e.register("Emitter",i),r(s,i,{dispose:function(){this.listeners.length=0,s.prototype.dispose.call(this)},addListener:function(t){this.defendListeners(),this.listeners.push(t)},removeListener:function(t){var i=this.listeners.indexOf(t);this.defendListeners(),this.listeners.splice(i,1)},removeAllListeners:function(){for(;this.listeners.length>0;)this.removeListener(this.listeners[0])},defendListeners:function(){for(var t=this.activeListenersStack.length-1;t>=0&&!this.activeListenersStack[t].defended;t--){var i=this.listeners.slice();i.defended=!0,this.activeListenersStack[t]=i}},emit:function(){this.phetioStartEvent("emitted"),this.activeListenersStack.push(this.listeners);for(var t=this.activeListenersStack.length-1,i=0;i<this.activeListenersStack[t].length;i++)this.activeListenersStack[t][i]();this.activeListenersStack.pop(),this.phetioEndEvent()},emit1:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("emitted",{args:[this.phetioType.parameterTypes[0].toStateObject(t)]}),this.activeListenersStack.push(this.listeners);for(var i=this.activeListenersStack.length-1,e=0;e<this.activeListenersStack[i].length;e++)this.activeListenersStack[i][e](t);this.activeListenersStack.pop(),this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},emit2:function(t,i){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("emitted",{args:[this.phetioType.parameterTypes[0].toStateObject(t),this.phetioType.parameterTypes[1].toStateObject(i)]}),this.activeListenersStack.push(this.listeners);for(var e=this.activeListenersStack.length-1,n=0;n<this.activeListenersStack[e].length;n++)this.activeListenersStack[e][n](t,i);this.activeListenersStack.pop(),this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},emit3:function(t,i,e){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("emitted",{args:[this.phetioType.parameterTypes[0].toStateObject(t),this.phetioType.parameterTypes[1].toStateObject(i),this.phetioType.parameterTypes[2].toStateObject(e)]}),this.activeListenersStack.push(this.listeners);for(var n=this.activeListenersStack.length-1,r=0;r<this.activeListenersStack[n].length;r++)this.activeListenersStack[n][r](t,i,e);this.activeListenersStack.pop(),this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},hasListener:function(t){return this.listeners.indexOf(t)>=0},hasListeners:function(){return this.listeners.length>0},getListenerCount:function(){return this.listeners.length}})}),e("AXON/Multilink",["require","AXON/axon","PHET_CORE/inherit"],function(t){"use strict";function i(t,i,e){this.dependencies=t,this.dependencyValues=t.map(function(t){return t.get()});var n=this;this.dependencyListeners=[],t.forEach(function(t,e){var r=function(t){n.dependencyValues[e]=t,i.apply(null,n.dependencyValues)};n.dependencyListeners.push(r),t.lazyLink(r)}),e||i.apply(null,this.dependencyValues)}var e=t("AXON/axon"),n=t("PHET_CORE/inherit");return e.register("Multilink",i),n(Object,i,{dispose:function(){for(var t=0;t<this.dependencies.length;t++)this.dependencies[t].unlink(this.dependencyListeners[t]);this.dependencies=null,this.dependencyListeners=null,this.dependencyValues=null}})}),e("AXON/units",["require","AXON/axon"],function(t){"use strict";var i={values:["amperes","milliamperes","becquerels","centimeters","centimeters-squared","coulombs","degrees Celsius","farads","kilograms","grams","gray","henrys","henries","hertz","joules","katals","kelvins","liters","liters/second","lumens","lux","meters","meters/second","meters/second/second","moles","moles/liter","nanometers","newtons","newtons/meters","newtons-second/meters","ohms","ohm-centimeters","pascals","percent","radians","radians/second","seconds","siemens","sieverts","steradians","tesla","view-coordinates/second","volts","watts","webers","cm","nm"],isValidUnits:function(t){return _.includes(i.values,t)}};return t("AXON/axon").register("units",i),i}),e("AXON/Property",["require","AXON/axon","AXON/Emitter","PHET_CORE/inherit","AXON/Multilink","AXON/units","TANDEM/PhetioObject","TANDEM/Tandem"],function(t){"use strict";function i(t,i){var e=this;i=_.extend({tandem:o.optional,valueType:null,validValues:null,isValidValue:null,useDeepEquality:!1,highFrequency:!1,units:null,reentrant:!1},i),h.call(this,i),this.units=i.units,this.useDeepEquality=i.useDeepEquality,this.assertPropertyValidateValue=!1,this.assertPropertyValidateValue&&i.validValues&&i.validValues.forEach(function(t){e.assertPropertyValidateValue(t)}),this.assertPropertyValidateValue&&this.assertPropertyValidateValue(t),o.validationEnabled()&&this.tandem.isSuppliedAndEnabled()&&!1&&(!1)(!!i.phetioType,"phetioType passed to Property must be specified. Tandem.phetioID: "+this.tandem.phetioID),o.validationEnabled()&&this.tandem.isSuppliedAndEnabled()&&!1&&(!1)(!!i.phetioType.elementType,"phetioType.elementType must be specified. Tandem.phetioID: "+this.tandem.phetioID),this._value=t,this._initialValue=t,this.validValues=i.validValues,this.changedEmitter=new n,this.notifying=!1,this.reentrant=i.reentrant,this.isDisposed=!1,this.changeEventOptions={highFrequency:i.highFrequency}}var e=t("AXON/axon"),n=t("AXON/Emitter"),r=t("PHET_CORE/inherit"),s=t("AXON/Multilink"),h=(t("AXON/units"),t("TANDEM/PhetioObject")),o=t("TANDEM/Tandem");return e.register("Property",i),r(h,i,{get:function(){return this._value},set:function(t){return this.assertPropertyValidateValue&&this.assertPropertyValidateValue(t),this.equalsValue(t)||this.setValueAndNotifyListeners(t),this},equalsValue:function(t){return this.areValuesEqual(t,this._value)},areValuesEqual:function(t,i){return this.useDeepEquality&&t&&i&&t.constructor===i.constructor?t.equals(i):t===i},get initialValue(){return this._initialValue},setValueAndNotifyListeners:function(t){var i=this.get();this._value=t,this._notifyListeners(i)},_notifyListeners:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("changed",{oldValue:this.phetioType.elementType.toStateObject(t),newValue:this.phetioType.elementType.toStateObject(this.get()),units:this.phetioType&&this.phetioType.units},this.changeEventOptions),this.notifying=!0,this.changedEmitter.emit2(this.get(),t),this.notifying=!1,this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},notifyListenersStatic:function(){this.changedEmitter.emit1(this.get())},reset:function(){this.set(this._initialValue)},get value(){return this.get()},set value(t){this.set(t)},link:function(t){this.changedEmitter.addListener(t),t(this.get(),null)},lazyLink:function(t){this.changedEmitter.addListener(t)},unlink:function(t){this.changedEmitter.removeListener(t)},unlinkAll:function(){this.changedEmitter.removeAllListeners()},linkAttribute:function(t,i){var e=function(e){t[i]=e};return this.link(e),e},unlinkAttribute:function(t){this.unlink(t)},toString:function(){return"Property{"+this.get()+"}"},valueOf:function(){return this.toString()},debug:function(t){var i=function(i){console.log(t,i)};return this.link(i),i},toggle:function(){this.value=!this.value},dispose:function(){this.isDisposed=!0,this.unlinkAll(),h.prototype.dispose.call(this)},hasListener:function(t){return this.changedEmitter.hasListener(t)},hasListeners:function(){return this.changedEmitter.hasListeners()}},{multilink:function(t,i){return new s(t,i,!1)},lazyMultilink:function(t,i){return new s(t,i,!0)},unmultilink:function(t){t.dispose()}})}),e("PHET_IO/phetio",function(){return function(){return function(){}}}),e("AXON/PropertyIO",["require","AXON/axon","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/FunctionIO","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetio","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function i(t){return h(r,"PropertyIO",function(t,i){r.call(this,t,i)},{getValue:{returnType:t,parameterTypes:[],implementation:function(){return this.instance.get()},documentation:"Gets the current value."},setValue:{returnType:o,parameterTypes:[t],implementation:function(t){this.instance.set(t)},documentation:"Sets the value of the property. If the value differs from the previous value, listeners are notified with the new value.",canBeInvokedForReadOnlyInstances:!1},link:{returnType:o,parameterTypes:[n(o,[t,t])],implementation:function(t){this.instance.link(t)},documentation:"Adds a listener which will be called when the value changes. On registration, the listener is also called with the current value. The listener takes two arguments, the new value and the previous value."},lazyLink:{returnType:o,parameterTypes:[n(o,[t,t])],implementation:function(t){this.instance.lazyLink(t)},documentation:'Adds a listener which will be called when the value changes. This method is like "link", but without the current-value callback on registration. The listener takes two arguments, the new value and the previous value.'},unlink:{returnType:o,parameterTypes:[n(o,[t])],implementation:function(t){this.instance.unlink(t)},documentation:"Removes a listener."}},{documentation:"Observable values that send out notifications when the value changes. This differs from the traditional listener pattern in that added listeners also receive a callback with the current value when the listeners are registered. This is a widely-used pattern in PhET-iO simulations.",methodOrder:["link","lazyLink"],elementType:t,parameterTypes:[t],events:["changed"],getAPI:function(){return{elementType:s.getAPIForType(t)}},toStateObject:function(i){var e={value:t.toStateObject(i.value)};return i.validValues&&(e.validValues=i.validValues.map(function(i){return t.toStateObject(i)})),i.units&&(e.units=i.units),e},fromStateObject:function(i){return{units:i.units,value:t.fromStateObject(i.value),validValues:i.validValues&&i.validValues.map(function(i){return t.fromStateObject(i)})}},setValue:function(t,i){t.units=i.units,t.set(i.value),t.validValues=i.validValues}})}var e=t("AXON/axon"),n=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/FunctionIO")),r=t("ifphetio!PHET_IO/types/ObjectIO"),s=t("ifphetio!PHET_IO/phetio"),h=t("ifphetio!PHET_IO/phetioInherit"),o=t("ifphetio!PHET_IO/types/VoidIO");return e.register("PropertyIO",i),i}),e("PHET_IO/types/BooleanIO",function(){return function(){return function(){}}}),e("AXON/BooleanProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/Property","AXON/PropertyIO","ifphetio!PHET_IO/types/BooleanIO"],function(t){"use strict";function i(t,i){(i=_.extend({phetioType:s(h)},i)).valueType="boolean",r.call(this,t,i)}var e=t("AXON/axon"),n=t("PHET_CORE/inherit"),r=t("AXON/Property"),s=t("AXON/PropertyIO"),h=t("ifphetio!PHET_IO/types/BooleanIO");return e.register("BooleanProperty",i),n(r,i)}),e("AXON/DerivedPropertyIO",["require","AXON/axon","AXON/PropertyIO","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function i(t){var e=new n(t),h=function(t,i){e.call(this,t,i)};return r(e,"DerivedPropertyIO",h,{setValue:{returnType:s,parameterTypes:[t],implementation:function(t){return this.instance.set(t)},documentation:"Errors out when you try to set a derived property.",canBeInvokedForReadOnlyInstances:!1}},{documentation:"Like PropertyIO, but not settable.  Instead it is derived from other DerivedPropertyIO or PropertyIO instances",parameterTypes:[t],elementType:t}),h.outerType=i,h}var e=t("AXON/axon"),n=t("AXON/PropertyIO"),r=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/phetioInherit")),s=t("ifphetio!PHET_IO/types/VoidIO");return e.register("DerivedPropertyIO",i),i}),e("AXON/DerivedProperty",["require","AXON/axon","AXON/DerivedPropertyIO","PHET_CORE/inherit","AXON/Property","TANDEM/Tandem"],function(t){"use strict";function i(t,i,e){(e=_.extend({tandem:a.optional,phetioType:null,phetioReadOnly:!0},e)).tandem.isSuppliedAndEnabled(),this.dependencies=t;var n=i.apply(null,t.map(function(t){return t.get()}));o.call(this,n,e);var r=this;this.dependencyListeners=[];for(var s=0;s<t.length;s++){!function(e){var n=function(){o.prototype.set.call(r,i.apply(null,t.map(function(t){return t.get()})))};r.dependencyListeners.push(n),e.lazyLink(n)}(t[s])}}function e(t,i){return t===i}function n(t,i){return t&&i.value}function r(t,i){return t||i.value}var s=t("AXON/axon"),h=(t("AXON/DerivedPropertyIO"),t("PHET_CORE/inherit")),o=t("AXON/Property"),a=t("TANDEM/Tandem");return s.register("DerivedProperty",i),h(o,i,{dispose:function(){for(var t=0;t<this.dependencies.length;t++){this.dependencies[t].unlink(this.dependencyListeners[t])}this.dependencies=null,this.dependencyListeners=null,o.prototype.dispose.call(this)},set:function(t){throw new Error("Cannot set values directly to a DerivedProperty, tried to set: "+t)},set value(t){throw new Error("Cannot es5-set values directly to a DerivedProperty, tried to set: "+t)},reset:function(){throw new Error("Cannot reset a DerivedProperty directly")},get value(){return o.prototype.get.call(this)}},{valueEquals:function(t,n,r){return new i([t,n],e,r)},and:function(t,e){return new i(t,_.reduce.bind(null,t,n,!0),e)},or:function(t,e){return new i(t,_.reduce.bind(null,t,r,!1),e)}})}),e("AXON/DynamicProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/Property"],function(t){"use strict";function i(t,i){i=_.extend({bidirectional:!1,defaultValue:null,derive:_.identity,map:_.identity,inverseMap:_.identity},i),this.isExternallyChanging=!1,this.valuePropertyProperty=t,this.bidirectional=i.bidirectional,this.defaultValue=i.defaultValue,this.derive="string"==typeof i.derive?_.property(i.derive):i.derive,this.map="string"==typeof i.map?_.property(i.map):i.map,this.inverseMap="string"==typeof i.inverseMap?_.property(i.inverseMap):i.inverseMap;var e;e=null===this.valuePropertyProperty.value?this.map(this.defaultValue):this.map(this.derive(this.valuePropertyProperty.value).value),r.call(this,e,i),this.propertyPropertyListener=this.onPropertyPropertyChange.bind(this),this.propertyListener=this.onPropertyChange.bind(this),t.link(this.propertyListener),i.bidirectional&&this.lazyLink(this.onSelfChange.bind(this))}var e=t("AXON/axon"),n=t("PHET_CORE/inherit"),r=t("AXON/Property");return e.register("DynamicProperty",i),n(r,i,{onPropertyPropertyChange:function(t){r.prototype.set.call(this,this.map(t))},onPropertyChange:function(t,i){i&&this.derive(i).unlink(this.propertyPropertyListener),t?this.derive(t).link(this.propertyPropertyListener):this.onPropertyPropertyChange(this.defaultValue)},onSelfChange:function(t){null!==this.valuePropertyProperty.value&&(this.derive(this.valuePropertyProperty.value).value=this.inverseMap(t))},dispose:function(){this.valuePropertyProperty.unlink(this.propertyListener),null!==this.valuePropertyProperty.value&&this.derive(this.valuePropertyProperty.value).unlink(this.propertyPropertyListener),r.prototype.dispose.call(this)},reset:function(){null!==this.valuePropertyProperty.value&&this.derive(this.valuePropertyProperty.value).reset()},set:function(t){this.isExternallyChanging=!0,r.prototype.set.call(this,t),this.isExternallyChanging=!1}})}),e("PHET_CORE/cleanArray",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){if(t){for(;t.length;)t.pop();return t}return[]}return t("PHET_CORE/phetCore").register("cleanArray",i),i}),e("AXON/Events",["require","AXON/axon","PHET_CORE/cleanArray"],function(t){"use strict";function i(){this._eventListeners={},this._staticEventListeners={}}var e=t("AXON/axon"),n=t("PHET_CORE/cleanArray");return e.register("Events",i),i.prototype={dispose:function(){},on:function(t,i){this._eventListeners[t]=this._eventListeners[t]||[],this._eventListeners[t].push(i)},onStatic:function(t,i){this._staticEventListeners[t]=this._staticEventListeners[t]||[],this._staticEventListeners[t].push(i)},off:function(t,i){var e=-1;return this._eventListeners[t]&&-1!==(e=this._eventListeners[t].indexOf(i))&&this._eventListeners[t].splice(e,1),e},offStatic:function(t,i){var e=-1;return this._staticEventListeners[t]&&-1!==(e=this._staticEventListeners[t].indexOf(i))&&this._staticEventListeners[t].splice(e,1),e},hasListener:function(t,i){var e=this._eventListeners[t];return!!e&&e.indexOf(i)>=0},hasStaticListener:function(t,i){var e=this._staticEventListeners[t];return!!e&&e.indexOf(i)>=0},removeAllEventListeners:function(){var t;for(t in this._eventListeners)n(this._eventListeners[t]);for(t in this._staticEventListeners)n(this._staticEventListeners[t])},trigger:function(t){var i,e=this._eventListeners[t],n=this._staticEventListeners[t],r=e?e.length:0,s=n?n.length:0,h=1===arguments.length;!h&&(r>0||s>0)&&(i=Array.prototype.slice.call(arguments,1)),r>0&&(e=e.slice());var o;for(o=0;o<r;o++){var a=e[o];h?a():a.apply(this,i)}for(o=0;o<s;o++){var u=n[o];h?u(arguments):u.apply(this,i)}},trigger0:function(t){var i=this._eventListeners[t],e=this._staticEventListeners[t],n=i?i.length:0,r=e?e.length:0;n>0&&(i=i.slice());var s;for(s=0;s<n;s++)i[s]();for(s=0;s<r;s++)e[s]()},trigger1:function(t,i){var e=this._eventListeners[t],n=this._staticEventListeners[t],r=e?e.length:0,s=n?n.length:0;r>0&&(e=e.slice());var h;for(h=0;h<r;h++)e[h](i);for(h=0;h<s;h++)n[h](i)},trigger2:function(t,i,e){var n=this._eventListeners[t],r=this._staticEventListeners[t],s=n?n.length:0,h=r?r.length:0;s>0&&(n=n.slice());var o;for(o=0;o<s;o++)n[o](i,e);for(o=0;o<h;o++)r[o](i,e)}},i}),e("PHET_IO/types/NumberIO",function(){return function(){return function(){}}}),e("AXON/NumberPropertyIO",["require","AXON/axon","AXON/PropertyIO","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/NumberIO","ifphetio!PHET_IO/phetioInherit"],function(t){"use strict";function i(t,i){o.call(this,t,i)}var e=t("AXON/axon"),n=t("AXON/PropertyIO"),r=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/NumberIO")),s=t("ifphetio!PHET_IO/phetioInherit"),h=r,o=n(h),a=["FloatingPoint","Integer"];return e.register("NumberPropertyIO",i),s(o,"NumberPropertyIO",i,{},{elementType:r,getAPI:function(){return{elementType:phet.phetIo.phetio.getAPIForType(h)}},toStateObject:function(t){var i=o.toStateObject(t);return t.numberType&&(i.numberType=t.numberType),t.range&&(i.range=t.range),i},fromStateObject:function(t){var i=o.fromStateObject(t);return i.numberType=t.numberType,i.range=t.range,i},setValue:function(t,i){o.setValue(t,i),t.range=i.range,t.numberType=i.numberType},documentation:"Extends PropertyIO to add values for the numeric range ( min, max ) and numberType ( '"+a.join("' | '")+"' )"}),i.VALID_NUMBER_TYPES=a,i}),e("AXON/NumberProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/NumberPropertyIO","AXON/Property"],function(t){"use strict";function i(t,i){(i=_.extend({numberType:"FloatingPoint",range:null,phetioType:r},i)).range&&!1&&(!1)(function(t){return"object"==typeof t&&t.hasOwnProperty("min")&&t.hasOwnProperty("max")}(i.range),"invalid range: "+i.range),this.numberType=i.numberType,this.range=i.range,i.valueType="number",this.assertNumberPropertyValidateValue=!1,i.validValues&&this.assertNumberPropertyValidateValue&&i.validValues.forEach(this.assertNumberPropertyValidateValue),this.assertNumberPropertyValidateValue&&this.assertNumberPropertyValidateValue(t),s.call(this,t,i)}var e=t("AXON/axon"),n=t("PHET_CORE/inherit"),r=t("AXON/NumberPropertyIO"),s=t("AXON/Property");r.VALID_NUMBER_TYPES;return e.register("NumberProperty",i),n(s,i,{set:function(t){this.assertNumberPropertyValidateValue&&this.assertNumberPropertyValidateValue(t),s.prototype.set.call(this,t)}})}),e("AXON/ObservableArrayIO",["require","AXON/axon","ifphetio!PHET_IO/assertInstanceOf","ifphetio!PHET_IO/types/FunctionIO","ifphetio!PHET_IO/types/NumberIO","ifphetio!PHET_IO/types/ObjectIO","ifphetio!PHET_IO/phetio","ifphetio!PHET_IO/phetioInherit","ifphetio!PHET_IO/types/VoidIO"],function(t){"use strict";function i(t){return o(s,"ObservableArrayIO",function(t,i){s.call(this,t,i)},{addItemAddedListener:{returnType:a,parameterTypes:[n(a,[t])],implementation:function(t){this.instance.addItemAddedListener(t)},documentation:"Add a listener that is called when an item is added to the observable array."},addItemRemovedListener:{returnType:a,parameterTypes:[n(a,[t])],implementation:function(t){this.instance.addItemRemovedListener(t)},documentation:"Add a listener that is called when an item is removed from the observable array."},getLength:{returnType:r,parameterTypes:[],implementation:function(){return this.instance.length},documentation:"Get the number of elements in the observable array"}},{toStateObject:function(t){return t?{array:t.getArray().map(function(t){return t.phetioID})}:t},fromStateObject:function(t){var i=[];return t.array.forEach(function(t){i.push(h.getInstance(t))}),i},setValue:function(t,i){t.clear(),t.addAll(i)},documentation:"An array that sends notifications when its values have changed.",elementType:t,events:["itemAdded","itemRemoved"]})}var e=t("AXON/axon"),n=(t("ifphetio!PHET_IO/assertInstanceOf"),t("ifphetio!PHET_IO/types/FunctionIO")),r=t("ifphetio!PHET_IO/types/NumberIO"),s=t("ifphetio!PHET_IO/types/ObjectIO"),h=t("ifphetio!PHET_IO/phetio"),o=t("ifphetio!PHET_IO/phetioInherit"),a=t("ifphetio!PHET_IO/types/VoidIO");return e.register("ObservableArrayIO",i),i}),e("AXON/ObservableArray",["require","AXON/axon","PHET_CORE/inherit","AXON/NumberProperty","AXON/ObservableArrayIO","TANDEM/PhetioObject","TANDEM/Tandem","ifphetio!PHET_IO/types/ObjectIO"],function(t){"use strict";function i(t,i){t instanceof Object&&!Array.isArray(t)&&(i=t,t=null),i=_.extend({allowDuplicates:!1,phetioType:s(a),tandem:o.optional},i),this.allowDuplicates=i.allowDuplicates,this._array=t||[],this._addedListeners=[],this._removedListeners=[],this.lengthProperty=new r(this._array.length,{numberType:"Integer",tandem:i.tandem.createTandem("lengthProperty"),phetioReadOnly:!0}),this.initialArray=t?t.slice():[],h.call(this,i)}var e=t("AXON/axon"),n=t("PHET_CORE/inherit"),r=t("AXON/NumberProperty"),s=t("AXON/ObservableArrayIO"),h=t("TANDEM/PhetioObject"),o=t("TANDEM/Tandem"),a=t("ifphetio!PHET_IO/types/ObjectIO");return e.register("ObservableArray",i),n(h,i,{dispose:function(){this.lengthProperty.dispose(),h.prototype.dispose.call(this)},reset:function(){for(var t=0;t<this._array.length;t++)this._fireItemRemoved(this._array[t]);for(this._array=this.initialArray.slice(),t=0;t<this._array.length;t++)this._fireItemAdded(this._array[t])},get length(){return this._array.length},addItemAddedListener:function(t){this._addedListeners.push(t)},removeItemAddedListener:function(t){var i=this._addedListeners.indexOf(t);this._addedListeners.splice(i,1)},addItemRemovedListener:function(t){this._removedListeners.push(t)},removeItemRemovedListener:function(t){var i=this._removedListeners.indexOf(t);this._removedListeners.splice(i,1)},_fireItemAdded:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("itemAdded",this.phetioType.elementType.toStateObject&&this.phetioType.elementType.toStateObject(t));for(var i=this._addedListeners.slice(0),e=0;e<i.length;e++)i[e](t,this);this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},_fireItemRemoved:function(t){this.tandem.isSuppliedAndEnabled()&&this.phetioStartEvent("itemRemoved",this.phetioType.elementType.toStateObject&&this.phetioType.elementType.toStateObject(t));for(var i=this._removedListeners.slice(0),e=0;e<i.length;e++)i[e](t,this);this.tandem.isSuppliedAndEnabled()&&this.phetioEndEvent()},add:function(t){this.push(t)},addAll:function(t){for(var i=0;i<t.length;i++)this.add(t[i])},remove:function(t){var i=this._array.indexOf(t);-1!==i&&(this._array.splice(i,1),this.lengthProperty.set(this._array.length),this._fireItemRemoved(t))},removeAll:function(t){for(var i=0;i<t.length;i++)this.remove(t[i])},push:function(t){if(!this.allowDuplicates&&this.contains(t))throw new Error("duplicates are not allowed");this._array.push(t),this.lengthProperty.set(this._array.length),this._fireItemAdded(t)},pop:function(){var t=this._array.pop();return void 0!==t&&(this.lengthProperty.set(this._array.length),this._fireItemRemoved(t)),t},shift:function(){var t=this._array.shift();return void 0!==t&&(this.lengthProperty.set(this._array.length),this._fireItemRemoved(t)),t},contains:function(t){return-1!==this.indexOf(t)},get:function(t){return this._array[t]},indexOf:function(t){return this._array.indexOf(t)},clear:function(){for(;this.length>0;)this.pop()},forEach:function(t){this._array.slice().forEach(t)},map:function(t){return new i(this._array.map(t))},filter:function(t){return new i(this._array.filter(t))},count:function(t){for(var i=0,e=0;e<this._array.length;e++)t(this._array[e])&&i++;return i},find:function(t,i){return _.find(this._array,t,i)},some:function(t){return _.some(this._array,t)},reduce:function(t,i){for(var e=0;e<this._array.length;e++)t=i(t,this._array[e]);return t},getArray:function(){return this._array},splice:function(t,i,e,n,r){for(var s=this._array.splice.apply(this._array,arguments),h=Array.prototype.slice.call(arguments),o=0;o<s.length;o++)this._fireItemRemoved(s[o]);for(var a=2;a<h.length;a++)this._fireItemAdded(h[a]);return s},shuffle:function(t){var i=t.shuffle(this._array);this._array.length=0,Array.prototype.push.apply(this._array,i)}})}),e("PHET_IO/types/StringIO",function(){return function(){return function(){}}}),e("AXON/StringProperty",["require","AXON/axon","PHET_CORE/inherit","AXON/Property","AXON/PropertyIO","ifphetio!PHET_IO/types/StringIO"],function(t){"use strict";function i(t,i){(i=_.extend({phetioType:s(h)},i)).valueType="string",r.call(this,t,i)}var e=t("AXON/axon"),n=t("PHET_CORE/inherit"),r=t("AXON/Property"),s=t("AXON/PropertyIO"),h=t("ifphetio!PHET_IO/types/StringIO");return e.register("StringProperty",i),n(r,i)}),e("AXON/main",["AXON/axon","AXON/BooleanProperty","AXON/DerivedProperty","AXON/DynamicProperty","AXON/Emitter","AXON/Events","AXON/Multilink","AXON/ObservableArray","AXON/Property","AXON/StringProperty","AXON/NumberProperty"],function(t){"use strict";return t}),e("DOT/dot",["require","PHET_CORE/Namespace"],function(t){"use strict";var i=new(t("PHET_CORE/Namespace"))("dot");return i.register("v2",function(t,e){return new i.Vector2(t,e)}),i.register("v3",function(t,e,n){return new i.Vector3(t,e,n)}),i.register("v4",function(t,e,n,r){return new i.Vector4(t,e,n,r)}),i.register("FastArray",window.Float64Array?window.Float64Array:window.Array),i}),e("PHET_CORE/Poolable",["require","PHET_CORE/extend","PHET_CORE/phetCore"],function(t){"use strict";var i=t("PHET_CORE/extend"),e={mixInto:function(t,e){e=_.extend({defaultArguments:[],initialize:t,maxSize:100,initialSize:0,useDefaultConstruction:!1},e);var n=[],r=Function.prototype.bind.bind(t,t),s=r.apply(null,e.defaultArguments),h=e.initialize,o=e.useDefaultConstruction;for(i(t,{pool:n,dirtyFromPool:function(){return n.length?n.pop():new s},createFromPool:function(){var t;return n.length?(t=n.pop(),h.apply(t,arguments)):o?(t=new s,h.apply(t,arguments)):t=new(r.apply(null,arguments)),t}}),i(t.prototype,{freeToPool:function(){n.length<e.maxSize&&n.push(this)}});n.length<e.initialSize;)n.push(new s)}};return t("PHET_CORE/phetCore").register("Poolable",e),e}),e("DOT/Util",["require","DOT/dot"],function(t){"use strict";var i,e,n,r=t("DOT/dot"),s=Number.MIN_VALUE,h=2*Math.PI,o={clamp:function(t,i,e){return t<i?i:t>e?e:t},moduloBetweenDown:function(t,i,e){var n=e-i,r=(t-i)%n;return r<0&&(r+=n),r+i},moduloBetweenUp:function(t,i,e){return-o.moduloBetweenDown(-t,-e,-i)},rangeInclusive:function(t,i){if(i<t)return[];for(var e=new Array(i-t+1),n=t;n<=i;n++)e[n-t]=n;return e},rangeExclusive:function(t,i){return o.rangeInclusive(t+1,i-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},mod:function(t,i){return t/i%1==0?0:t%i},gcd:function(t,i){return Math.abs(0===i?t:this.gcd(i,o.mod(t,i)))},lcm:function(t,i){return o.roundSymmetric(Math.abs(t*i)/o.gcd(t,i))},lineLineIntersection:function(t,i,e,n){if(t.equals(i)||e.equals(n))return null;var s=t.x-i.x,h=e.x-n.x,o=t.y-i.y,a=e.y-n.y,u=s*a-o*h;if(Math.abs(u)<1e-10)return null;var m=t.x*i.y-t.y*i.x,c=e.x*n.y-e.y*n.x;return new r.Vector2((m*h-s*c)/u,(m*a-o*c)/u)},circleCenterFromPoints:function(t,i,e){var n=new r.Vector2((t.x+i.x)/2,(t.y+i.y)/2),s=new r.Vector2((i.x+e.x)/2,(i.y+e.y)/2),h=new r.Vector2(n.x+(i.y-t.y),n.y-(i.x-t.x)),a=new r.Vector2(s.x+(e.y-i.y),s.y-(e.x-i.x));return o.lineLineIntersection(n,h,s,a)},pointInCircleFromPoints:function(t,i,e,n){var r=t.x-n.x,s=t.y-n.y,h=(t.x-n.x)*(t.x-n.x)+(t.y-n.y)*(t.y-n.y),o=i.x-n.x,a=i.y-n.y,u=(i.x-n.x)*(i.x-n.x)+(i.y-n.y)*(i.y-n.y),m=e.x-n.x,c=e.y-n.y,f=(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y);return r*a*f+s*u*m+h*o*c-h*a*m-s*o*f-r*u*c>0},sphereRayIntersection:function(t,i,e){e=void 0===e?1e-5:e;var n=new r.Vector3,s=i.direction,h=i.position,o=h.minus(n),a=s.dot(o),u=4*a*a-4*(o.magnitudeSquared()-t*t);if(u<e)return null;var m=s.dot(n)-s.dot(h),c=Math.sqrt(u)/2,f=m-c,l=m+c;if(l<e)return null;var d=i.pointAtDistance(l),p=d.minus(n).normalized();if(f<e)return{distance:l,hitPoint:d,normal:p.negated(),fromOutside:!1};var x=i.pointAtDistance(f);return{distance:f,hitPoint:x,normal:x.minus(n).normalized(),fromOutside:!0}},solveLinearRootsReal:function(t,i){return 0===t?0===i?null:[]:[-i/t]},solveQuadraticRootsReal:function(t,i,e){if(0===t||Math.abs(i/t)>1e7||Math.abs(e/t)>1e7)return o.solveLinearRootsReal(i,e);var n=i*i-4*t*e;if(n<0)return[];var r=Math.sqrt(n);return[(-i-r)/(2*t),(-i+r)/(2*t)]},solveCubicRootsReal:function(t,i,e,n){if(0===t)return o.solveQuadraticRootsReal(i,e,n);if(0===t||Math.abs(i/t)>1e7||Math.abs(e/t)>1e7||Math.abs(n/t)>1e7)return o.solveQuadraticRootsReal(i,e,n);if(0===n||Math.abs(t/n)>1e7||Math.abs(i/n)>1e7||Math.abs(e/n)>1e7)return[0].concat(o.solveQuadraticRootsReal(t,i,e));var r=(3*(e/=t)-(i/=t)*i)/9,s=(-27*(n/=t)+i*(9*e-i*i*2))/54,h=r*r*r+s*s,a=i/3;if(h>1e-7){var u=Math.sqrt(h);return[o.cubeRoot(s+u)+o.cubeRoot(s-u)-a]}if(0===h){var m=o.cubeRoot(s),c=-a-m;return[2*m-a,c,c]}var f=-r*r*r;f=Math.acos(s/Math.sqrt(f));var l=2*Math.sqrt(-r);return[-a+l*Math.cos(f/3),-a+l*Math.cos((f+2*Math.PI)/3),-a+l*Math.cos((f+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,i,e,n,r){return(n-e)/(i-t)*(r-t)+e},roundSymmetric:function(t){return(t<0?-1:1)*Math.round(Math.abs(t))},toFixed:function(t,i){var e=Math.pow(10,i);return(o.roundSymmetric(t*e)/e).toFixed(i)},toFixedNumber:function(t,i){return parseFloat(o.toFixed(t,i))},isInteger:function(t){return t%1==0},equalsEpsilon:function(t,i,e){return Math.abs(t-i)<=e},lineSegmentIntersection:function(t,i,e,n,s,h,o,a){var u=function(t,i,e,n,r,s){return(s-i)*(e-t)-(n-i)*(r-t)};if(u(t,i,s,h,o,a)*u(e,n,s,h,o,a)>0||u(s,h,t,i,e,n)*u(o,a,t,i,e,n)>0)return null;var m=(t-e)*(h-a)-(i-n)*(s-o);if(Math.abs(m)<1e-10)return null;if(t===s&&i===h||t===o&&i===a)return new r.Vector2(t,i);if(e===s&&n===h||e===o&&n===a)return new r.Vector2(e,n);var c=((t*n-i*e)*(s-o)-(t-e)*(s*a-h*o))/m,f=((t*n-i*e)*(h-a)-(i-n)*(s*a-h*o))/m;return new r.Vector2(c,f)},distToSegmentSquared:function(t,i,e){var n=i.distanceSquared(e);if(0===n)return t.distanceSquared(i);var s=((t.x-i.x)*(e.x-i.x)+(t.y-i.y)*(e.y-i.y))/n;return s<0?t.distanceSquared(i):s>1?t.distanceSquared(e):t.distanceSquared(new r.Vector2(i.x+s*(e.x-i.x),i.y+s*(e.y-i.y)))},distToSegment:function(t,i,e){return Math.sqrt(this.distToSegmentSquared(t,i,e))},arePointsCollinear:function(t,i,e,n){return void 0===n&&(n=0),o.triangleArea(t,i,e)<=n},triangleArea:function(t,i,e){return Math.abs(o.triangleAreaSigned(t,i,e))},triangleAreaSigned:function(t,i,e){return t.x*(i.y-e.y)+i.x*(e.y-t.y)+e.x*(t.y-i.y)},sign:function(t){return(t>0)-(t<0)||+t},cosh:function(t){return(Math.exp(t)+Math.exp(-t))/2},sinh:function(t){return(Math.exp(t)-Math.exp(-t))/2},log10:function(t){return Math.log(t)/Math.LN10},boxMullerTransform:function(t,r,o){if(!(i=!i))return n*r+t;var a,u;do{a=o.nextDouble(),u=o.nextDouble()}while(a<=s);return e=Math.sqrt(-2*Math.log(a))*Math.cos(h*u),n=Math.sqrt(-2*Math.log(a))*Math.sin(h*u),e*r+t},median:function(t){if(t.sort(function(t,i){return t-i}),0===t.length)return null;var i=Math.floor(t.length/2);return t.length%2?t[i]:(t[i-1]+t[i])/2},numberOfDecimalPlaces:function(t){for(var i=0,e=1;t*e%1!=0;)i++,e*=10;return i},roundToInterval:function(t,i){return o.toFixedNumber(o.roundSymmetric(t/i)*i,o.numberOfDecimalPlaces(i))}};return r.register("Util",o),r.clamp=o.clamp,r.moduloBetweenDown=o.moduloBetweenDown,r.moduloBetweenUp=o.moduloBetweenUp,r.rangeInclusive=o.rangeInclusive,r.rangeExclusive=o.rangeExclusive,r.toRadians=o.toRadians,r.toDegrees=o.toDegrees,r.lineLineIntersection=o.lineLineIntersection,r.lineSegmentIntersection=o.lineSegmentIntersection,r.sphereRayIntersection=o.sphereRayIntersection,r.solveQuadraticRootsReal=o.solveQuadraticRootsReal,r.solveCubicRootsReal=o.solveCubicRootsReal,r.cubeRoot=o.cubeRoot,r.linear=o.linear,r.boxMullerTransform=o.boxMullerTransform,o}),e("DOT/Vector2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){"use strict";function i(t,i){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0}var e=t("DOT/dot"),n=t("PHET_CORE/inherit"),r=t("PHET_CORE/Poolable");t("DOT/Util"),e.register("Vector2",i),n(Object,i,{isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXY:function(t,i){var e=this.x-t,n=this.y-i;return Math.sqrt(e*e+n*n)},distanceSquared:function(t){var i=this.x-t.x,e=this.y-t.y;return i*i+e*e},distanceSquaredXY:function(t,i){var e=this.x-t,n=this.y-i;return e*e+n*n},dot:function(t){return this.x*t.x+this.y*t.y},dotXY:function(t,i){return this.x*t+this.y*i},angle:function(){return Math.atan2(this.y,this.x)},angleBetween:function(t){var i=this.magnitude(),n=t.magnitude();return Math.acos(e.clamp((this.x*t.x+this.y*t.y)/(i*n),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,i){return i||(i=0),Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(t){return t?t.set(this):new i(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new i(this.x/t,this.y/t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new i(this.x*t,this.y*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new i(this.x*t.x,this.y*t.y)},plus:function(t){return new i(this.x+t.x,this.y+t.y)},plusXY:function(t,e){return new i(this.x+t,this.y+e)},plusScalar:function(t){return new i(this.x+t,this.y+t)},minus:function(t){return new i(this.x-t.x,this.y-t.y)},minusXY:function(t,e){return new i(this.x-t,this.y-e)},minusScalar:function(t){return new i(this.x-t,this.y-t)},dividedScalar:function(t){return new i(this.x/t,this.y/t)},negated:function(){return new i(-this.x,-this.y)},perpendicular:function(){return new i(this.y,-this.x)},rotated:function(t){var e=this.angle()+t,n=this.magnitude();return new i(n*Math.cos(e),n*Math.sin(e))},rotateAboutXY:function(t,i,e){var n=this.x-t,r=this.y-i,s=Math.cos(e),h=Math.sin(e);return this.x=t+n*s-r*h,this.y=i+n*h+r*s,this},rotateAboutPoint:function(t,i){return this.rotateAboutXY(t.x,t.y,i)},rotatedAboutXY:function(t,e,n){return new i(this.x,this.y).rotateAboutXY(t,e,n)},rotatedAboutPoint:function(t,i){return this.rotatedAboutXY(t.x,t.y,i)},blend:function(t,e){return new i(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e)},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new e.Vector3(this.x,this.y,0)},setXY:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},set:function(t){return this.setXY(t.x,t.y)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXY(this.x+t.x,this.y+t.y)},addXY:function(t,i){return this.setXY(this.x+t,this.y+i)},addScalar:function(t){return this.setXY(this.x+t,this.y+t)},subtract:function(t){return this.setXY(this.x-t.x,this.y-t.y)},subtractXY:function(t,i){return this.setXY(this.x-t,this.y-i)},subtractScalar:function(t){return this.setXY(this.x-t,this.y-t)},multiplyScalar:function(t){return this.setXY(this.x*t,this.y*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXY(this.x*t.x,this.y*t.y)},divideScalar:function(t){return this.setXY(this.x/t,this.y/t)},negate:function(){return this.setXY(-this.x,-this.y)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXY(e.Util.roundSymmetric(this.x),e.Util.roundSymmetric(this.y))},rotate:function(t){var i=this.angle()+t,e=this.magnitude();return this.setXY(e*Math.cos(i),e*Math.sin(i))},setPolar:function(t,i){return this.setXY(t*Math.cos(i),t*Math.sin(i))},toStateObject:function(){return{x:this.x,y:this.y}}},{createPolar:function(t,e){return(new i).setPolar(t,e)},fromStateObject:function(t){return new i(t.x,t.y)},getAngleBetweenVectors:function(t,i){var e=i.x-t.x,n=i.y-t.y;return Math.atan2(n,e)},getDistanceBetweenVectors:function(t,i){var e=i.x-t.x,n=i.y-t.y;return Math.sqrt(e*e+n*n)}}),r.mixInto(i,{initialize:i.prototype.setXY});var s=i.Immutable=function(t,e){i.call(this,t,e)};return n(i,s),s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},s.mutableOverrideHelper("setXY"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),i.ZERO=new i(0,0),i.X_UNIT=new i(1,0),i.Y_UNIT=new i(0,1),i}),e("DOT/Bounds2",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Vector2"],function(t){"use strict";function i(t,i,e,n){this.minX=t,this.minY=i,this.maxX=e,this.maxY=n}var e=t("DOT/dot"),n=t("PHET_CORE/inherit"),r=t("PHET_CORE/Poolable"),s=t("DOT/Vector2"),h=new e.Vector2;return e.register("Bounds2",i),n(Object,i,{isBounds:!0,dimension:2,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getLeftTop:function(){return new e.Vector2(this.minX,this.minY)},get leftTop(){return this.getLeftTop()},getCenterTop:function(){return new e.Vector2(this.getCenterX(),this.minY)},get centerTop(){return this.getCenterTop()},getRightTop:function(){return new e.Vector2(this.maxX,this.minY)},get rightTop(){return this.getRightTop()},getLeftCenter:function(){return new e.Vector2(this.minX,this.getCenterY())},get leftCenter(){return this.getLeftCenter()},getCenter:function(){return new e.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getRightCenter:function(){return new e.Vector2(this.maxX,this.getCenterY())},get rightCenter(){return this.getRightCenter()},getLeftBottom:function(){return new e.Vector2(this.minX,this.maxY)},get leftBottom(){return this.getLeftBottom()},getCenterBottom:function(){return new e.Vector2(this.getCenterX(),this.maxY)},get centerBottom(){return this.getCenterBottom()},getRightBottom:function(){return new e.Vector2(this.maxX,this.maxY)},get rightBottom(){return this.getRightBottom()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},closestPointTo:function(t){if(this.containsCoordinates(t.x,t.y))return t;var i=Math.max(Math.min(t.x,this.maxX),this.x),e=Math.max(Math.min(t.y,this.maxY),this.y);return new s(i,e)},containsCoordinates:function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){var i=Math.max(this.minX,t.minX),e=Math.max(this.minY,t.minY),n=Math.min(this.maxX,t.maxX),r=Math.min(this.maxY,t.maxY);return n-i>=0&&r-e>=0},minimumDistanceToPointSquared:function(t){var i,e=t.x<this.minX?this.minX:t.x>this.maxX?this.maxX:null,n=t.y<this.minY?this.minY:t.y>this.maxY?this.maxY:null;if(null===e&&null===n)return 0;if(null===e)return(i=n-t.y)*i;if(null===n)return(i=e-t.x)*i;var r=e-t.x,s=n-t.y;return r*r+s*s},maximumDistanceToPointSquared:function(t){var i=t.x>this.getCenterX()?this.minX:this.maxX,e=t.y>this.getCenterY()?this.minY:this.maxY;return i-=t.x,e-=t.y,i*i+e*e},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},equalsEpsilon:function(t,i){i=void 0!==i?i:0;var e=this.isFinite(),n=t.isFinite();return e&&n?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i:e===n&&(this===t||(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY))},copy:function(t){return t?t.set(this):new i(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new i(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new i(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,e){return new i(Math.min(this.minX,t),Math.min(this.minY,e),Math.max(this.maxX,t),Math.max(this.maxY,e))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withX:function(t){return this.copy().addX(t)},withY:function(t){return this.copy().addY(t)},withMinX:function(t){return new i(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new i(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new i(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new i(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new i(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new i(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new i(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilatedX:function(t){return new i(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilatedY:function(t){return new i(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilatedXY:function(t,e){return new i(this.minX-t,this.minY-e,this.maxX+t,this.maxY+e)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedXY:function(t,i){return this.dilatedXY(-t,-i)},withOffsets:function(t,e,n,r){return new i(this.minX-t,this.minY-e,this.maxX+n,this.maxY+r)},shiftedX:function(t){return new i(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new i(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,e){return new i(this.minX+t,this.minY+e,this.maxX+t,this.maxY+e)},blend:function(t,e){var n=1-e;return new i(n*this.minX+e*t.minX,n*this.minY+e*t.minY,n*this.maxX+e*t.maxX,n*this.maxY+e*t.maxY)},setMinMax:function(t,i,e,n){return this.minX=t,this.minY=i,this.maxX=e,this.maxY=n,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},addCoordinates:function(t,i){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},addPoint:function(t){return this.addCoordinates(t.x,t.y)},addX:function(t){return this.minX=Math.min(t,this.minX),this.maxX=Math.max(t,this.maxX),this},addY:function(t){return this.minY=Math.min(t,this.minY),this.maxY=Math.max(t,this.maxY),this},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transform:function(t){if(this.isEmpty())return this;if(t.isIdentity())return this;var i=this.minX,n=this.minY,r=this.maxX,s=this.maxY;return this.set(e.Bounds2.NOTHING),this.addPoint(t.multiplyVector2(h.setXY(i,n))),this.addPoint(t.multiplyVector2(h.setXY(i,s))),this.addPoint(t.multiplyVector2(h.setXY(r,n))),this.addPoint(t.multiplyVector2(h.setXY(r,s))),this},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.maxX+t,this.maxY)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.maxX,this.maxY+t)},dilateXY:function(t,i){return this.setMinMax(this.minX-t,this.minY-i,this.maxX+t,this.maxY+i)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeXY:function(t,i){return this.dilateXY(-t,-i)},offset:function(t,e,n,r){return new i(this.minX-t,this.minY-e,this.maxX+n,this.maxY+r)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.maxX,this.maxY+t)},shift:function(t,i){return this.setMinMax(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},getClosestPoint:function(t,i,n){return n?n.setXY(t,i):n=new e.Vector2(t,i),n.x<this.minX&&(n.x=this.minX),n.x>this.maxX&&(n.x=this.maxX),n.y<this.minY&&(n.y=this.minY),n.y>this.maxY&&(n.y=this.maxY),n}},{rect:function(t,e,n,r){return new i(t,e,t+n,e+r)},point:function(t,n){if(t instanceof e.Vector2){var r=t;return new i(r.x,r.y,r.x,r.y)}return new i(t,n,t,n)}}),r.mixInto(i,{initialize:i.prototype.setMinMax}),i.NOTHING=new i(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),i.EVERYTHING=new i(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i}),e("DOT/BinPacker",["require","DOT/Bounds2","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function i(t){this.rootBin=new n.BinPacker.Bin(t,null)}var e=t("DOT/Bounds2"),n=t("DOT/dot"),r=t("PHET_CORE/inherit");return n.register("BinPacker",i),r(Object,i,{allocate:function(t,i){var e=this.rootBin.findAvailableBin(t,i);if(e){var n=e.split(t,i);return n.use(),n}return null},deallocate:function(t){t.unuse()},toString:function(){function t(n){i+=e+n.toString()+"\n",e+="  ",_.each(n.children,t),e=e.substring(2)}var i="",e="";return t(this.rootBin),i}}),i.Bin=function(t,i){this.bounds=t,this.parent=i,this.isSplit=!1,this.isUsed=!1,this.children=[]},r(Object,i.Bin,{findAvailableBin:function(t,i){if(this.isUsed)return null;if(this.bounds.width<t||this.bounds.height<i)return null;if(this.isSplit){for(var e=0;e<this.children.length;e++){var n=this.children[e].findAvailableBin(t,i);if(n)return n}return null}return this},split:function(t,i){if(t===this.bounds.width&&i===this.bounds.height)return this;this.isSplit=!0;var r=this.bounds.minX+t,s=this.bounds.minY+i,h=new e(this.bounds.minX,this.bounds.minY,r,s),o=new e(r,this.bounds.minY,this.bounds.maxX,s),a=new e(this.bounds.minX,s,this.bounds.maxX,this.bounds.maxY),u=new n.BinPacker.Bin(h,this);return this.children.push(u),o.hasNonzeroArea()&&this.children.push(new n.BinPacker.Bin(o,this)),a.hasNonzeroArea()&&this.children.push(new n.BinPacker.Bin(a,this)),u},use:function(){this.isUsed=!0},unuse:function(){this.isUsed=!1,this.parent&&this.parent.attemptToCollapse()},attemptToCollapse:function(){for(var t=0;t<this.children.length;t++){var i=this.children[t];if(i.isSplit||i.isUsed)return}this.children=[],this.isSplit=!1,this.parent&&this.parent.attemptToCollapse()},toString:function(){return this.bounds.toString()+(this.isUsed?" used":"")}}),i}),e("DOT/Vector4",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util"],function(t){"use strict";function i(t,i,e,n){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==e?e:0,this.w=void 0!==n?n:1}var e=t("DOT/dot"),n=t("PHET_CORE/inherit"),r=t("PHET_CORE/Poolable");t("DOT/Util"),e.register("Vector4",i),n(Object,i,{isVector4:!0,dimension:4,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceXYZW:function(t,i,e,n){var r=this.x-t,s=this.y-i,h=this.z-e,o=this.w-n;return Math.sqrt(r*r+s*s+h*h+o*o)},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},distanceSquaredXYZW:function(t,i,e,n){var r=this.x-t,s=this.y-i,h=this.z-e,o=this.w-n;return r*r+s*s+h*h+o*o},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},dotXYZW:function(t,i,e,n){return this.x*t+this.y*i+this.z*e+this.w*n},angleBetween:function(t){return Math.acos(e.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},copy:function(t){return t?t.set(this):new i(this.x,this.y,this.z,this.w)},normalized:function(){var t=this.magnitude();return this.dividedScalar(t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new i(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusXYZW:function(t,e,n,r){return new i(this.x+t,this.y+e,this.z+n,this.w+r)},plusScalar:function(t){return new i(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusXYZW:function(t,e,n,r){return new i(this.x-t,this.y-e,this.z-n,this.w-r)},minusScalar:function(t){return new i(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new i(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new i(-this.x,-this.y,-this.z,-this.w)},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new e.Vector3(this.x,this.y,this.z)},setXYZW:function(t,i,e,n){return this.x=t,this.y=i,this.z=e,this.w=n,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},set:function(t){return this.setXYZW(t.x,t.y,t.z,t.w)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXYZW(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},addXYZW:function(t,i,e,n){return this.setXYZW(this.x+t,this.y+i,this.z+e,this.w+n)},addScalar:function(t){return this.setXYZW(this.x+t,this.y+t,this.z+t,this.w+t)},subtract:function(t){return this.setXYZW(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},subtractXYZW:function(t,i,e,n){return this.setXYZW(this.x-t,this.y-i,this.z-e,this.w-n)},subtractScalar:function(t){return this.setXYZW(this.x-t,this.y-t,this.z-t,this.w-t)},multiplyScalar:function(t){return this.setXYZW(this.x*t,this.y*t,this.z*t,this.w*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZW(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},divideScalar:function(t){return this.setXYZW(this.x/t,this.y/t,this.z/t,this.w/t)},negate:function(){return this.setXYZW(-this.x,-this.y,-this.z,-this.w)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXYZW(e.Util.roundSymmetric(this.x),e.Util.roundSymmetric(this.y),e.Util.roundSymmetric(this.z),e.Util.roundSymmetric(this.w))}}),r.mixInto(i,{initialize:i.prototype.setXYZW});var s=i.Immutable=function(t,i,e,n){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==e?e:0,this.w=void 0!==n?n:1};return n(i,s),s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},s.mutableOverrideHelper("setXYZW"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),s.mutableOverrideHelper("setZ"),s.mutableOverrideHelper("setW"),i.ZERO=new i(0,0,0,0),i.X_UNIT=new i(1,0,0,0),i.Y_UNIT=new i(0,1,0,0),i.Z_UNIT=new i(0,0,1,0),i.W_UNIT=new i(0,0,0,1),i}),e("DOT/Vector3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){"use strict";function i(t,i,e){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==e?e:0}var e=t("DOT/dot"),n=t("PHET_CORE/inherit"),r=t("PHET_CORE/Poolable");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),e.register("Vector3",i),n(Object,i,{isVector3:!0,dimension:3,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return Math.sqrt(this.distanceSquared(t))},distanceXYZ:function(t,i,e){var n=this.x-t,r=this.y-i,s=this.z-e;return Math.sqrt(n*n+r*r+s*s)},distanceSquared:function(t){var i=this.x-t.x,e=this.y-t.y,n=this.z-t.z;return i*i+e*e+n*n},distanceSquaredXYZ:function(t,i,e){var n=this.x-t,r=this.y-i,s=this.z-e;return n*n+r*r+s*s},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},dotXYZ:function(t,i,e){return this.x*t+this.y*i+this.z*e},angleBetween:function(t){return Math.acos(e.clamp(this.normalized().dot(t.normalized()),-1,1))},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,i){return i||(i=0),Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)<=i},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},copy:function(t){return t?t.set(this):new i(this.x,this.y,this.z)},cross:function(t){return new i(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return new i(this.x/t,this.y/t,this.z/t)},roundedSymmetric:function(){return this.copy().roundSymmetric()},withMagnitude:function(t){return this.copy().setMagnitude(t)},timesScalar:function(t){return new i(this.x*t,this.y*t,this.z*t)},times:function(t){return this.timesScalar(t)},componentTimes:function(t){return new i(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z)},plusXYZ:function(t,e,n){return new i(this.x+t,this.y+e,this.z+n)},plusScalar:function(t){return new i(this.x+t,this.y+t,this.z+t)},minus:function(t){return new i(this.x-t.x,this.y-t.y,this.z-t.z)},minusXYZ:function(t,e,n){return new i(this.x-t,this.y-e,this.z-n)},minusScalar:function(t){return new i(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new i(this.x/t,this.y/t,this.z/t)},negated:function(){return new i(-this.x,-this.y,-this.z)},blend:function(t,i){return this.plus(t.minus(this).times(i))},average:function(t){return this.blend(t,.5)},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new e.Vector2(this.x,this.y)},toVector4:function(){return new e.Vector4(this.x,this.y,this.z,1)},setXYZ:function(t,i,e){return this.x=t,this.y=i,this.z=e,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},set:function(t){return this.setXYZ(t.x,t.y,t.z)},setMagnitude:function(t){var i=t/this.magnitude();return this.multiplyScalar(i)},add:function(t){return this.setXYZ(this.x+t.x,this.y+t.y,this.z+t.z)},addXYZ:function(t,i,e){return this.setXYZ(this.x+t,this.y+i,this.z+e)},addScalar:function(t){return this.setXYZ(this.x+t,this.y+t,this.z+t)},subtract:function(t){return this.setXYZ(this.x-t.x,this.y-t.y,this.z-t.z)},subtractXYZ:function(t,i,e){return this.setXYZ(this.x-t,this.y-i,this.z-e)},subtractScalar:function(t){return this.setXYZ(this.x-t,this.y-t,this.z-t)},multiplyScalar:function(t){return this.setXYZ(this.x*t,this.y*t,this.z*t)},multiply:function(t){return this.multiplyScalar(t)},componentMultiply:function(t){return this.setXYZ(this.x*t.x,this.y*t.y,this.z*t.z)},divideScalar:function(t){return this.setXYZ(this.x/t,this.y/t,this.z/t)},negate:function(){return this.setXYZ(-this.x,-this.y,-this.z)},normalize:function(){var t=this.magnitude();if(0===t)throw new Error("Cannot normalize a zero-magnitude vector");return this.divideScalar(t)},roundSymmetric:function(){return this.setXYZ(e.Util.roundSymmetric(this.x),e.Util.roundSymmetric(this.y),e.Util.roundSymmetric(this.z))}},{slerp:function(t,i,n){return e.Quaternion.slerp(new e.Quaternion,e.Quaternion.getRotationQuaternion(t,i),n).timesVector3(t)}}),r.mixInto(i,{initialize:i.prototype.setXYZ});var s=i.Immutable=function(t,i,e){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==e?e:0};return n(i,s),s.mutableOverrideHelper=function(t){s.prototype[t]=function(){throw new Error("Cannot call mutable method '"+t+"' on immutable Vector3")}},s.mutableOverrideHelper("setXYZ"),s.mutableOverrideHelper("setX"),s.mutableOverrideHelper("setY"),s.mutableOverrideHelper("setZ"),i.ZERO=new i(0,0,0),i.X_UNIT=new i(1,0,0),i.Y_UNIT=new i(0,1,0),i.Z_UNIT=new i(0,0,1),i}),e("DOT/Bounds3",["require","DOT/dot","PHET_CORE/inherit","PHET_CORE/Poolable","DOT/Vector3"],function(t){"use strict";function i(t,i,e,n,r,s){this.minX=t,this.minY=i,this.minZ=e,this.maxX=n,this.maxY=r,this.maxZ=s}var e=t("DOT/dot"),n=t("PHET_CORE/inherit"),r=t("PHET_CORE/Poolable");return t("DOT/Vector3"),e.register("Bounds3",i),n(Object,i,{isBounds:!0,dimension:3,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getDepth:function(){return this.maxZ-this.minZ},get depth(){return this.getDepth()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getZ:function(){return this.minZ},get z(){return this.getZ()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMinZ:function(){return this.minZ},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},getMaxZ:function(){return this.maxZ},getLeft:function(){return this.minX},get left(){return this.minX},getTop:function(){return this.minY},get top(){return this.minY},getBack:function(){return this.minZ},get back(){return this.minZ},getRight:function(){return this.maxX},get right(){return this.maxX},getBottom:function(){return this.maxY},get bottom(){return this.maxY},getFront:function(){return this.maxZ},get front(){return this.maxZ},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getCenterZ:function(){return(this.maxZ+this.minZ)/2},get centerZ(){return this.getCenterZ()},getCenter:function(){return new e.Vector3(this.getCenterX(),this.getCenterY(),this.getCenterZ())},get center(){return this.getCenter()},isEmpty:function(){return this.getWidth()<0||this.getHeight()<0||this.getDepth()<0},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.minZ)&&isFinite(this.maxX)&&isFinite(this.maxY)&&isFinite(this.maxZ)},hasNonzeroArea:function(){return this.getWidth()>0&&this.getHeight()>0&&this.getDepth()>0},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i,e){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY&&this.minZ<=e&&e<=this.maxZ},containsPoint:function(t){return this.containsCoordinates(t.x,t.y,t.z)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY&&this.minZ<=t.minZ&&this.maxZ>=t.maxZ},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+"),z:("+this.minZ+","+this.maxZ+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.minZ===t.minZ&&this.maxX===t.maxX&&this.maxY===t.maxY&&this.maxZ===t.maxZ},equalsEpsilon:function(t,i){i=void 0!==i?i:0;var e=this.isFinite(),n=t.isFinite();return e&&n?Math.abs(this.minX-t.minX)<i&&Math.abs(this.minY-t.minY)<i&&Math.abs(this.minZ-t.minZ)<i&&Math.abs(this.maxX-t.maxX)<i&&Math.abs(this.maxY-t.maxY)<i&&Math.abs(this.maxZ-t.maxZ)<i:e===n&&(this===t||(isFinite(this.minX+t.minX)?Math.abs(this.minX-t.minX)<i:this.minX===t.minX)&&(isFinite(this.minY+t.minY)?Math.abs(this.minY-t.minY)<i:this.minY===t.minY)&&(isFinite(this.minZ+t.minZ)?Math.abs(this.minZ-t.minZ)<i:this.minZ===t.minZ)&&(isFinite(this.maxX+t.maxX)?Math.abs(this.maxX-t.maxX)<i:this.maxX===t.maxX)&&(isFinite(this.maxY+t.maxY)?Math.abs(this.maxY-t.maxY)<i:this.maxY===t.maxY)&&(isFinite(this.maxZ+t.maxZ)?Math.abs(this.maxZ-t.maxZ)<i:this.maxZ===t.maxZ))},copy:function(t){return t?t.set(this):new i(this.minX,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},union:function(t){return new i(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},intersection:function(t){return new i(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},withCoordinates:function(t,e,n){return new i(Math.min(this.minX,t),Math.min(this.minY,e),Math.min(this.minZ,n),Math.max(this.maxX,t),Math.max(this.maxY,e),Math.max(this.maxZ,n))},withPoint:function(t){return this.withCoordinates(t.x,t.y,t.z)},withMinX:function(t){return new i(t,this.minY,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinY:function(t){return new i(this.minX,t,this.minZ,this.maxX,this.maxY,this.maxZ)},withMinZ:function(t){return new i(this.minX,this.minY,t,this.maxX,this.maxY,this.maxZ)},withMaxX:function(t){return new i(this.minX,this.minY,this.minZ,t,this.maxY,this.maxZ)},withMaxY:function(t){return new i(this.minX,this.minY,this.minZ,this.maxX,t,this.maxZ)},withMaxZ:function(t){return new i(this.minX,this.minY,this.minZ,this.maxX,this.maxY,t)},roundedOut:function(){return new i(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundedIn:function(){return new i(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new i(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilatedX:function(t){return new i(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilatedY:function(t){return new i(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilatedZ:function(t){return new i(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilatedXYZ:function(t,e,n){return new i(this.minX-t,this.minY-e,this.minZ-n,this.maxX+t,this.maxY+e,this.maxZ+n)},eroded:function(t){return this.dilated(-t)},erodedX:function(t){return this.dilatedX(-t)},erodedY:function(t){return this.dilatedY(-t)},erodedZ:function(t){return this.dilatedZ(-t)},erodedXYZ:function(t,i,e){return this.dilatedXYZ(-t,-i,-e)},shiftedX:function(t){return new i(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftedY:function(t){return new i(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftedZ:function(t){return new i(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shifted:function(t,e,n){return new i(this.minX+t,this.minY+e,this.minZ+n,this.maxX+t,this.maxY+e,this.maxZ+n)},setMinMax:function(t,i,e,n,r,s){return this.minX=t,this.minY=i,this.minZ=e,this.maxX=n,this.maxY=r,this.maxZ=s,this},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMinZ:function(t){return this.minZ=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},setMaxZ:function(t){return this.maxZ=t,this},set:function(t){return this.setMinMax(t.minX,t.minY,t.minZ,t.maxX,t.maxY,t.maxZ)},includeBounds:function(t){return this.setMinMax(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.min(this.minZ,t.minZ),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY),Math.max(this.maxZ,t.maxZ))},constrainBounds:function(t){return this.setMinMax(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.max(this.minZ,t.minZ),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY),Math.min(this.maxZ,t.maxZ))},addCoordinates:function(t,i,e){return this.setMinMax(Math.min(this.minX,t),Math.min(this.minY,i),Math.min(this.minZ,e),Math.max(this.maxX,t),Math.max(this.maxY,i),Math.max(this.maxZ,e))},addPoint:function(t){return this.addCoordinates(t.x,t.y,t.z)},roundOut:function(){return this.setMinMax(Math.floor(this.minX),Math.floor(this.minY),Math.floor(this.minZ),Math.ceil(this.maxX),Math.ceil(this.maxY),Math.ceil(this.maxZ))},roundIn:function(){return this.setMinMax(Math.ceil(this.minX),Math.ceil(this.minY),Math.ceil(this.minZ),Math.floor(this.maxX),Math.floor(this.maxY),Math.floor(this.maxZ))},transform:function(t){function i(t){n=Math.min(n,t.x),r=Math.min(r,t.y),s=Math.min(s,t.z),h=Math.max(h,t.x),o=Math.max(o,t.y),a=Math.max(a,t.z)}if(this.isEmpty())return this;if(t.isIdentity())return this;var n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=Number.NEGATIVE_INFINITY,u=new e.Vector3;return i(t.multiplyVector3(u.setXYZ(this.minX,this.minY,this.minZ))),i(t.multiplyVector3(u.setXYZ(this.minX,this.maxY,this.minZ))),i(t.multiplyVector3(u.setXYZ(this.maxX,this.minY,this.minZ))),i(t.multiplyVector3(u.setXYZ(this.maxX,this.maxY,this.minZ))),i(t.multiplyVector3(u.setXYZ(this.minX,this.minY,this.maxZ))),i(t.multiplyVector3(u.setXYZ(this.minX,this.maxY,this.maxZ))),i(t.multiplyVector3(u.setXYZ(this.maxX,this.minY,this.maxZ))),i(t.multiplyVector3(u.setXYZ(this.maxX,this.maxY,this.maxZ))),this.setMinMax(n,r,s,h,o,a)},dilate:function(t){return this.setMinMax(this.minX-t,this.minY-t,this.minZ-t,this.maxX+t,this.maxY+t,this.maxZ+t)},dilateX:function(t){return this.setMinMax(this.minX-t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},dilateY:function(t){return this.setMinMax(this.minX,this.minY-t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},dilateZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ-t,this.maxX,this.maxY,this.maxZ+t)},dilateXYZ:function(t,i,e){return this.setMinMax(this.minX-t,this.minY-i,this.minZ-e,this.maxX+t,this.maxY+i,this.maxZ+e)},erode:function(t){return this.dilate(-t)},erodeX:function(t){return this.dilateX(-t)},erodeY:function(t){return this.dilateY(-t)},erodeZ:function(t){return this.dilateZ(-t)},erodeXYZ:function(t,i,e){return this.dilateXYZ(-t,-i,-e)},shiftX:function(t){return this.setMinMax(this.minX+t,this.minY,this.minZ,this.maxX+t,this.maxY,this.maxZ)},shiftY:function(t){return this.setMinMax(this.minX,this.minY+t,this.minZ,this.maxX,this.maxY+t,this.maxZ)},shiftZ:function(t){return this.setMinMax(this.minX,this.minY,this.minZ+t,this.maxX,this.maxY,this.maxZ+t)},shift:function(t,i,e){return this.setMinMax(this.minX+t,this.minY+i,this.minZ+e,this.maxX+t,this.maxY+i,this.maxZ+e)}},{cuboid:function(t,e,n,r,s,h){return new i(t,e,n,t+r,e+s,n+h)},point:function(t,e,n){return new i(t,e,n,t,e,n)}}),r.mixInto(i,{initialize:i.prototype.setMinMax}),i.NOTHING=new i(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),i.EVERYTHING=new i(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),i}),e("DOT/Complex",["require","DOT/dot","DOT/Util","PHET_CORE/inherit"],function(t){"use strict";function i(t,i){this.real=t,this.imaginary=i}var e=t("DOT/dot");t("DOT/Util");var n=t("PHET_CORE/inherit");return e.register("Complex",i),n(Object,i,{copy:function(t){return t?t.set(this):new i(this.real,this.imaginary)},phase:function(){return Math.atan2(this.imaginary,this.real)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.real*this.real+this.imaginary*this.imaginary},equals:function(t){return this.real===t.real&&this.imaginary===t.imaginary},equalsEpsilon:function(t,i){return i||(i=0),Math.max(Math.abs(this.real-t.real),Math.abs(this.imaginary-t.imaginary))<=i},plus:function(t){return new i(this.real+t.real,this.imaginary+t.imaginary)},minus:function(t){return new i(this.real-t.real,this.imaginary-t.imaginary)},times:function(t){return new i(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var e=t.magnitudeSquared();return new i((this.real*t.real+this.imaginary*t.imaginary)/e,(this.imaginary*t.real-this.real*t.imaginary)/e)},sqrtOf:function(){var t=this.magnitude();return new i(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},sinOf:function(){return new i(Math.sin(this.real)*e.Util.cosh(this.imaginary),Math.cos(this.real)*e.Util.sinh(this.imaginary))},cosOf:function(){return new i(Math.cos(this.real)*e.Util.cosh(this.imaginary),-Math.sin(this.real)*e.Util.sinh(this.imaginary))},squared:function(){return this.times(this)},conjugated:function(){return new i(this.real,-this.imaginary)},exponentiated:function(){return i.createPolar(Math.exp(this.real),this.imaginary)},setRealImaginary:function(t,i){return this.real=t,this.imaginary=i,this},setReal:function(t){return this.real=t,this},setImaginary:function(t){return this.imaginary=t,this},set:function(t){return this.setRealImaginary(t.real,t.imaginary)},setPolar:function(t,i){return this.setRealImaginary(t*Math.cos(i),t*Math.sin(i))},add:function(t){return this.setRealImaginary(this.real+t.real,this.imaginary+t.imaginary)},subtract:function(t){return this.setRealImaginary(this.real-t.real,this.imaginary-t.imaginary)},multiply:function(t){return this.setRealImaginary(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},divide:function(t){var i=t.magnitudeSquared();return this.setRealImaginary((this.real*t.real+this.imaginary*t.imaginary)/i,(this.imaginary*t.real-this.real*t.imaginary)/i)},exponentiate:function(){return this.setPolar(Math.exp(this.real),this.imaginary)},square:function(){return this.multiply(this)},sqrt:function(){var t=this.magnitude();return this.setRealImaginary(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},sin:function(){return this.setRealImaginary(Math.sin(this.real)*e.Util.cosh(this.imaginary),Math.cos(this.real)*e.Util.sinh(this.imaginary))},cos:function(){return this.setRealImaginary(Math.cos(this.real)*e.Util.cosh(this.imaginary),-Math.sin(this.real)*e.Util.sinh(this.imaginary))},conjugate:function(){return this.setRealImaginary(this.real,-this.imaginary)},toString:function(){return"Complex("+this.real+", "+this.imaginary+")"}},{real:function(t){return new i(t,0)},imaginary:function(t){return new i(0,t)},createPolar:function(t,e){return new i(t*Math.cos(e),t*Math.sin(e))}}),i.ZERO=new i(0,0),i.ONE=new i(1,0),i.I=i.imaginary(1),i}),e("DOT/ConvexHull2",["require","DOT/dot"],function(t){"use strict";var i={grahamScan:function(t,i){if(t.length<=2)return t;var e=Number.POSITIVE_INFINITY,n=null;_.each(t,function(t){t.y<=e&&(t.y===e&&n?t.x<n.x&&(n=t):(e=t.y,n=t))}),(t=_.sortBy(t,function(t){return t.minus(n).angle()})).splice(_.indexOf(t,n),1);var r=[n];return _.each(t,function(t){function e(){if(r.length<2)return!1;var e=function(t,i,e){return i.minus(t).crossScalar(e.minus(t))}(r[r.length-2],r[r.length-1],t);return i?e<0:e<=0}if(n.x!==t.x||n.y!==t.y){for(;e();)r.pop();r.push(t)}}),r}};return t("DOT/dot").register("ConvexHull2",i),i}),e("DOT/DampedHarmonic",["require","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function i(t,e,n,r,s){this.dampingConstant=e/t,this.angularFrequencySquared=n/t,this.discriminant=this.dampingConstant*this.dampingConstant-4*this.angularFrequencySquared,this.solutionType=0,this.c1=0,this.c2=0,Math.abs(this.discriminant)<1e-5?(this.solutionType=i.CRITICALLY_DAMPED,this.angularFrequency=Math.sqrt(this.angularFrequencySquared),this.c1=r,this.c2=s+this.angularFrequency*r):this.discriminant<0?(this.solutionType=i.UNDER_DAMPED,this.frequency=.5*Math.sqrt(-this.discriminant),this.c1=r,this.c2=this.dampingConstant*r/(2*this.frequency)+s/this.frequency):(this.solutionType=i.OVER_DAMPED,this.positiveRoot=.5*(-this.dampingConstant+Math.sqrt(this.discriminant)),this.negativeRoot=.5*(-this.dampingConstant-Math.sqrt(this.discriminant)),this.c2=(this.negativeRoot*r-s)/(this.negativeRoot-this.positiveRoot),this.c1=r-this.c2)}var e=t("DOT/dot"),n=t("PHET_CORE/inherit");return e.register("DampedHarmonic",i),n(Object,i,{getValue:function(t){if(this.solutionType===i.CRITICALLY_DAMPED)return(this.c1+this.c2*t)*Math.exp(-this.angularFrequency*t);if(this.solutionType===i.UNDER_DAMPED){var e=this.frequency*t;return Math.exp(-this.dampingConstant/2*t)*(this.c1*Math.cos(e)+this.c2*Math.sin(e))}if(this.solutionType===i.OVER_DAMPED)return this.c1*Math.exp(this.negativeRoot*t)+this.c2*Math.exp(this.positiveRoot*t);throw new Error("Unknown solution type?")},getDerivative:function(t){if(this.solutionType===i.CRITICALLY_DAMPED)return Math.exp(-this.angularFrequency*t)*(this.c2-this.angularFrequency*(this.c1+this.c2*t));if(this.solutionType===i.UNDER_DAMPED){var e=this.frequency*t,n=Math.cos(e),r=Math.sin(e),s=this.frequency*(this.c2*n-this.c1*r),h=.5*this.dampingConstant*(this.c1*n+this.c2*r);return Math.exp(-.5*this.dampingConstant*t)*(s-h)}if(this.solutionType===i.OVER_DAMPED)return this.c1*this.negativeRoot*Math.exp(this.negativeRoot*t)+this.c2*this.positiveRoot*Math.exp(this.positiveRoot*t);throw new Error("Unknown solution type?")}},{OVER_DAMPED:1,UNDER_DAMPED:2,CRITICALLY_DAMPED:3}),i}),e("PHET_CORE/arrayRemove",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){var e=_.indexOf(t,i);t.splice(e,1)}return t("PHET_CORE/phetCore").register("arrayRemove",i),i}),e("DOT/DelaunayTriangulation",["require","PHET_CORE/arrayRemove","DOT/Bounds2","DOT/dot","PHET_CORE/inherit","DOT/Util","DOT/Vector2"],function(t){"use strict";function i(t,s,o){o=_.extend({},o);var a;if(this.points=t,this.constraints=s,this.triangles=[],this.edges=[],this.convexHull=[],0!==t.length){for(this.vertices=t.map(function(t,i){return new e(t,i)}),a=0;a<this.constraints.length;a++){var u=this.constraints[a],c=u[0],f=u[1];this.vertices[c].constrainedVertices.push(this.vertices[f])}for(this.vertices.sort(i.vertexComparison),a=0;a<this.vertices.length;a++){var l=this.vertices[a];l.sortedIndex=a;for(var d=l.constrainedVertices.length-1;d>=0;d--){var p=l.constrainedVertices[d];-1===p.sortedIndex&&(p.constrainedVertices.push(l),l.constrainedVertices.splice(d,1))}}this.bottomVertex=this.vertices[0],this.remainingVertices=this.vertices.slice(1);var x=h.NOTHING.copy();for(a=t.length-1;a>=0;a--)x.addPoint(t[a]);this.artificialMinVertex=new e(new m(x.minX-.4*x.width,x.minY-.4*x.height),-1),this.artificialMaxVertex=new e(new m(x.maxX+.4*x.width,x.minY-.4*x.height),-2),this.edges.push(new n(this.artificialMinVertex,this.artificialMaxVertex)),this.edges.push(new n(this.artificialMaxVertex,this.bottomVertex)),this.edges.push(new n(this.bottomVertex,this.artificialMinVertex)),this.triangles.push(new r(this.artificialMinVertex,this.artificialMaxVertex,this.bottomVertex,this.edges[1],this.edges[2],this.edges[0])),this.firstFrontEdge=this.edges[1],this.edges[1].connectAfter(this.edges[2]),this.firstHullEdge=this.edges[0]}}function e(t,i){this.point=t,this.index=i,this.sortedIndex=-1,this.constrainedVertices=[]}function n(t,i){this.startVertex=t,this.endVertex=i,this.triangles=[],this.nextEdge=null,this.previousEdge=null,this.isConstrained=!1}function r(t,i,e,n,r,s){this.aVertex=t,this.bVertex=i,this.cVertex=e,this.aEdge=n,this.bEdge=r,this.cEdge=s,this.aEdge.addTriangle(this),this.bEdge.addTriangle(this),this.cEdge.addTriangle(this)}var s=t("PHET_CORE/arrayRemove"),h=t("DOT/Bounds2"),o=t("DOT/dot"),a=t("PHET_CORE/inherit"),u=t("DOT/Util"),m=t("DOT/Vector2");return o.register("DelaunayTriangulation",i),a(Object,i,{step:function(){for(var t=this.remainingVertices.shift(),i=t.point.x,e=this.firstFrontEdge;e;){if(i>e.endVertex.point.x){var s=new n(e.startVertex,t),h=new n(t,e.endVertex);s.connectAfter(h),this.edges.push(s),this.edges.push(h),this.triangles.push(new r(e.endVertex,e.startVertex,t,s,h,e)),this.reconnectFrontEdges(e,e,s,h),this.legalizeEdge(e),this.addHalfPiHeuristic(s,h),this.constrainEdges(t,s,h);break}if(i===e.endVertex.point.x){var o=e.nextEdge,a=e,u=e.endVertex,m=o.endVertex,c=a.startVertex,f=new n(t,m),l=new n(c,t),d=new n(u,t);l.connectAfter(f),this.edges.push(f),this.edges.push(l),this.edges.push(d),this.triangles.push(new r(m,u,t,d,f,o)),this.triangles.push(new r(u,c,t,l,d,a)),this.reconnectFrontEdges(a,o,l,f),this.legalizeEdge(o),this.legalizeEdge(a),this.legalizeEdge(d),this.addHalfPiHeuristic(l,f),this.constrainEdges(t,l,f);break}e=e.nextEdge}},fillBorderTriangle:function(t,i,e,s,h){var o=new n(e,h);return this.edges.push(o),this.triangles.push(new r(h,s,e,t,o,i)),this.legalizeEdge(t),this.legalizeEdge(i),o},reconnectFrontEdges:function(t,i,e,n){var r=t.previousEdge,s=i.nextEdge;r?(r.disconnectAfter(),r.connectAfter(e)):this.firstFrontEdge=e,s&&(i.disconnectAfter(),n.connectAfter(s))},addHalfPiHeuristic:function(t,i){for(var e=t.endVertex;t.previousEdge&&u.triangleAreaSigned(e.point,t.startVertex.point,t.previousEdge.startVertex.point)>0&&e.point.minus(t.startVertex.point).angleBetween(t.previousEdge.startVertex.point.minus(t.startVertex.point))<Math.PI/2;){var s=t.previousEdge,h=new n(s.startVertex,e);this.edges.push(h),this.triangles.push(new r(e,t.startVertex,s.startVertex,s,h,t)),this.reconnectFrontEdges(s,t,h,h),this.legalizeEdge(s),this.legalizeEdge(t),t=h}for(;i.nextEdge&&u.triangleAreaSigned(e.point,i.nextEdge.endVertex.point,i.endVertex.point)>0&&e.point.minus(i.endVertex.point).angleBetween(i.nextEdge.endVertex.point.minus(i.endVertex.point))<Math.PI/2;){var o=i.nextEdge,a=new n(e,o.endVertex);this.edges.push(a),this.triangles.push(new r(e,i.nextEdge.endVertex,i.endVertex,o,i,a)),this.reconnectFrontEdges(i,o,a,a),this.legalizeEdge(o),this.legalizeEdge(i),i=a}},constrainEdges:function(t,e,r){for(var h=0;h<t.constrainedVertices.length;h++){var o=t.constrainedVertices[h];if(o===e.startVertex||o===r.endVertex)break;var a=[],u=[],m=null,c=null,f=[],l=[],d=i.vertexProduct(t,e.startVertex,o)>0,p=i.vertexProduct(t,r.endVertex,o)<0;if(!d&&!p){var x,g=e.startVertex;for(m=e.triangles[0];i.vertexProduct(t,x=m.getEdgeOppositeFromVertex(t).getOtherVertex(g),o)<0;)m=m.getEdgeOppositeFromVertex(g).getOtherTriangle(m),g=x;if(m.hasVertex(o))break;f.push(m),c=m.getEdgeOppositeFromVertex(t),l.push(c),a.push(m.getEdgeOppositeFromVertex(g)),u.push(m.getEdgeOppositeFromVertex(c.getOtherVertex(g)))}for(;;){if(d)break;if(p)break;if(c.triangles.length>1){var y=c.getOtherTriangle(m);if(y.hasVertex(o)){f.push(y),a.push(y.getNextEdge(c)),u.push(y.getPreviousEdge(c));break}var v;y.aEdge!==c&&y.aEdge.intersectsConstrainedEdge(t,o)?v=y.aEdge:y.bEdge!==c&&y.bEdge.intersectsConstrainedEdge(t,o)?v=y.bEdge:y.cEdge!==c&&y.cEdge.intersectsConstrainedEdge(t,o)&&(v=y.cEdge),y.getNextEdge(v)===c?a.push(y.getPreviousEdge(v)):u.push(y.getNextEdge(v)),c=v,l.push(c),m=y,f.push(m)}else o.point.x<t.point.x?p=!0:d=!0}for(var T=0;T<f.length;T++){var E=f[T];s(this.triangles,E),E.remove()}for(T=0;T<l.length;T++)s(this.edges,l[T]);var O=new n(o,t);O.isConstrained=!0,this.edges.push(O),a.push(O),u.push(O),u.reverse(),window.triDebug&&window.triDebug(this),this.triangulatePolygon(a),this.triangulatePolygon(u)}},triangulatePolygon:function(t){for(;t.length>3;){for(var i=0;i<t.length;i++)t.length;for(var e=0;e<t.length;e++){var s=e<t.length-1?e+1:0,h=t[e],o=t[s],a=h.getSharedVertex(o),m=h.getOtherVertex(a),c=o.getOtherVertex(a);if(!(u.triangleAreaSigned(m.point,a.point,c.point)<=0)){for(var f=c.point.minus(a.point),l=m.point.minus(a.point),d=f.dot(f),p=f.dot(l),x=l.dot(l),g=d*x-p*p,y=t[0].getSharedVertex(t[t.length-1]),v=!1,T=0;T<t.length;T++){var E=t[T].getOtherVertex(y);if(E!==a&&E!==m&&E!==c){var O=E.point.minus(a.point),w=f.dot(O),M=l.dot(O),I=(x*w-p*M)/g,b=(d*M-p*w)/g;if(I>=-1e-10&&b>=-1e-10&&I+b<1+1e-10){v=!0;break}}y=E}if(!v){var P=new n(m,c);this.edges.push(P),this.triangles.push(new r(m,a,c,o,P,h)),s>e?t.splice(e,2,P):(t.splice(e,1,P),t.splice(s,1)),window.triDebug&&window.triDebug(this)}}}}3===t.length&&(this.triangles.push(new r(t[0].getSharedVertex(t[1]),t[1].getSharedVertex(t[2]),t[0].getSharedVertex(t[2]),t[2],t[0],t[1])),window.triDebug&&window.triDebug(this))},finalize:function(){for(var t=[],i=this.firstFrontEdge.nextEdge;i&&i.nextEdge;)t.push(i),i=i.nextEdge;for(var e=this.firstFrontEdge,n=i,r=0;r<t.length-1;r++){var h=t[r],o=t[r+1];if(u.triangleAreaSigned(o.endVertex.point,h.endVertex.point,h.startVertex.point)>1e-10){var a=this.fillBorderTriangle(h,o,h.startVertex,h.endVertex,o.endVertex);t.splice(r,2,a),r=Math.max(r-2,-1),window.triDebug&&window.triDebug(this)}}this.firstFrontEdge=null;for(var m=[],c=[e],f=e;f!==n;){var l=f.triangles[0];l.remove(),s(this.triangles,l);var d=l.getNonArtificialEdge();if(d){m.push(d);var p=d.getSharedVertex(f);f=l.getEdgeOppositeFromVertex(p)}else c.push(l.getEdgeOppositeFromVertex(f.endVertex)),f=l.getEdgeOppositeFromVertex(f.startVertex);c.push(f)}for(r=0;r<c.length;r++)s(this.edges,c[r]);for(window.triDebug&&window.triDebug(this),r=0;r<m.length-1;r++){h=m[r+1],o=m[r],p=h.getSharedVertex(o);var x=h.getOtherVertex(p),g=o.getOtherVertex(p);u.triangleAreaSigned(g.point,p.point,x.point)>1e-10&&(a=this.fillBorderTriangle(h,o,x,p,g),m.splice(r,2,a),r=Math.max(r-2,-1),window.triDebug&&window.triDebug(this))}for(r=0;r<t.length;r++)this.convexHull.push(t[r].startVertex);for(this.convexHull.push(t[t.length-1].endVertex),r=m.length-1;r>=1;r--)this.convexHull.push(m[r].getSharedVertex(m[r-1]))},legalizeEdge:function(t){if(_.includes(this.edges,t)&&2===t.triangles.length&&!t.isConstrained){var i=t.triangles[0],e=t.triangles[1],h=i.getVertexOppositeFromEdge(t),o=e.getVertexOppositeFromEdge(t);if(u.pointInCircleFromPoints(i.aVertex.point,i.bVertex.point,i.cVertex.point,o.point)||u.pointInCircleFromPoints(e.aVertex.point,e.bVertex.point,e.cVertex.point,h.point)){i.remove(),e.remove(),s(this.triangles,i),s(this.triangles,e),s(this.edges,t);var a=new n(h,o);this.edges.push(a);var m=e.getEdgeOppositeFromVertex(e.getVertexBefore(o)),c=i.getEdgeOppositeFromVertex(i.getVertexAfter(h)),f=i.getEdgeOppositeFromVertex(i.getVertexBefore(h)),l=e.getEdgeOppositeFromVertex(e.getVertexAfter(o));this.triangles.push(new r(h,o,i.getVertexBefore(h),m,c,a)),this.triangles.push(new r(o,h,e.getVertexBefore(o),f,l,a)),this.legalizeEdge(m),this.legalizeEdge(c),this.legalizeEdge(f),this.legalizeEdge(l)}}}},{vertexComparison:function(t,i){return t=t.point,i=i.point,t.y<i.y?-1:t.y>i.y?1:t.x<i.x?-1:t.x>i.x?1:0},vertexProduct:function(t,i,e){var n=i.point.minus(t.point),r=e.point.minus(t.point);return n.crossScalar(r)}}),a(Object,e,{isArtificial:function(){return this.index<0}}),a(Object,n,{isArtificial:function(){return this.startVertex.isArtificial()||this.endVertex.isArtificial()},connectAfter:function(t){this.nextEdge=t,t.previousEdge=this},disconnectAfter:function(){this.nextEdge.previousEdge=null,this.nextEdge=null},addTriangle:function(t){this.triangles.push(t)},removeTriangle:function(t){s(this.triangles,t)},getSharedTriangle:function(t){for(var i=0;i<this.triangles.length;i++)for(var e=this.triangles[i],n=0;n<t.triangles.length;n++)if(t.triangles[n]===e)return e;throw new Error("No common triangle")},getSharedVertex:function(t){return this.startVertex===t.startVertex||this.startVertex===t.endVertex?this.startVertex:this.endVertex},getOtherVertex:function(t){return t===this.startVertex?this.endVertex:this.startVertex},getOtherTriangle:function(t){return this.triangles[0]===t?this.triangles[1]:this.triangles[0]},intersectsConstrainedEdge:function(t,i){return u.lineSegmentIntersection(t.point.x,t.point.y,i.point.x,i.point.y,this.startVertex.point.x,this.startVertex.point.y,this.endVertex.point.x,this.endVertex.point.y)}}),a(Object,r,{hasVertex:function(t){return this.aVertex===t||this.bVertex===t||this.cVertex===t},getVertexOppositeFromEdge:function(t){return t===this.aEdge?this.aVertex:t===this.bEdge?this.bVertex:this.cVertex},getEdgeOppositeFromVertex:function(t){return t===this.aVertex?this.aEdge:t===this.bVertex?this.bEdge:this.cEdge},getVertexBefore:function(t){return t===this.aVertex?this.cVertex:t===this.bVertex?this.aVertex:this.bVertex},getVertexAfter:function(t){return t===this.aVertex?this.bVertex:t===this.bVertex?this.cVertex:this.aVertex},getNonArtificialEdge:function(){return this.aEdge.isArtificial()?this.bEdge.isArtificial()?this.cEdge.isArtificial()?null:this.cEdge:this.bEdge:this.aEdge},getNextEdge:function(t){return this.aEdge===t?this.bEdge:this.bEdge===t?this.cEdge:this.cEdge===t?this.aEdge:void 0},getPreviousEdge:function(t){return this.aEdge===t?this.cEdge:this.bEdge===t?this.aEdge:this.cEdge===t?this.bEdge:void 0},isArtificial:function(){return this.aVertex.isArtificial()||this.bVertex.isArtificial()||this.cVertex.isArtificial()},remove:function(){this.aEdge.removeTriangle(this),this.bEdge.removeTriangle(this),this.cEdge.removeTriangle(this)}}),i}),e("DOT/Dimension2",["require","DOT/dot","PHET_CORE/inherit","DOT/Bounds2"],function(t){"use strict";function i(t,i){this.width=t,this.height=i}var e=t("DOT/dot"),n=t("PHET_CORE/inherit");return t("DOT/Bounds2"),e.register("Dimension2",i),n(Object,i,{toString:function(){return"["+this.width+"w, "+this.height+"h]"},set:function(t){return this.width=t.width,this.height=t.height,this},setWidth:function(t){return this.width=t,this},setHeight:function(t){return this.height=t,this},copy:function(t){return t?t.set(this):new i(this.width,this.height)},toBounds:function(t,i){return t=void 0!==t?t:0,i=void 0!==i?i:0,new e.Bounds2(t,i,this.width+t,this.height+i)},equals:function(t){return this.width===t.width&&this.height===t.height}}),i}),e("DOT/EigenvalueDecomposition",["require","DOT/dot"],function(t){"use strict";function i(t){var i,e,r=t.entries;this.n=t.getColumnDimension();var s=this.n;for(this.V=new n(s*s),this.d=new n(s),this.e=new n(s),this.issymmetric=!0,e=0;e<s&&this.issymmetric;e++)for(i=0;i<s&&this.issymmetric;i++)this.issymmetric=r[i*this.n+e]===r[e*this.n+i];if(this.issymmetric){for(i=0;i<s;i++)for(e=0;e<s;e++)this.V[i*this.n+e]=r[i*this.n+e];this.tred2(),this.tql2()}else{for(this.H=new n(s*s),this.ort=new n(s),e=0;e<s;e++)for(i=0;i<s;i++)this.H[i*this.n+e]=r[i*this.n+e];this.orthes(),this.hqr2()}}var e=t("DOT/dot"),n=window.Float64Array||Array;return e.register("EigenvalueDecomposition",i),i.prototype={constructor:i,getV:function(){return this.V.copy()},getRealEigenvalues:function(){return this.d},getImagEigenvalues:function(){return this.e},getD:function(){for(var t=this.n,i=this.d,n=this.e,r=new e.Matrix(t,t),s=r.entries,h=0;h<t;h++){for(var o=0;o<t;o++)s[h*this.n+o]=0;s[h*this.n+h]=i[h],n[h]>0?s[h*this.n+h+1]=n[h]:n[h]<0&&(s[h*this.n+h-1]=n[h])}return r},tred2:function(){var t,i,e,n,r,s,h=this.n,o=this.V,a=this.d,u=this.e;for(i=0;i<h;i++)a[i]=o[(h-1)*h+i];for(t=h-1;t>0;t--){var m=0;for(s=0,e=0;e<t;e++)m+=Math.abs(a[e]);if(0===m)for(u[t]=a[t-1],i=0;i<t;i++)a[i]=o[(t-1)*h+i],o[t*this.n+i]=0,o[i*this.n+t]=0;else{for(e=0;e<t;e++)a[e]/=m,s+=a[e]*a[e];for(n=a[t-1],r=Math.sqrt(s),n>0&&(r=-r),u[t]=m*r,s-=n*r,a[t-1]=n-r,i=0;i<t;i++)u[i]=0;for(i=0;i<t;i++){for(n=a[i],o[i*this.n+t]=n,r=u[i]+o[i*h+i]*n,e=i+1;e<=t-1;e++)r+=o[e*h+i]*a[e],u[e]+=o[e*h+i]*n;u[i]=r}for(n=0,i=0;i<t;i++)u[i]/=s,n+=u[i]*a[i];var c=n/(s+s);for(i=0;i<t;i++)u[i]-=c*a[i];for(i=0;i<t;i++){for(n=a[i],r=u[i],e=i;e<=t-1;e++)o[e*h+i]-=n*u[e]+r*a[e];a[i]=o[(t-1)*h+i],o[t*this.n+i]=0}}a[t]=s}for(t=0;t<h-1;t++){if(o[(h-1)*h+t]=o[t*h+t],o[t*h+t]=1,0!==(s=a[t+1])){for(e=0;e<=t;e++)a[e]=o[e*h+(t+1)]/s;for(i=0;i<=t;i++){for(r=0,e=0;e<=t;e++)r+=o[e*h+(t+1)]*o[e*h+i];for(e=0;e<=t;e++)o[e*h+i]-=r*a[e]}}for(e=0;e<=t;e++)o[e*h+(t+1)]=0}for(i=0;i<h;i++)a[i]=o[(h-1)*h+i],o[(h-1)*h+i]=0;o[(h-1)*h+(h-1)]=1,u[0]=0},tql2:function(){var t,i,n,r,s,h,o=this.n,a=this.V,u=this.d,m=this.e;for(t=1;t<o;t++)m[t-1]=m[t];m[o-1]=0;var c=0,f=0,l=Math.pow(2,-52);for(r=0;r<o;r++){f=Math.max(f,Math.abs(u[r])+Math.abs(m[r]));for(var d=r;d<o&&!(Math.abs(m[d])<=l*f);)d++;if(d>r){0;do{1,s=u[r],h=(u[r+1]-s)/(2*m[r]);var p=e.Matrix.hypot(h,1);h<0&&(p=-p),u[r]=m[r]/(h+p),u[r+1]=m[r]*(h+p);var x=u[r+1],g=s-u[r];for(t=r+2;t<o;t++)u[t]-=g;c+=g,h=u[d];var y=1,v=y,T=y,E=m[r+1],O=0,w=0;for(t=d-1;t>=r;t--)for(T=v,v=y,w=O,s=y*m[t],g=y*h,p=e.Matrix.hypot(h,m[t]),m[t+1]=O*p,O=m[t]/p,h=(y=h/p)*u[t]-O*s,u[t+1]=g+O*(y*s+O*u[t]),n=0;n<o;n++)g=a[n*o+(t+1)],a[n*o+(t+1)]=O*a[n*o+t]+y*g,a[n*o+t]=y*a[n*o+t]-O*g;h=-O*w*T*E*m[r]/x,m[r]=O*h,u[r]=y*h}while(Math.abs(m[r])>l*f)}u[r]=u[r]+c,m[r]=0}for(t=0;t<o-1;t++){for(n=t,h=u[t],i=t+1;i<o;i++)u[i]<h&&(n=i,h=u[i]);if(n!==t)for(u[n]=u[t],u[t]=h,i=0;i<o;i++)h=a[i*this.n+t],a[i*this.n+t]=a[i*o+n],a[i*o+n]=h}},orthes:function(){var t,i,e,n,r,s=this.n,h=this.V,o=this.H,a=this.ort,u=s-1;for(e=1;e<=u-1;e++){var m=0;for(t=e;t<=u;t++)m+=Math.abs(o[t*s+(e-1)]);if(0!==m){var c=0;for(t=u;t>=e;t--)a[t]=o[t*s+(e-1)]/m,c+=a[t]*a[t];for(r=Math.sqrt(c),a[e]>0&&(r=-r),c-=a[e]*r,a[e]=a[e]-r,i=e;i<s;i++){for(n=0,t=u;t>=e;t--)n+=a[t]*o[t*this.n+i];for(n/=c,t=e;t<=u;t++)o[t*this.n+i]-=n*a[t]}for(t=0;t<=u;t++){for(n=0,i=u;i>=e;i--)n+=a[i]*o[t*this.n+i];for(n/=c,i=e;i<=u;i++)o[t*this.n+i]-=n*a[i]}a[e]=m*a[e],o[e*s+(e-1)]=m*r}}for(t=0;t<s;t++)for(i=0;i<s;i++)h[t*this.n+i]=t===i?1:0;for(e=u-1;e>=1;e--)if(0!==o[e*s+(e-1)]){for(t=e+1;t<=u;t++)a[t]=o[t*s+(e-1)];for(i=e;i<=u;i++){for(r=0,t=e;t<=u;t++)r+=a[t]*h[t*this.n+i];for(r=r/a[e]/o[e*s+(e-1)],t=e;t<=u;t++)h[t*this.n+i]+=r*a[t]}}},cdiv:function(t,i,e,n){var r,s;Math.abs(e)>Math.abs(n)?(s=e+(r=n/e)*n,this.cdivr=(t+r*i)/s,this.cdivi=(i-r*t)/s):(s=n+(r=e/n)*e,this.cdivr=(r*t+i)/s,this.cdivi=(r*i-t)/s)},hqr2:function(){var t,i,e,n,r,s,h,o=this.V,a=this.d,u=this.e,m=this.H,c=this.n;t=c-1;var f,l,d,p,x=c-1,g=Math.pow(2,-52),y=0,v=0,T=0,E=0,O=0,w=0,M=0;for(i=0;i<c;i++)for((i<0||i>x)&&(a[i]=m[i*t+i],u[i]=0),e=Math.max(i-1,0);e<c;e++)M+=Math.abs(m[i*this.n+e]);for(h=0;t>=0;){for(r=t;r>0&&(0===(O=Math.abs(m[(r-1)*t+(r-1)])+Math.abs(m[r*t+r]))&&(O=M),!(Math.abs(m[r*t+(r-1)])<g*O));)r--;if(r===t)m[t*t+t]=m[t*t+t]+y,a[t]=m[t*t+t],u[t]=0,t--,h=0;else if(r===t-1){if(l=m[t*t+t-1]*m[(t-1)*t+t],v=(m[(t-1)*t+(t-1)]-m[t*t+t])/2,T=v*v+l,w=Math.sqrt(Math.abs(T)),m[t*t+t]=m[t*t+t]+y,m[(t-1)*t+(t-1)]=m[(t-1)*t+(t-1)]+y,d=m[t*t+t],T>=0){for(w=v>=0?v+w:v-w,a[t-1]=d+w,a[t]=a[t-1],0!==w&&(a[t]=d-l/w),u[t-1]=0,u[t]=0,v=(d=m[t*t+t-1])/(O=Math.abs(d)+Math.abs(w)),T=w/O,v/=E=Math.sqrt(v*v+T*T),T/=E,e=t-1;e<c;e++)w=m[(t-1)*t+e],m[(t-1)*t+e]=T*w+v*m[t*t+e],m[t*t+e]=T*m[t*t+e]-v*w;for(i=0;i<=t;i++)w=m[i*t+t-1],m[i*t+t-1]=T*w+v*m[i*t+t],m[i*t+t]=T*m[i*t+t]-v*w;for(i=0;i<=x;i++)w=o[i*t+t-1],o[i*t+t-1]=T*w+v*o[i*t+t],o[i*t+t]=T*o[i*t+t]-v*w}else a[t-1]=d+v,a[t]=d+v,u[t-1]=w,u[t]=-w;t-=2,h=0}else{if(d=m[t*t+t],p=0,l=0,r<t&&(p=m[(t-1)*t+(t-1)],l=m[t*t+t-1]*m[(t-1)*t+t]),10===h){for(y+=d,i=0;i<=t;i++)m[i*t+i]-=d;d=p=.75*(O=Math.abs(m[t*t+t-1])+Math.abs(m[(t-1)*t+t-2])),l=-.4375*O*O}if(30===h&&(O=(p-d)/2,(O=O*O+l)>0)){for(O=Math.sqrt(O),p<d&&(O=-O),O=d-l/((p-d)/2+O),i=0;i<=t;i++)m[i*t+i]-=O;y+=O,d=p=l=.964}for(h+=1,s=t-2;s>=r&&(w=m[s*t+s],E=d-w,O=p-w,v=(E*O-l)/m[(s+1)*t+s]+m[s*t+s+1],T=m[(s+1)*t+s+1]-w-E-O,E=m[(s+2)*t+s+1],O=Math.abs(v)+Math.abs(T)+Math.abs(E),v/=O,T/=O,E/=O,s!==r)&&!(Math.abs(m[s*t+(s-1)])*(Math.abs(T)+Math.abs(E))<g*(Math.abs(v)*(Math.abs(m[(s-1)*t+s-1])+Math.abs(w)+Math.abs(m[(s+1)*t+s+1]))));)s--;for(i=s+2;i<=t;i++)m[i*t+i-2]=0,i>s+2&&(m[i*t+i-3]=0);for(n=s;n<=t-1;n++){var I=n!==t-1;if(n!==s&&(v=m[n*t+n-1],T=m[(n+1)*t+n-1],E=I?m[(n+2)*t+n-1]:0,0!==(d=Math.abs(v)+Math.abs(T)+Math.abs(E))&&(v/=d,T/=d,E/=d)),0===d)break;if(O=Math.sqrt(v*v+T*T+E*E),v<0&&(O=-O),0!==O){for(n!==s?m[n*t+n-1]=-O*d:r!==s&&(m[n*t+n-1]=-m[n*t+n-1]),d=(v+=O)/O,p=T/O,w=E/O,T/=v,E/=v,e=n;e<c;e++)v=m[n*t+e]+T*m[(n+1)*t+e],I&&(v+=E*m[(n+2)*t+e],m[(n+2)*t+e]=m[(n+2)*t+e]-v*w),m[n*t+e]=m[n*t+e]-v*d,m[(n+1)*t+e]=m[(n+1)*t+e]-v*p;for(i=0;i<=Math.min(t,n+3);i++)v=d*m[i*t+n]+p*m[i*t+n+1],I&&(v+=w*m[i*t+n+2],m[i*t+n+2]=m[i*t+n+2]-v*E),m[i*t+n]=m[i*t+n]-v,m[i*t+n+1]=m[i*t+n+1]-v*T;for(i=0;i<=x;i++)v=d*o[i*t+n]+p*o[i*t+n+1],I&&(v+=w*o[i*t+n+2],o[i*t+n+2]=o[i*t+n+2]-v*E),o[i*t+n]=o[i*t+n]-v,o[i*t+n+1]=o[i*t+n+1]-v*T}}}}if(0!==M){for(t=c-1;t>=0;t--)if(v=a[t],0===(T=u[t]))for(r=t,m[t*t+t]=1,i=t-1;i>=0;i--){for(l=m[i*t+i]-v,E=0,e=r;e<=t;e++)E+=m[i*this.n+e]*m[e*t+t];if(u[i]<0)w=l,O=E;else if(r=i,0===u[i]?m[i*t+t]=0!==l?-E/l:-E/(g*M):(d=m[i*t+i+1],p=m[(i+1)*t+i],f=(d*O-w*E)/(T=(a[i]-v)*(a[i]-v)+u[i]*u[i]),m[i*t+t]=f,Math.abs(d)>Math.abs(w)?m[(i+1)*t+t]=(-E-l*f)/d:m[(i+1)*t+t]=(-O-p*f)/w),f=Math.abs(m[i*t+t]),g*f*f>1)for(e=i;e<=t;e++)m[e*t+t]=m[e*t+t]/f}else if(T<0)for(r=t-1,Math.abs(m[t*t+t-1])>Math.abs(m[(t-1)*t+t])?(m[(t-1)*t+(t-1)]=T/m[t*t+t-1],m[(t-1)*t+t]=-(m[t*t+t]-v)/m[t*t+t-1]):(this.cdiv(0,-m[(t-1)*t+t],m[(t-1)*t+(t-1)]-v,T),m[(t-1)*t+(t-1)]=this.cdivr,m[(t-1)*t+t]=this.cdivi),m[t*t+t-1]=0,m[t*t+t]=1,i=t-2;i>=0;i--){var b,P,X,V;for(b=0,P=0,e=r;e<=t;e++)b+=m[i*this.n+e]*m[e*t+t-1],P+=m[i*this.n+e]*m[e*t+t];if(l=m[i*t+i]-v,u[i]<0)w=l,E=b,O=P;else if(r=i,0===u[i]?(this.cdiv(-b,-P,l,T),m[i*t+t-1]=this.cdivr,m[i*t+t]=this.cdivi):(d=m[i*t+i+1],p=m[(i+1)*t+i],X=(a[i]-v)*(a[i]-v)+u[i]*u[i]-T*T,V=2*(a[i]-v)*T,0===X&&0===V&&(X=g*M*(Math.abs(l)+Math.abs(T)+Math.abs(d)+Math.abs(p)+Math.abs(w))),this.cdiv(d*E-w*b+T*P,d*O-w*P-T*b,X,V),m[i*t+t-1]=this.cdivr,m[i*t+t]=this.cdivi,Math.abs(d)>Math.abs(w)+Math.abs(T)?(m[(i+1)*t+t-1]=(-b-l*m[i*t+t-1]+T*m[i*t+t])/d,m[(i+1)*t+t]=(-P-l*m[i*t+t]-T*m[i*t+t-1])/d):(this.cdiv(-E-p*m[i*t+t-1],-O-p*m[i*t+t],w,T),m[(i+1)*t+t-1]=this.cdivr,m[(i+1)*t+t]=this.cdivi)),f=Math.max(Math.abs(m[i*t+t-1]),Math.abs(m[i*t+t])),g*f*f>1)for(e=i;e<=t;e++)m[e*t+t-1]=m[e*t+t-1]/f,m[e*t+t]=m[e*t+t]/f}for(i=0;i<c;i++)if(i<0||i>x)for(e=i;e<c;e++)o[i*this.n+e]=m[i*this.n+e];for(e=c-1;e>=0;e--)for(i=0;i<=x;i++){for(w=0,n=0;n<=Math.min(e,x);n++)w+=o[i*t+n]*m[n*t+e];o[i*this.n+e]=w}}}},i}),e("DOT/LinearFunction",["require","DOT/dot","DOT/Util"],function(t){"use strict";function i(t,i,n,r,s){s=!_.isUndefined(s)&&s;var h=function(t,i,n,r,s,h){var o=e.Util.linear(t,i,n,r,s);if(h){var a=Math.max(n,r),u=Math.min(n,r);o=e.Util.clamp(o,u,a)}return o},o=function(e){return h(t,i,n,r,e,s)};return o.inverse=function(e){return h(n,r,t,i,e,s)},o}var e=t("DOT/dot");return t("DOT/Util"),e.register("LinearFunction",i),i}),e("DOT/LUDecomposition",["require","DOT/dot"],function(t){"use strict";function i(t){var i,e,r;this.matrix=t,this.LU=t.getArrayCopy();var s=this.LU;this.m=t.getRowDimension();var h=this.m;this.n=t.getColumnDimension();var o=this.n;for(this.piv=new Uint32Array(h),i=0;i<h;i++)this.piv[i]=i;this.pivsign=1;var a=new n(h);for(e=0;e<o;e++){for(i=0;i<h;i++)a[i]=s[t.index(i,e)];for(i=0;i<h;i++){var u=Math.min(i,e),m=0;for(r=0;r<u;r++){m+=s[t.index(i,r)]*a[r]}a[i]-=m,s[t.index(i,e)]=a[i]}var c=e;for(i=e+1;i<h;i++)Math.abs(a[i])>Math.abs(a[c])&&(c=i);if(c!==e){for(r=0;r<o;r++){var f=t.index(c,r),l=t.index(e,r),d=s[f];s[f]=s[l],s[l]=d}r=this.piv[c],this.piv[c]=this.piv[e],this.piv[e]=r,this.pivsign=-this.pivsign}if(e<h&&0!==s[this.matrix.index(e,e)])for(i=e+1;i<h;i++)s[t.index(i,e)]/=s[t.index(e,e)]}}var e=t("DOT/dot"),n=window.Float64Array||Array;return e.register("LUDecomposition",i),i.prototype={constructor:i,isNonsingular:function(){for(var t=0;t<this.n;t++){var i=this.matrix.index(t,t);if(0===this.LU[i])return!1}return!0},getL:function(){for(var t=new e.Matrix(this.m,this.n),i=0;i<this.m;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=i>n?this.LU[this.matrix.index(i,n)]:i===n?1:0;return t},getU:function(){for(var t=new e.Matrix(this.n,this.n),i=0;i<this.n;i++)for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=i<=n?this.LU[this.matrix.index(i,n)]:0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},getDoublePivot:function(){for(var t=new n(this.m),i=0;i<this.m;i++)t[i]=this.piv[i];return t},det:function(){if(this.m!==this.n)throw new Error("Matrix must be square.");for(var t=this.pivsign,i=0;i<this.n;i++)t*=this.LU[this.matrix.index(i,i)];return t},solve:function(t){var i,e,n;if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw new Error("Matrix is singular.");var r=t.getColumnDimension(),s=t.getArrayRowMatrix(this.piv,0,r-1);for(n=0;n<this.n;n++)for(i=n+1;i<this.n;i++)for(e=0;e<r;e++)s.entries[s.index(i,e)]-=s.entries[s.index(n,e)]*this.LU[this.matrix.index(i,n)];for(n=this.n-1;n>=0;n--){for(e=0;e<r;e++)s.entries[s.index(n,e)]/=this.LU[this.matrix.index(n,n)];for(i=0;i<n;i++)for(e=0;e<r;e++)s.entries[s.index(i,e)]-=s.entries[s.index(n,e)]*this.LU[this.matrix.index(i,n)]}return s}},i}),e("PHET_CORE/isArray",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return"[object Array]"===Object.prototype.toString.call(t)}return t("PHET_CORE/phetCore").register("isArray",i),i}),e("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){"use strict";function i(t){this.matrix=t;var i=t,r=i.getArrayCopy();this.m=i.getRowDimension(),this.n=i.getColumnDimension();var s=this.m,h=this.n,o=Math.min,a=Math.max,u=Math.pow,m=Math.abs,c=o(s,h);this.s=new n(o(s+1,h));var f=this.s;this.U=new n(s*c);var l=this.U;this.V=new n(h*h);var d,p,x,g,y,v,T,E=this.V,O=new n(h),w=new n(s),M=e.Matrix.hypot,I=o(s-1,h),b=a(0,o(h-2,s));for(x=0;x<a(I,b);x++){if(x<I){for(f[x]=0,d=x;d<s;d++)f[x]=M(f[x],r[d*h+x]);if(0!==f[x]){for(r[x*h+x]<0&&(f[x]=-f[x]),d=x;d<s;d++)r[d*h+x]/=f[x];r[x*h+x]+=1}f[x]=-f[x]}for(p=x+1;p<h;p++){if(x<I&&0!==f[x]){for(g=0,d=x;d<s;d++)g+=r[d*h+x]*r[d*h+p];for(g=-g/r[x*h+x],d=x;d<s;d++)r[d*h+p]+=g*r[d*h+x]}O[p]=r[x*h+p]}if(x<I)for(d=x;d<s;d++)l[d*c+x]=r[d*h+x];if(x<b){for(O[x]=0,d=x+1;d<h;d++)O[x]=M(O[x],O[d]);if(0!==O[x]){for(O[x+1]<0&&(O[x]=-O[x]),d=x+1;d<h;d++)O[d]/=O[x];O[x+1]+=1}if(O[x]=-O[x],x+1<s&&0!==O[x]){for(d=x+1;d<s;d++)w[d]=0;for(p=x+1;p<h;p++)for(d=x+1;d<s;d++)w[d]+=O[p]*r[d*h+p];for(p=x+1;p<h;p++)for(g=-O[p]/O[x+1],d=x+1;d<s;d++)r[d*h+p]+=g*w[d]}for(d=x+1;d<h;d++)E[d*h+x]=O[d]}}var P=o(h,s+1);for(I<h&&(f[I]=r[I*h+I]),s<P&&(f[P-1]=0),b+1<P&&(O[b]=r[b*h+P-1]),O[P-1]=0,p=I;p<c;p++){for(d=0;d<s;d++)l[d*c+p]=0;l[p*c+p]=1}for(x=I-1;x>=0;x--)if(0!==f[x]){for(p=x+1;p<c;p++){for(g=0,d=x;d<s;d++)g+=l[d*c+x]*l[d*c+p];for(g=-g/l[x*c+x],d=x;d<s;d++)l[d*c+p]+=g*l[d*c+x]}for(d=x;d<s;d++)l[d*c+x]=-l[d*c+x];for(l[x*c+x]=1+l[x*c+x],d=0;d<x-1;d++)l[d*c+x]=0}else{for(d=0;d<s;d++)l[d*c+x]=0;l[x*c+x]=1}for(x=h-1;x>=0;x--){if(x<b&&0!==O[x])for(p=x+1;p<c;p++){for(g=0,d=x+1;d<h;d++)g+=E[d*h+x]*E[d*h+p];for(g=-g/E[(x+1)*h+x],d=x+1;d<h;d++)E[d*h+p]+=g*E[d*h+x]}for(d=0;d<h;d++)E[d*h+x]=0;E[x*h+x]=1}for(var X=P-1,V=0,D=u(2,-52),Y=u(2,-966);P>0;){var A;if(V>500)break;for(x=P-2;x>=-1&&-1!==x;x--)if(m(O[x])<=Y+D*(m(f[x])+m(f[x+1]))){O[x]=0;break}if(x===P-2)A=4;else{var _;for(_=P-1;_>=x&&_!==x;_--)if(g=(_!==P?m(O[_]):0)+(_!==x+1?m(O[_-1]):0),m(f[_])<=Y+D*g){f[_]=0;break}_===x?A=3:_===P-1?A=1:(A=2,x=_)}switch(x++,A){case 1:for(y=O[P-2],O[P-2]=0,p=P-2;p>=x;p--)for(g=M(f[p],y),v=f[p]/g,T=y/g,f[p]=g,p!==x&&(y=-T*O[p-1],O[p-1]=v*O[p-1]),d=0;d<h;d++)g=v*E[d*h+p]+T*E[d*h+P-1],E[d*h+P-1]=-T*E[d*h+p]+v*E[d*h+P-1],E[d*h+p]=g;break;case 2:for(y=O[x-1],O[x-1]=0,p=x;p<P;p++)for(g=M(f[p],y),v=f[p]/g,T=y/g,f[p]=g,y=-T*O[p],O[p]=v*O[p],d=0;d<s;d++)g=v*l[d*c+p]+T*l[d*c+x-1],l[d*c+x-1]=-T*l[d*c+p]+v*l[d*c+x-1],l[d*c+p]=g;break;case 3:var N=a(a(a(a(m(f[P-1]),m(f[P-2])),m(O[P-2])),m(f[x])),m(O[x])),R=f[P-1]/N,C=f[P-2]/N,S=O[P-2]/N,H=f[x]/N,z=O[x]/N,F=((C+R)*(C-R)+S*S)/2,q=R*S*(R*S),L=0;0===F&&0===q||(L=Math.sqrt(F*F+q),F<0&&(L=-L),L=q/(F+L)),y=(H+R)*(H-R)+L;var Z=H*z;for(p=x;p<P-1;p++){for(v=y/(g=M(y,Z)),T=Z/g,p!==x&&(O[p-1]=g),y=v*f[p]+T*O[p],O[p]=v*O[p]-T*f[p],Z=T*f[p+1],f[p+1]=v*f[p+1],d=0;d<h;d++)g=v*E[d*h+p]+T*E[d*h+p+1],E[d*h+p+1]=-T*E[d*h+p]+v*E[d*h+p+1],E[d*h+p]=g;if(g=M(y,Z),v=y/g,T=Z/g,f[p]=g,y=v*O[p]+T*f[p+1],f[p+1]=-T*O[p]+v*f[p+1],Z=T*O[p+1],O[p+1]=v*O[p+1],p<s-1)for(d=0;d<s;d++)g=v*l[d*c+p]+T*l[d*c+p+1],l[d*c+p+1]=-T*l[d*c+p]+v*l[d*c+p+1],l[d*c+p]=g}O[P-2]=y,V+=1;break;case 4:if(f[x]<=0)for(f[x]=f[x]<0?-f[x]:0,d=0;d<=X;d++)E[d*h+x]=-E[d*h+x];for(;x<X&&!(f[x]>=f[x+1]);){if(g=f[x],f[x]=f[x+1],f[x+1]=g,x<h-1)for(d=0;d<h;d++)g=E[d*h+x+1],E[d*h+x+1]=E[d*h+x],E[d*h+x]=g;if(x<s-1)for(d=0;d<s;d++)g=l[d*c+x+1],l[d*c+x+1]=l[d*c+x],l[d*c+x]=g;x++}V=0,P--;break;default:throw new Error("invalid kase: "+A)}}}var e=t("DOT/dot"),n=window.Float64Array||Array;return e.register("SingularValueDecomposition",i),i.prototype={constructor:i,getU:function(){return new e.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new e.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new e.Matrix(this.n,this.n),i=0;i<this.n;i++){for(var n=0;n<this.n;n++)t.entries[t.index(i,n)]=0;t.entries[t.index(i,i)]=this.s[i]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),i=Math.max(this.m,this.n)*this.s[0]*t,e=0,n=0;n<this.s.length;n++)this.s[n]>i&&e++;return e}},i.pseudoinverse=function(t){var n=new i(t),r=e.Matrix.diagonalMatrix(n.getSingularValues().map(function(t){return Math.abs(t)<1e-300?0:1/t}));return n.getV().times(r).times(n.getU().transpose())},i}),e("DOT/QRDecomposition",["require","DOT/dot"],function(t){"use strict";var i=t("DOT/dot"),e=window.Float64Array||Array;i.QRDecomposition=function(t){this.matrix=t,this.QR=t.getArrayCopy();var n=this.QR;this.m=t.getRowDimension();var r=this.m;this.n=t.getColumnDimension();var s=this.n;this.Rdiag=new e(s);var h,o,a;for(a=0;a<s;a++){var u=0;for(h=a;h<r;h++)u=i.Matrix.hypot(u,n[this.matrix.index(h,a)]);if(0!==u){for(n[this.matrix.index(a,a)]<0&&(u=-u),h=a;h<r;h++)n[this.matrix.index(h,a)]/=u;for(n[this.matrix.index(a,a)]+=1,o=a+1;o<s;o++){var m=0;for(h=a;h<r;h++)m+=n[this.matrix.index(h,a)]*n[this.matrix.index(h,o)];for(m=-m/n[this.matrix.index(a,a)],h=a;h<r;h++)n[this.matrix.index(h,o)]+=m*n[this.matrix.index(h,a)]}}this.Rdiag[a]=-u}};var n=i.QRDecomposition;return n.prototype={constructor:n,isFullRank:function(){for(var t=0;t<this.n;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new i.Matrix(this.m,this.n),e=0;e<this.m;e++)for(var n=0;n<this.n;n++)t.entries[t.index(e,n)]=e>=n?this.QR[this.matrix.index(e,n)]:0;return t},getR:function(){for(var t=new i.Matrix(this.n,this.n),e=0;e<this.n;e++)for(var n=0;n<this.n;n++)t.entries[t.index(e,n)]=e<n?this.QR[this.matrix.index(e,n)]:e===n?this.Rdiag[e]:0;return t},getQ:function(){var t,e,n,r=new i.Matrix(this.m,this.n);for(n=this.n-1;n>=0;n--){for(t=0;t<this.m;t++)r.entries[r.index(t,n)]=0;for(r.entries[r.index(n,n)]=1,e=n;e<this.n;e++)if(0!==this.QR[this.matrix.index(n,n)]){var s=0;for(t=n;t<this.m;t++)s+=this.QR[this.matrix.index(t,n)]*r.entries[r.index(t,e)];for(s=-s/this.QR[this.matrix.index(n,n)],t=n;t<this.m;t++)r.entries[r.index(t,e)]+=s*this.QR[this.matrix.index(t,n)]}}return r},solve:function(t){if(t.getRowDimension()!==this.m)throw new Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw new Error("Matrix is rank deficient.");var e,n,r,s=t.getColumnDimension(),h=t.getArrayCopy();for(r=0;r<this.n;r++)for(n=0;n<s;n++){var o=0;for(e=r;e<this.m;e++)o+=this.QR[this.matrix.index(e,r)]*h[t.index(e,n)];for(o=-o/this.QR[this.matrix.index(r,r)],e=r;e<this.m;e++)h[t.index(e,n)]+=o*this.QR[this.matrix.index(e,r)]}for(r=this.n-1;r>=0;r--){for(n=0;n<s;n++)h[t.index(r,n)]/=this.Rdiag[r];for(e=0;e<r;e++)for(n=0;n<s;n++)h[t.index(e,n)]-=h[t.index(r,n)]*this.QR[this.matrix.index(e,r)]}return new i.Matrix(this.n,s,h,!0).getMatrix(0,this.n-1,0,s-1)}},n}),e("DOT/Matrix",["require","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/EigenvalueDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){"use strict";function i(t,i,e,s){this.m=t,this.n=i;var h=t*i;this.size=h;var o;if(s)this.entries=e;else if(e||(e=0),this.entries=new n(h),r(e))for(o=0;o<h;o++)this.entries[o]=e[o];else for(o=0;o<h;o++)this.entries[o]=e}var e=t("DOT/dot"),n=window.Float64Array||Array,r=t("PHET_CORE/isArray");return t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/EigenvalueDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),e.register("Matrix",i),i.hypot=function(t,i){var e;return Math.abs(t)>Math.abs(i)?(e=i/t,e=Math.abs(t)*Math.sqrt(1+e*e)):0!==i?(e=t/i,e=Math.abs(i)*Math.sqrt(1+e*e)):e=0,e},i.prototype={constructor:i,copy:function(){for(var t=new i(this.m,this.n),e=0;e<this.size;e++)t.entries[e]=this.entries[e];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new n(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,i){return t*this.n+i},get:function(t,i){return this.entries[this.index(t,i)]},set:function(t,i,e){this.entries[this.index(t,i)]=e},getMatrix:function(t,e,n,r){for(var s=new i(e-t+1,r-n+1),h=t;h<=e;h++)for(var o=n;o<=r;o++)s.entries[s.index(h-t,o-n)]=this.entries[this.index(h,o)];return s},getArrayRowMatrix:function(t,e,n){for(var r=new i(t.length,n-e+1),s=0;s<t.length;s++)for(var h=e;h<=n;h++)r.entries[r.index(s,h-e)]=this.entries[this.index(t[s],h)];return r},transpose:function(t){t=t||new i(this.n,this.m);for(var e=0;e<this.m;e++)for(var n=0;n<this.n;n++)t.entries[t.index(n,e)]=this.entries[this.index(e,n)];return t},norm1:function(){for(var t=0,i=0;i<this.n;i++){for(var e=0,n=0;n<this.m;n++)e+=Math.abs(this.entries[this.index(n,i)]);t=Math.max(t,e)}return t},norm2:function(){return new e.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,i=0;i<this.m;i++){for(var e=0,n=0;n<this.n;n++)e+=Math.abs(this.entries[this.index(i,n)]);t=Math.max(t,e)}return t},normF:function(){for(var t=0,e=0;e<this.m;e++)for(var n=0;n<this.n;n++)t=i.hypot(t,this.entries[this.index(e,n)]);return t},uminus:function(){for(var t=new i(this.m,this.n),e=0;e<this.m;e++)for(var n=0;n<this.n;n++)t.entries[t.index(e,n)]=-this.entries[this.index(e,n)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var e=new i(this.m,this.n),n=0;n<this.m;n++)for(var r=0;r<this.n;r++){var s=e.index(n,r);e.entries[s]=this.entries[s]+t.entries[s]}return e},plusEquals:function(t){this.checkMatrixDimensions(t);for(var e=new i(this.m,this.n),n=0;n<this.m;n++)for(var r=0;r<this.n;r++){var s=e.index(n,r);this.entries[s]=this.entries[s]+t.entries[s]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var e=new i(this.m,this.n),n=0;n<this.m;n++)for(var r=0;r<this.n;r++){var s=this.index(n,r);e.entries[s]=this.entries[s]-t.entries[s]}return e},minusEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var e=0;e<this.n;e++){var n=this.index(i,e);this.entries[n]=this.entries[n]-t.entries[n]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var e=new i(this.m,this.n),n=0;n<this.m;n++)for(var r=0;r<this.n;r++){var s=e.index(n,r);e.entries[s]=this.entries[s]*t.entries[s]}return e},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var e=0;e<this.n;e++){var n=this.index(i,e);this.entries[n]=this.entries[n]*t.entries[n]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var e=new i(this.m,this.n),n=0;n<this.m;n++)for(var r=0;r<this.n;r++){var s=this.index(n,r);e.entries[s]=this.entries[s]/t.entries[s]}return e},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var e=0;e<this.n;e++){var n=this.index(i,e);this.entries[n]=this.entries[n]/t.entries[n]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var e=new i(this.m,this.n),n=0;n<this.m;n++)for(var r=0;r<this.n;r++){var s=this.index(n,r);e.entries[s]=t.entries[s]/this.entries[s]}return e},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;i<this.m;i++)for(var e=0;e<this.n;e++){var n=this.index(i,e);this.entries[n]=t.entries[n]/this.entries[n]}return this},times:function(t){var e,r,s,h,o,a;if(t.isMatrix){if((a=t).m!==this.n)throw new Error("Matrix inner dimensions must agree.");e=new i(this.m,a.n);var u=new n(this.n);for(s=0;s<a.n;s++){for(h=0;h<this.n;h++)u[h]=a.entries[a.index(h,s)];for(r=0;r<this.m;r++){for(o=0,h=0;h<this.n;h++)o+=this.entries[this.index(r,h)]*u[h];e.entries[e.index(r,s)]=o}}return e}for(o=t,e=new i(this.m,this.n),r=0;r<this.m;r++)for(s=0;s<this.n;s++)e.entries[e.index(r,s)]=o*this.entries[this.index(r,s)];return e},timesEquals:function(t){for(var i=0;i<this.m;i++)for(var e=0;e<this.n;e++){var n=this.index(i,e);this.entries[n]=t*this.entries[n]}return this},solve:function(t){return this.m===this.n?new e.LUDecomposition(this).solve(t):new e.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(i.identity(this.m,this.m))},det:function(){return new e.LUDecomposition(this).det()},rank:function(){return new e.SingularValueDecomposition(this).rank()},cond:function(){return new e.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,i=0;i<Math.min(this.m,this.n);i++)t+=this.entries[this.index(i,i)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw new Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var i=0;i<this.getRowDimension();i++){for(var e=0;e<this.getColumnDimension();e++)t+=this.get(i,e)+" ";t+="\n"}return t},extractVector2:function(t){return new e.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return new e.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return new e.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},setVectors3:function(t){for(var i=t.length,e=0;e<i;e++){var n=t[e];this.entries[e]=n.x,this.entries[e+i]=n.y,this.entries[e+2*i]=n.z}return this},isMatrix:!0},i.identity=function(t,e){for(var n=new i(t,e),r=0;r<t;r++)for(var s=0;s<e;s++)n.entries[n.index(r,s)]=r===s?1:0;return n},i.diagonalMatrix=function(t){for(var e=t.length,n=new i(e,e),r=0;r<e;r++)n.entries[n.index(r,r)]=t[r];return n},i.rowVector2=function(t){return new i(1,2,[t.x,t.y])},i.rowVector3=function(t){return new i(1,3,[t.x,t.y,t.z])},i.rowVector4=function(t){return new i(1,4,[t.x,t.y,t.z,t.w])},i.rowVector=function(t){if(t.isVector2)return i.rowVector2(t);if(t.isVector3)return i.rowVector3(t);if(t.isVector4)return i.rowVector4(t);throw new Error("undetected type of vector: "+t.toString())},i.columnVector2=function(t){return new i(2,1,[t.x,t.y])},i.columnVector3=function(t){return new i(3,1,[t.x,t.y,t.z])},i.columnVector4=function(t){return new i(4,1,[t.x,t.y,t.z,t.w])},i.columnVector=function(t){if(t.isVector2)return i.columnVector2(t);if(t.isVector3)return i.columnVector3(t);if(t.isVector4)return i.columnVector4(t);throw new Error("undetected type of vector: "+t.toString())},i.fromVectors2=function(t){for(var e=t.length,r=new n(2*e),s=0;s<e;s++){var h=t[s];r[s]=h.x,r[s+e]=h.y}return new i(2,e,r,!0)},i.fromVectors3=function(t){for(var e=t.length,r=new n(3*e),s=0;s<e;s++){var h=t[s];r[s]=h.x,r[s+e]=h.y,r[s+2*e]=h.z}return new i(3,e,r,!0)},i.fromVectors4=function(t){for(var e=t.length,r=new n(4*e),s=0;s<e;s++){var h=t[s];r[s]=h.x,r[s+e]=h.y,r[s+2*e]=h.z,r[s+3*e]=h.w}return new i(4,e,r,!0)},i}),e("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){"use strict";function i(t,i,e,r,s,h,o,a,u,m,c,f,l,d,p,x,g){this.entries=new n(16),this.rowMajor(void 0!==t?t:1,void 0!==i?i:0,void 0!==e?e:0,void 0!==r?r:0,void 0!==s?s:0,void 0!==h?h:1,void 0!==o?o:0,void 0!==a?a:0,void 0!==u?u:0,void 0!==m?m:0,void 0!==c?c:1,void 0!==f?f:0,void 0!==l?l:0,void 0!==d?d:0,void 0!==p?p:0,void 0!==x?x:1,g)}var e=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var n=window.Float32Array||Array;e.register("Matrix4",i);var r=i.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3,AFFINE:4};return i.identity=function(){return new i(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,r.IDENTITY)},i.translation=function(t,e,n){return new i(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1,r.TRANSLATION_3D)},i.translationFromVector=function(t){return i.translation(t.x,t.y,t.z)},i.scaling=function(t,e,n){return e=void 0===e?t:e,n=void 0===n?t:n,new i(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1,r.SCALING)},i.rotationAxisAngle=function(t,e){var n=Math.cos(e),s=Math.sin(e),h=1-n;return new i(t.x*t.x*h+n,t.x*t.y*h-t.z*s,t.x*t.z*h+t.y*s,0,t.y*t.x*h+t.z*s,t.y*t.y*h+n,t.y*t.z*h-t.x*s,0,t.z*t.x*h-t.y*s,t.z*t.y*h+t.x*s,t.z*t.z*h+n,0,0,0,0,1,r.AFFINE)},i.rotationX=function(t){var e=Math.cos(t),n=Math.sin(t);return new i(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1,r.AFFINE)},i.rotationY=function(t){var e=Math.cos(t),n=Math.sin(t);return new i(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1,r.AFFINE)},i.rotationZ=function(t){var e=Math.cos(t),n=Math.sin(t);return new i(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1,r.AFFINE)},i.gluPerspective=function(t,e,n,r){var s=Math.cos(t)/Math.sin(t);return new i(s/e,0,0,0,0,s,0,0,0,0,(r+n)/(n-r),2*r*n/(n-r),0,0,-1,0)},i.prototype={constructor:i,rowMajor:function(t,i,e,n,s,h,o,a,u,m,c,f,l,d,p,x,g){return this.entries[0]=t,this.entries[1]=s,this.entries[2]=u,this.entries[3]=l,this.entries[4]=i,this.entries[5]=h,this.entries[6]=m,this.entries[7]=d,this.entries[8]=e,this.entries[9]=o,this.entries[10]=c,this.entries[11]=p,this.entries[12]=n,this.entries[13]=a,this.entries[14]=f,this.entries[15]=x,this.type=void 0===g?0===l&&0===d&&0===p&&1===x?r.AFFINE:r.OTHER:g,this},columnMajor:function(t,i,e,n,r,s,h,o,a,u,m,c,f,l,d,p,x){return this.rowMajor(t,r,a,f,i,s,u,l,e,h,m,d,n,o,c,p,x)},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m03(),t.m10(),t.m11(),t.m12(),t.m13(),t.m20(),t.m21(),t.m22(),t.m23(),t.m30(),t.m31(),t.m32(),t.m33(),t.type)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m03())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m13())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())&&isFinite(this.m23())&&isFinite(this.m30())&&isFinite(this.m31())&&isFinite(this.m32())&&isFinite(this.m33())},getTranslation:function(){return new e.Vector3(this.m03(),this.m13(),this.m23())},get translation(){return this.getTranslation()},getScaleVector:function(){var t=this.m00()+this.m03(),i=this.m10()+this.m13(),n=this.m20()+this.m23(),r=this.m30()+this.m33(),s=this.m01()+this.m03(),h=this.m11()+this.m13(),o=this.m21()+this.m23(),a=this.m31()+this.m33(),u=this.m02()+this.m03(),m=this.m12()+this.m13(),c=this.m22()+this.m23(),f=this.m32()+this.m33();return new e.Vector3(Math.sqrt(t*t+i*i+n*n+r*r),Math.sqrt(s*s+h*h+o*o+a*a),Math.sqrt(u*u+m*m+c*c+f*f))},get scaleVector(){return this.getScaleVector()},getCSSTransform:function(){return"matrix3d("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[2].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[5].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+","+this.entries[8].toFixed(20)+","+this.entries[9].toFixed(20)+","+this.entries[10].toFixed(20)+","+this.entries[11].toFixed(20)+","+this.entries[12].toFixed(20)+","+this.entries[13].toFixed(20)+","+this.entries[14].toFixed(20)+","+this.entries[15].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m03()===t.m03()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m13()===t.m13()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()&&this.m23()===t.m23()&&this.m30()===t.m30()&&this.m31()===t.m31()&&this.m32()===t.m32()&&this.m33()===t.m33()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m03()-t.m03())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m13()-t.m13())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i&&Math.abs(this.m23()-t.m23())<i&&Math.abs(this.m30()-t.m30())<i&&Math.abs(this.m31()-t.m31())<i&&Math.abs(this.m32()-t.m32())<i&&Math.abs(this.m33()-t.m33())<i},copy:function(){return new i(this.m00(),this.m01(),this.m02(),this.m03(),this.m10(),this.m11(),this.m12(),this.m13(),this.m20(),this.m21(),this.m22(),this.m23(),this.m30(),this.m31(),this.m32(),this.m33(),this.type)},plus:function(t){return new i(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new i(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new i(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new i(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){switch(this.type){case r.IDENTITY:return this;case r.TRANSLATION_3D:return new i(1,0,0,-this.m03(),0,1,0,-this.m13(),0,0,1,-this.m23(),0,0,0,1,r.TRANSLATION_3D);case r.SCALING:return new i(1/this.m00(),0,0,0,0,1/this.m11(),0,0,0,0,1/this.m22(),0,0,0,0,1/this.m33(),r.SCALING);case r.AFFINE:case r.OTHER:var t=this.getDeterminant();if(0!==t)return new i((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===r.IDENTITY||t.type===r.IDENTITY)return this.type===r.IDENTITY?t:this;if(this.type===t.type){if(this.type===r.TRANSLATION_3D)return new i(1,0,0,this.m03()+t.m02(),0,1,0,this.m13()+t.m12(),0,0,1,this.m23()+t.m23(),0,0,0,1,r.TRANSLATION_3D);if(this.type===r.SCALING)return new i(this.m00()*t.m00(),0,0,0,0,this.m11()*t.m11(),0,0,0,0,this.m22()*t.m22(),0,0,0,0,1,r.SCALING)}return this.type!==r.OTHER&&t.type!==r.OTHER?new i(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23(),0,0,0,1,r.AFFINE):new i(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33())},timesVector4:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,r=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,s=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new e.Vector4(i,n,r,s)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var i=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,n=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,r=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,s=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new e.Vector4(i,n,r,s)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var i=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,n=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,r=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new e.Vector3(i,n,r)},getDeterminant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},get determinant(){return this.getDeterminant()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},makeImmutable:function(){this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")}}},(i.IDENTITY=new i).makeImmutable(),i}),e("DOT/Matrix3",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){"use strict";function i(t){this.entries=h(),this.type=o.IDENTITY}var e=t("DOT/dot"),n=t("PHET_CORE/Poolable"),r=e.FastArray;t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4");var s=new r(9);s[0]=1,s[4]=1,s[8]=1;var h=r===Array?function(){return[1,0,0,0,1,0,0,0,1]}:function(){return new r(s)};e.register("Matrix3",i);var o=i.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};return i.identity=function(){return i.dirtyFromPool().setToIdentity()},i.translation=function(t,e){return i.dirtyFromPool().setToTranslation(t,e)},i.translationFromVector=function(t){return i.translation(t.x,t.y)},i.scaling=function(t,e){return i.dirtyFromPool().setToScale(t,e)},i.scale=i.scaling,i.affine=function(t,e,n,r,s,h){return i.dirtyFromPool().setToAffine(t,e,n,r,s,h)},i.rowMajor=function(t,e,n,r,s,h,o,a,u,m){return i.dirtyFromPool().rowMajor(t,e,n,r,s,h,o,a,u,m)},i.rotationAxisAngle=function(t,e){return i.dirtyFromPool().setToRotationAxisAngle(t,e)},i.rotationX=function(t){return i.dirtyFromPool().setToRotationX(t)},i.rotationY=function(t){return i.dirtyFromPool().setToRotationY(t)},i.rotationZ=function(t){return i.dirtyFromPool().setToRotationZ(t)},i.translationRotation=function(t,e,n){return i.dirtyFromPool().setToTranslationRotation(t,e,n)},i.rotation2=i.rotationZ,i.rotationAround=function(t,e,n){return i.translation(e,n).timesMatrix(i.rotation2(t)).timesMatrix(i.translation(-e,-n))},i.rotationAroundPoint=function(t,e){return i.rotationAround(t,e.x,e.y)},i.fromSVGMatrix=function(t){return i.dirtyFromPool().setToSVGMatrix(t)},i.rotateAToB=function(t,e){return i.dirtyFromPool().setRotationAToB(t,e)},i.prototype={constructor:i,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isIdentity:function(){return this.type===o.IDENTITY||this.equals(i.IDENTITY)},isFastIdentity:function(){return this.type===o.IDENTITY},isAffine:function(){return this.type===o.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},isAligned:function(){return this.isAffine()&&0===this.m01()&&0===this.m10()},isAxisAligned:function(){return this.isAffine()&&(0===this.m01()&&0===this.m10()||0===this.m00()&&0===this.m11())},isFinite:function(){return isFinite(this.m00())&&isFinite(this.m01())&&isFinite(this.m02())&&isFinite(this.m10())&&isFinite(this.m11())&&isFinite(this.m12())&&isFinite(this.m20())&&isFinite(this.m21())&&isFinite(this.m22())},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new e.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new e.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){return Math.atan2(this.m10(),this.m00())},get rotation(){return this.getRotation()},toMatrix4:function(){return new e.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toAffineMatrix4:function(){return new e.Matrix4(this.m00(),this.m01(),0,this.m02(),this.m10(),this.m11(),0,this.m12(),0,0,1,0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){return"matrix("+this.entries[0].toFixed(20)+","+this.entries[1].toFixed(20)+","+this.entries[3].toFixed(20)+","+this.entries[4].toFixed(20)+","+this.entries[6].toFixed(20)+","+this.entries[7].toFixed(20)+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case o.IDENTITY:return"";case o.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+t(this.entries[7])+")";case o.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,i){return Math.abs(this.m00()-t.m00())<i&&Math.abs(this.m01()-t.m01())<i&&Math.abs(this.m02()-t.m02())<i&&Math.abs(this.m10()-t.m10())<i&&Math.abs(this.m11()-t.m11())<i&&Math.abs(this.m12()-t.m12())<i&&Math.abs(this.m20()-t.m20())<i&&Math.abs(this.m21()-t.m21())<i&&Math.abs(this.m22()-t.m22())<i},copy:function(){return i.createFromPool(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return i.createFromPool(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return i.createFromPool(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return i.createFromPool(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negated:function(){return i.createFromPool(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return i.createFromPool(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return i.createFromPool(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(0!==(t=this.getDeterminant()))return i.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(0!==(t=this.getDeterminant()))return i.createFromPool((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===o.IDENTITY||t.type===o.IDENTITY)return this.type===o.IDENTITY?t:this;if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return i.createFromPool(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return i.createFromPool(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?i.createFromPool(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):i.createFromPool(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02(),n=this.m10()*t.x+this.m11()*t.y+this.m12();return new e.Vector2(i,n)},timesVector3:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,r=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new e.Vector3(i,n,r)},timesTransposeVector2:function(t){var i=this.m00()*t.x+this.m10()*t.y,n=this.m01()*t.x+this.m11()*t.y;return new e.Vector2(i,n)},timesRelativeVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y,n=this.m10()*t.y+this.m11()*t.y;return new e.Vector2(i,n)},rowMajor:function(t,i,e,n,r,s,h,a,u,m){return this.entries[0]=t,this.entries[1]=n,this.entries[2]=h,this.entries[3]=i,this.entries[4]=r,this.entries[5]=a,this.entries[6]=e,this.entries[7]=s,this.entries[8]=u,this.type=void 0===m?0===h&&0===a&&1===u?o.AFFINE:o.OTHER:m,this},set:function(t){return this.rowMajor(t.m00(),t.m01(),t.m02(),t.m10(),t.m11(),t.m12(),t.m20(),t.m21(),t.m22(),t.type)},setArray:function(t){return this.rowMajor(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])},set00:function(t){return this.entries[0]=t,this},set01:function(t){return this.entries[3]=t,this},set02:function(t){return this.entries[6]=t,this},set10:function(t){return this.entries[1]=t,this},set11:function(t){return this.entries[4]=t,this},set12:function(t){return this.entries[7]=t,this},set20:function(t){return this.entries[2]=t,this},set21:function(t){return this.entries[5]=t,this},set22:function(t){return this.entries[8]=t,this},makeImmutable:function(){return this.rowMajor=function(){throw new Error("Cannot modify immutable matrix")},this},columnMajor:function(t,i,e,n,r,s,h,o,a,u){return this.rowMajor(t,n,h,i,r,o,e,s,a,u)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===o.IDENTITY||this.type===o.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case o.IDENTITY:return this;case o.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,o.TRANSLATION_2D);case o.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),o.SCALING);case o.AFFINE:if(0!==(t=this.getDeterminant()))return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,o.AFFINE);throw new Error("Matrix could not be inverted, determinant === 0");case o.OTHER:if(0!==(t=this.getDeterminant()))return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,o.OTHER);throw new Error("Matrix could not be inverted, determinant === 0");default:throw new Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(t.type===o.IDENTITY)return this;if(this.type===o.IDENTITY)return this.set(t);if(this.type===t.type){if(this.type===o.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,o.TRANSLATION_2D);if(this.type===o.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,o.SCALING)}return this.type!==o.OTHER&&t.type!==o.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,o.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},prependTranslation:function(t,i){return this.set02(this.m02()+t),this.set12(this.m12()+i),this.type===o.IDENTITY||this.type===o.TRANSLATION_2D?this.type=o.TRANSLATION_2D:this.type===o.OTHER?this.type=o.OTHER:this.type=o.AFFINE,this},setToIdentity:function(){return this.rowMajor(1,0,0,0,1,0,0,0,1,o.IDENTITY)},setToTranslation:function(t,i){return this.rowMajor(1,0,t,0,1,i,0,0,1,o.TRANSLATION_2D)},setToScale:function(t,i){return i=void 0===i?t:i,this.rowMajor(t,0,0,0,i,0,0,0,1,o.SCALING)},setToAffine:function(t,i,e,n,r,s){return this.rowMajor(t,i,e,n,r,s,0,0,1,o.AFFINE)},setToRotationAxisAngle:function(t,i){var e=Math.cos(i),n=Math.sin(i),r=1-e;return this.rowMajor(t.x*t.x*r+e,t.x*t.y*r-t.z*n,t.x*t.z*r+t.y*n,t.y*t.x*r+t.z*n,t.y*t.y*r+e,t.y*t.z*r-t.x*n,t.z*t.x*r-t.y*n,t.z*t.y*r+t.x*n,t.z*t.z*r+e,o.OTHER)},setToRotationX:function(t){var i=Math.cos(t),e=Math.sin(t);return this.rowMajor(1,0,0,0,i,-e,0,e,i,o.OTHER)},setToRotationY:function(t){var i=Math.cos(t),e=Math.sin(t);return this.rowMajor(i,0,e,0,1,0,-e,0,i,o.OTHER)},setToRotationZ:function(t){var i=Math.cos(t),e=Math.sin(t);return this.rowMajor(i,-e,0,e,i,0,0,0,1,o.AFFINE)},setToTranslationRotation:function(t,i,e){var n=Math.cos(e),r=Math.sin(e);return this.rowMajor(n,-r,t,r,n,i,0,0,1,o.AFFINE)},setToTranslationRotationPoint:function(t,i){return this.setToTranslationRotation(t.x,t.y,i)},setToSVGMatrix:function(t){return this.rowMajor(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,o.AFFINE)},setRotationAToB:function(t,i){var n,r,s=t,h=i,o=s.cross(h);if(n=s.dot(h),(n<0?-n:n)>.9999){var a,u,m,c=new e.Vector3(s.x>0?s.x:-s.x,s.y>0?s.y:-s.y,s.z>0?s.z:-s.z),f=(c=c.x<c.y?c.x<c.z?e.Vector3.X_UNIT:e.Vector3.Z_UNIT:c.y<c.z?e.Vector3.Y_UNIT:e.Vector3.Z_UNIT).minus(s);return o=c.minus(h),a=2/f.dot(f),u=2/o.dot(o),m=a*u*f.dot(o),this.rowMajor(-a*f.x*f.x-u*o.x*o.x+m*o.x*f.x+1,-a*f.x*f.y-u*o.x*o.y+m*o.x*f.y,-a*f.x*f.z-u*o.x*o.z+m*o.x*f.z,-a*f.y*f.x-u*o.y*o.x+m*o.y*f.x,-a*f.y*f.y-u*o.y*o.y+m*o.y*f.y+1,-a*f.y*f.z-u*o.y*o.z+m*o.y*f.z,-a*f.z*f.x-u*o.z*o.x+m*o.z*f.x,-a*f.z*f.y-u*o.z*o.y+m*o.z*f.y,-a*f.z*f.z-u*o.z*o.z+m*o.z*f.z+1)}var l,d,p,x,g;return r=1/(1+n),l=r*o.x,d=r*o.z,p=l*o.y,x=l*o.z,g=d*o.y,this.rowMajor(n+l*o.x,p-o.z,x+o.y,p+o.z,n+r*o.y*o.y,g-o.x,x-o.y,g+o.x,n+d*o.z)},setTo32Bit:function(){return window.Float32Array&&(this.entries=new window.Float32Array(this.entries)),this},setTo64Bit:function(){return window.Float64Array&&(this.entries=new window.Float64Array(this.entries)),this},multiplyVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y+this.m02(),this.m10()*t.x+this.m11()*t.y+this.m12())},multiplyVector3:function(t){return t.setXYZ(this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,this.m20()*t.x+this.m21()*t.y+this.m22()*t.z)},multiplyTransposeVector2:function(t){return t.setXY(this.m00()*t.x+this.m10()*t.y,this.m01()*t.x+this.m11()*t.y)},multiplyRelativeVector2:function(t){return t.setXY(this.m00()*t.x+this.m01()*t.y,this.m10()*t.y+this.m11()*t.y)},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==o.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},n.mixInto(i,{initialize:i.prototype.rowMajor,useDefaultConstruction:!0,maxSize:300}),(i.IDENTITY=i.identity()).makeImmutable(),(i.X_REFLECTION=i.createFromPool(-1,0,0,0,1,0,0,0,1,o.AFFINE)).makeImmutable(),(i.Y_REFLECTION=i.createFromPool(1,0,0,0,-1,0,0,0,1,o.AFFINE)).makeImmutable(),i.translationTimesMatrix=function(t,e,n){var r;return n.type===o.IDENTITY||n.type===o.TRANSLATION_2D?i.createFromPool(1,0,n.m02()+t,0,1,n.m12()+e,0,0,1,o.TRANSLATION_2D):(r=n.type===o.OTHER?o.OTHER:o.AFFINE,i.createFromPool(n.m00(),n.m01(),n.m02()+t,n.m10(),n.m11(),n.m12()+e,n.m20(),n.m21(),n.m22(),r))},i.printer={print:function(t){console.log(t.toString())}},i}),e("DOT/MatrixOps3",["require","DOT/dot"],function(t){"use strict";var i=t("DOT/dot"),e=Math.sqrt(.5),n={Array:i.FastArray,index3:function(t,i){return 3*t+i},set3:function(t,i){i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8]},transpose3:function(t,i){var e=t[3],n=t[6],r=t[1],s=t[7],h=t[2],o=t[5];i[0]=t[0],i[1]=e,i[2]=n,i[3]=r,i[4]=t[4],i[5]=s,i[6]=h,i[7]=o,i[8]=t[8]},det3:function(t){return t[0]*t[4]*t[8]+t[1]*t[5]*t[6]+t[2]*t[3]*t[7]-t[2]*t[4]*t[6]-t[1]*t[3]*t[8]-t[0]*t[5]*t[7]},mult3:function(t,i,e){var n=t[0]*i[0]+t[1]*i[3]+t[2]*i[6],r=t[0]*i[1]+t[1]*i[4]+t[2]*i[7],s=t[0]*i[2]+t[1]*i[5]+t[2]*i[8],h=t[3]*i[0]+t[4]*i[3]+t[5]*i[6],o=t[3]*i[1]+t[4]*i[4]+t[5]*i[7],a=t[3]*i[2]+t[4]*i[5]+t[5]*i[8],u=t[6]*i[0]+t[7]*i[3]+t[8]*i[6],m=t[6]*i[1]+t[7]*i[4]+t[8]*i[7],c=t[6]*i[2]+t[7]*i[5]+t[8]*i[8];e[0]=n,e[1]=r,e[2]=s,e[3]=h,e[4]=o,e[5]=a,e[6]=u,e[7]=m,e[8]=c},mult3LeftTranspose:function(t,i,e){var n=t[0]*i[0]+t[3]*i[3]+t[6]*i[6],r=t[0]*i[1]+t[3]*i[4]+t[6]*i[7],s=t[0]*i[2]+t[3]*i[5]+t[6]*i[8],h=t[1]*i[0]+t[4]*i[3]+t[7]*i[6],o=t[1]*i[1]+t[4]*i[4]+t[7]*i[7],a=t[1]*i[2]+t[4]*i[5]+t[7]*i[8],u=t[2]*i[0]+t[5]*i[3]+t[8]*i[6],m=t[2]*i[1]+t[5]*i[4]+t[8]*i[7],c=t[2]*i[2]+t[5]*i[5]+t[8]*i[8];e[0]=n,e[1]=r,e[2]=s,e[3]=h,e[4]=o,e[5]=a,e[6]=u,e[7]=m,e[8]=c},mult3RightTranspose:function(t,i,e){var n=t[0]*i[0]+t[1]*i[1]+t[2]*i[2],r=t[0]*i[3]+t[1]*i[4]+t[2]*i[5],s=t[0]*i[6]+t[1]*i[7]+t[2]*i[8],h=t[3]*i[0]+t[4]*i[1]+t[5]*i[2],o=t[3]*i[3]+t[4]*i[4]+t[5]*i[5],a=t[3]*i[6]+t[4]*i[7]+t[5]*i[8],u=t[6]*i[0]+t[7]*i[1]+t[8]*i[2],m=t[6]*i[3]+t[7]*i[4]+t[8]*i[5],c=t[6]*i[6]+t[7]*i[7]+t[8]*i[8];e[0]=n,e[1]=r,e[2]=s,e[3]=h,e[4]=o,e[5]=a,e[6]=u,e[7]=m,e[8]=c},mult3BothTranspose:function(t,i,e){var n=t[0]*i[0]+t[3]*i[1]+t[6]*i[2],r=t[0]*i[3]+t[3]*i[4]+t[6]*i[5],s=t[0]*i[6]+t[3]*i[7]+t[6]*i[8],h=t[1]*i[0]+t[4]*i[1]+t[7]*i[2],o=t[1]*i[3]+t[4]*i[4]+t[7]*i[5],a=t[1]*i[6]+t[4]*i[7]+t[7]*i[8],u=t[2]*i[0]+t[5]*i[1]+t[8]*i[2],m=t[2]*i[3]+t[5]*i[4]+t[8]*i[5],c=t[2]*i[6]+t[5]*i[7]+t[8]*i[8];e[0]=n,e[1]=r,e[2]=s,e[3]=h,e[4]=o,e[5]=a,e[6]=u,e[7]=m,e[8]=c},mult3Vector3:function(t,i,e){var n=t[0]*i.x+t[1]*i.y+t[2]*i.z,r=t[3]*i.x+t[4]*i.y+t[5]*i.z,s=t[6]*i.x+t[7]*i.y+t[8]*i.z;e.x=n,e.y=r,e.z=s},swapNegateColumn:function(t,i,e){var n=t[i],r=t[i+3],s=t[i+6];t[i]=t[e],t[i+3]=t[e+3],t[i+6]=t[e+6],t[e]=-n,t[e+3]=-r,t[e+6]=-s},setIdentity3:function(t){t[0]=t[4]=t[8]=1,t[1]=t[2]=t[3]=t[5]=t[6]=t[7]=0},setGivens3:function(t,i,e,n,r){this.setIdentity3(t),t[this.index3(n,n)]=i,t[this.index3(r,r)]=i,t[this.index3(n,r)]=e,t[this.index3(r,n)]=-e},preMult3Givens:function(t,i,e,n,r){var s=3*n,h=3*r,o=i*t[s+0]+e*t[h+0],a=i*t[h+0]-e*t[s+0],u=i*t[s+1]+e*t[h+1],m=i*t[h+1]-e*t[s+1],c=i*t[s+2]+e*t[h+2],f=i*t[h+2]-e*t[s+2];t[s+0]=o,t[h+0]=a,t[s+1]=u,t[h+1]=m,t[s+2]=c,t[h+2]=f},postMult3Givens:function(t,i,e,n,r){var s=i*t[n+0]+e*t[r+0],h=i*t[r+0]-e*t[n+0],o=i*t[n+3]+e*t[r+3],a=i*t[r+3]-e*t[n+3],u=i*t[n+6]+e*t[r+6],m=i*t[r+6]-e*t[n+6];t[n+0]=s,t[r+0]=h,t[n+3]=o,t[r+3]=a,t[n+6]=u,t[r+6]=m},applyJacobi3:function(t,i,n,r){var s=t[3*n+n],h=t[3*n+r],o=t[3*r+r],a=h*h,u=s-o,m=a<(u*=u),c=1/Math.sqrt(a+u),f=m?c*(s-o):e,l=m?c*h:e;this.preMult3Givens(t,f,l,n,r),this.postMult3Givens(t,f,l,n,r),this.preMult3Givens(i,f,l,n,r)},jacobiIteration3:function(t,i,e){for(var n=0;n<e;n++)this.applyJacobi3(t,i,0,1),this.applyJacobi3(t,i,0,2),this.applyJacobi3(t,i,1,2)},qrAnnihilate3:function(t,i,e,n){var r,s,h=i[this.index3(n,n)],o=i[this.index3(e,n)],a=h*h,u=o*o;if(a+u<1e-10)r=h>0?1:0,s=0;else{var m=1/Math.sqrt(a+u);r=m*h,s=m*o}this.preMult3Givens(i,r,s,n,e),this.postMult3Givens(t,r,s,n,e)},svd3:function(t,i,e,n,r){var s=e,h=r,o=n;this.mult3LeftTranspose(t,t,o),this.setIdentity3(s),this.jacobiIteration3(o,s,i),this.transpose3(s,h),this.mult3(t,h,o);var a,u=o[0]*o[0]+o[3]*o[3]+o[6]*o[6],m=o[1]*o[1]+o[4]*o[4]+o[7]*o[7],c=o[2]*o[2]+o[5]*o[5]+o[8]*o[8];u<m&&(a=u,u=m,m=a,this.swapNegateColumn(o,0,1),this.swapNegateColumn(h,0,1)),u<c&&(a=u,u=c,c=a,this.swapNegateColumn(o,0,2),this.swapNegateColumn(h,0,2)),m<c&&(this.swapNegateColumn(o,1,2),this.swapNegateColumn(h,1,2)),this.setIdentity3(s),this.qrAnnihilate3(s,o,1,0),this.qrAnnihilate3(s,o,2,0),this.qrAnnihilate3(s,o,2,1);s[0]*s[0]+s[1]*s[1]+s[2]*s[2]<.001&&(s[0]=1),s[3]*s[3]+s[4]*s[4]+s[5]*s[5]<.001&&(s[4]=1),s[6]*s[6]+s[7]*s[7]+s[8]*s[8]<.001&&(s[8]=1)},setVectors3:function(t,i){for(var e=t.length,n=0;n<e;n++){var r=t[n];i[n]=r.x,i[n+e]=r.y,i[n+2*e]=r.z}},getColumnVector3:function(t,i,e,n,r){r.x=e[n],r.y=e[n+i],r.z=e[n+2*i]},index:function(t,i,e,n){return i*e+n},transpose:function(t,i,e,n){for(var r=0;r<t;r++)for(var s=0;s<i;s++)n[t*s+r]=e[i*r+s]},mult:function(t,i,e,n,r,s){for(var h=0;h<t;h++)for(var o=0;o<e;o++){for(var a=0,u=0;u<i;u++)a+=n[this.index(t,i,h,u)]*r[this.index(i,e,u,o)];s[this.index(t,e,h,o)]=a}},multRightTranspose:function(t,i,e,n,r,s){for(var h=0;h<t;h++)for(var o=0;o<e;o++){for(var a=0,u=0;u<i;u++)a+=n[this.index(t,i,h,u)]*r[this.index(e,i,o,u)];s[this.index(t,e,h,o)]=a}},permuteColumns:function(t,i,e,n,r){for(var s=0;s<i;s++)for(var h=n.indices[s],o=0;o<t;o++)r[this.index(t,i,o,s)]=e[this.index(t,i,o,h)]}};return i.register("MatrixOps3",n),n}),e("DOT/Permutation",["require","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){"use strict";function i(t){this.indices=t}function e(t,i,n){if(0===t.length)n(i);else for(var r=0;r<t.length;r++){var s=t[r],h=t.slice(0);h.splice(r,1);var o=i.slice(0);o.push(s),e(h,o,n)}}var n=t("DOT/dot"),r=t("PHET_CORE/isArray");return t("DOT/Util"),n.register("Permutation",i),i.identity=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=n;return new i(e)},i.permutations=function(t){var e=[];return i.forEachPermutation(n.rangeInclusive(0,t-1),function(t){e.push(new i(t))}),e},i.forEachPermutation=function(t,i){e(t,[],i)},i.prototype={constructor:i,size:function(){return this.indices.length},apply:function(t){if(r(t)){if(t.length!==this.size())throw new Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var i=new Array(t.length),e=0;e<t.length;e++)i[e]=t[this.indices[e]];return i}return this.indices[t]},inverted:function(){for(var t=new Array(this.size()),e=0;e<this.size();e++)t[this.indices[e]]=e;return new i(t)},withIndicesPermuted:function(t){var e=[],n=this;return i.forEachPermutation(t,function(r){for(var s=n.indices,h=s.slice(0),o=0;o<t.length;o++)h[t[o]]=s[r[o]];e.push(new i(h))}),e},toString:function(){return"P["+this.indices.join(", ")+"]"}},i.testMe=function(t){var e=new i([1,4,3,2,0]);t.log(e.toString());var n=e.inverted();t.log(n.toString()),t.log(n.withIndicesPermuted([0,3,4]).toString()),t.log(i.permutations(4).toString())},i}),e("DOT/Plane3",["require","DOT/dot","DOT/Vector3"],function(t){"use strict";function i(t,i){this.normal=t,this.distance=i}var e=t("DOT/dot"),n=t("DOT/Vector3");return e.register("Plane3",i),i.prototype={constructor:i,intersectWithRay:function(t){return t.pointAtDistance(t.distanceToPlane(this))}},i.XY=new i(new n(0,0,1),0),i.XZ=new i(new n(0,1,0),0),i.YZ=new i(new n(1,0,0),0),i.fromTriangle=function(t,e,n){var r=n.minus(t).cross(e.minus(t));return 0===r.magnitude()?null:(r.normalize(),new i(r,r.dot(t)))},i}),e("DOT/Quaternion",["require","DOT/dot","PHET_CORE/Poolable","DOT/Vector3","DOT/Matrix3","DOT/Util"],function(t){"use strict";function i(t,i,e,n){this.setXYZW(t,i,e,n)}var e=t("DOT/dot"),n=t("PHET_CORE/Poolable");return t("DOT/Vector3"),t("DOT/Matrix3"),t("DOT/Util"),e.register("Quaternion",i),i.prototype={constructor:i,isQuaternion:!0,setXYZW:function(t,i,e,n){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.z=void 0!==e?e:0,this.w=void 0!==n?n:1},plus:function(t){return new i(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},timesScalar:function(t){return new i(this.x*t,this.y*t,this.z*t,this.w*t)},timesQuaternion:function(t){return new i(this.x*t.w-this.z*t.y+this.y*t.z+this.w*t.x,-this.x*t.z+this.y*t.w+this.z*t.x+this.w*t.y,this.x*t.y-this.y*t.x+this.z*t.w+this.w*t.z,-this.x*t.x-this.y*t.y-this.z*t.z+this.w*t.w)},timesVector3:function(t){return 0===t.magnitude()?new e.Vector3:new e.Vector3(this.w*this.w*t.x+2*this.y*this.w*t.z-2*this.z*this.w*t.y+this.x*this.x*t.x+2*this.y*this.x*t.y+2*this.z*this.x*t.z-this.z*this.z*t.x-this.y*this.y*t.x,2*this.x*this.y*t.x+this.y*this.y*t.y+2*this.z*this.y*t.z+2*this.w*this.z*t.x-this.z*this.z*t.y+this.w*this.w*t.y-2*this.x*this.w*t.z-this.x*this.x*t.y,2*this.x*this.z*t.x+2*this.y*this.z*t.y+this.z*this.z*t.z-2*this.w*this.y*t.x-this.y*this.y*t.z+2*this.w*this.x*t.y-this.x*this.x*t.z+this.w*this.w*t.z)},magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},normalized:function(){var t=this.magnitude();return this.timesScalar(1/t)},negated:function(){return new i(-this.x,-this.y,-this.z,-this.w)},toRotationMatrix:function(){var t=this.magnitudeSquared(),i=1===t?2:t>0?2/t:0,n=this.x*this.x*i,r=this.x*this.y*i,s=this.x*this.z*i,h=this.w*this.x*i,o=this.y*this.y*i,a=this.y*this.z*i,u=this.w*this.y*i,m=this.z*this.z*i,c=this.w*this.z*i;return e.Matrix3.dirtyFromPool().columnMajor(1-(o+m),r+c,s-u,r-c,1-(n+m),a+h,s+u,a-h,1-(n+o))}},i.fromEulerAngles=function(t,e,n){var r=Math.sin(.5*n),s=Math.cos(.5*n),h=Math.sin(.5*e),o=Math.cos(.5*e),a=Math.sin(.5*t),u=Math.cos(.5*t),m=o*s,c=h*r,f=o*r,l=h*s;return new i(m*a+c*u,l*u+f*a,f*u-l*a,m*u-c*a)},i.fromRotationMatrix=function(t){var e,n=t.m00(),r=t.m01(),s=t.m02(),h=t.m10(),o=t.m11(),a=t.m12(),u=t.m20(),m=t.m21(),c=t.m22(),f=n+o+c;return f>=0?(e=Math.sqrt(f+1),new i(.5*(m-a)/e,.5*(s-u)/e,.5*(h-r)/e,.5*e)):n>o&&n>c?(e=Math.sqrt(1+n-o-c),new i(.5*e,.5*(h+r)/e,.5*(s+u)/e,.5*(m-a)/e)):o>c?(e=Math.sqrt(1+o-n-c),new i(.5*(h+r)/e,.5*e,.5*(m+a)/e,.5*(s-u)/e)):(e=Math.sqrt(1+c-n-o),new i(.5*(s+u)/e,.5*(m+a)/e,.5*e,.5*(h-r)/e))},i.getRotationQuaternion=function(t,n){return i.fromRotationMatrix(e.Matrix3.rotateAToB(t,n))},i.slerp=function(t,e,n){if(t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w)return t;var r=t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w;r<0&&(e=e.negated(),r=-r);var s=1-n,h=n;if(1-r>.1){var o=Math.acos(r),a=1/Math.sin(o);s=Math.sin((1-n)*o)*a,h=Math.sin(n*o)*a}return new i(s*t.x+h*e.x,s*t.y+h*e.y,s*t.z+h*e.z,s*t.w+h*e.w)},n.mixInto(i,{initialize:i.prototype.setXYZW}),i}),e("DOT/Random",["require","DOT/dot","PHET_CORE/inherit","DOT/Util"],function(t){"use strict";function i(t){null!==(t=_.extend({seed:null,staticSeed:!1},t)).seed&&t.staticSeed;var i=t.staticSeed?window.phet.chipper.randomSeed:t.seed;this.setSeed(i)}var e=t("DOT/dot"),n=t("PHET_CORE/inherit"),r=t("DOT/Util");return n(Object,i,{setSeed:function(t){this.seed=t,this.seedrandom=null!==this.seed?new Math.seedrandom(this.seed+""):null},nextBoolean:function(){return this.nextDouble()>=.5},nextInt:function(t){return 0|this.nextDouble()*t},nextIntBetween:function(t,i){var e=i-t;return this.nextInt(e+1)+t},sample:function(t){return t[this.nextIntBetween(0,t.length-1)]},shuffle:function(t){var i=this,e=-1,n=new Array(t.length);return _.forEach(t,function(t){var r=i.nextIntBetween(0,++e);n[e]=n[r],n[r]=t}),n},nextDouble:function(){return null===this.seed?Math.random():this.seedrandom()},nextGaussian:function(){return r.boxMullerTransform(0,1,this)}}),e.register("Random",i),i}),e("DOT/Range",["require","DOT/dot"],function(t){"use strict";function i(t,i){this.min=t,this.max=i}return t("DOT/dot").register("Range",i),i.prototype={constructor:i,copy:function(){return new i(this.min,this.max)},getLength:function(){return this.max-this.min},getCenter:function(){return(this.max+this.min)/2},contains:function(t){return t>=this.min&&t<=this.max},containsRange:function(t){return this.min<=t.min&&this.max>=t.max},intersects:function(t){return this.max>=t.min&&t.max>=this.min},intersectsExclusive:function(t){return this.max>t.min&&t.max>this.min},toString:function(){return"[Range (min:"+this.min+" max:"+this.max+")]"},constrainValue:function(t){return Math.min(Math.max(t,this.min),this.max)},equals:function(t){return this.min===t.min&&this.max===t.max}},i}),e("DOT/Ray2",["require","DOT/dot"],function(t){"use strict";function i(t,i){this.position=t,this.direction=i}return t("DOT/dot").register("Ray2",i),i.prototype={constructor:i,shifted:function(t){return new i(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},toString:function(){return this.position.toString()+" => "+this.direction.toString()}},i}),e("DOT/Ray3",["require","DOT/dot"],function(t){"use strict";function i(t,i){this.position=t,this.direction=i}return t("DOT/dot").register("Ray3",i),i.prototype={constructor:i,shifted:function(t){return new i(this.pointAtDistance(t),this.direction)},pointAtDistance:function(t){return this.position.plus(this.direction.timesScalar(t))},distanceToPlane:function(t){return(t.distance-this.position.dot(t.normal))/this.direction.dot(t.normal)},toString:function(){return this.position.toString()+" => "+this.direction.toString()}},i}),e("DOT/Rectangle",["require","DOT/Bounds2","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function i(t,i,n,r){e.call(this,t,i,t+n,i+r)}var e=t("DOT/Bounds2"),n=t("DOT/dot"),r=t("PHET_CORE/inherit");return n.register("Rectangle",i),r(e,i),i}),e("DOT/Sphere3",["require","DOT/dot","PHET_CORE/inherit"],function(t){"use strict";function i(t,i){this.center=t,this.radius=i}var e=t("DOT/dot"),n=t("PHET_CORE/inherit");return e.register("Sphere3",i),n(Object,i,{intersect:function(t,i){var e=t.direction,n=t.position,r=n.minus(this.center),s=e.dot(r),h=4*s*s-4*(r.magnitudeSquared()-this.radius*this.radius);if(h<i)return null;var o=e.dot(this.center)-e.dot(n),a=Math.sqrt(h)/2,u=o-a,m=o+a;if(m<i)return null;var c=t.pointAtDistance(m),f=c.minus(this.center).normalized();if(u<i)return{distance:m,hitPoint:c,normal:f.negated(),fromOutside:!1};var l=t.pointAtDistance(u);return{distance:u,hitPoint:l,normal:l.minus(this.center).normalized(),fromOutside:!0}},intersections:function(t,i){var e=t.direction,n=t.position,r=n.minus(this.center),s=e.dot(r),h=4*s*s-4*(r.magnitudeSquared()-this.radius*this.radius);if(h<i)return[];var o=e.dot(this.center)-e.dot(n),a=Math.sqrt(h)/2,u=o-a,m=o+a;if(m<i)return[];var c=t.pointAtDistance(m),f=c.minus(this.center).normalized(),l=t.pointAtDistance(u),d=l.minus(this.center).normalized(),p={distance:m,hitPoint:c,normal:f.negated(),fromOutside:!1},x={distance:u,hitPoint:l,normal:d,fromOutside:!0};return u<i?[p,x]:[x,p]}}),i}),e("DOT/Transform3",["require","DOT/dot","AXON/Events","PHET_CORE/inherit","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){"use strict";function i(t){n.call(this),this.matrix=e.Matrix3.IDENTITY.copy(),this.inverse=e.Matrix3.IDENTITY.copy(),this.matrixTransposed=e.Matrix3.IDENTITY.copy(),this.inverseTransposed=e.Matrix3.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,t&&this.setMatrix(t)}var e=t("DOT/dot"),n=t("AXON/Events"),r=t("PHET_CORE/inherit");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2");var s=new e.Matrix3;return e.register("Transform3",i),r(n,i,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.trigger0("change")},prepend:function(t){s.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(s),this.invalidate()},prependTranslation:function(t,i){this.matrix.prependTranslation(t,i),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new i(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===e.Matrix3.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){var i=this.getMatrix();return new e.Vector2(i.m00()*t.x+i.m01()*t.y,i.m10()*t.x+i.m11()*t.y)},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t).normalize()},transformX:function(t){var i=this.getMatrix();return i.m00()*t+i.m02()},transformY:function(t){var i=this.getMatrix();return i.m11()*t+i.m12()},transformDeltaX:function(t){return this.getMatrix().m00()*t},transformDeltaY:function(t){return this.getMatrix().m11()*t},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new e.Ray2(this.transformPosition2(t.position),this.transformDelta2(t.direction).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){var i=this.getInverse();return new e.Vector2(i.m00()*t.x+i.m01()*t.y,i.m10()*t.x+i.m11()*t.y)},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t).normalize()},inverseX:function(t){var i=this.getInverse();return i.m00()*t+i.m02()},inverseY:function(t){var i=this.getInverse();return i.m11()*t+i.m12()},inverseDeltaX:function(t){var i=this.getInverse();return i.m00()*t},inverseDeltaY:function(t){var i=this.getInverse();return i.m11()*t},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new e.Ray2(this.inversePosition2(t.position),this.inverseDelta2(t.direction).normalized())}}),i}),e("DOT/Transform4",["require","DOT/dot","AXON/Events","PHET_CORE/inherit","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){"use strict";function i(t){n.call(this),this.matrix=e.Matrix4.IDENTITY.copy(),this.inverse=e.Matrix4.IDENTITY.copy(),this.matrixTransposed=e.Matrix4.IDENTITY.copy(),this.inverseTransposed=e.Matrix4.IDENTITY.copy(),this.inverseValid=!0,this.transposeValid=!0,this.inverseTransposeValid=!0,t&&this.setMatrix(t)}var e=t("DOT/dot"),n=t("AXON/Events"),r=t("PHET_CORE/inherit");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3");var s=new e.Matrix4;return e.register("Transform4",i),r(n,i,{setMatrix:function(t){this.matrix.set(t),this.invalidate()},invalidate:function(){this.inverseValid=!1,this.transposeValid=!1,this.inverseTransposeValid=!1,this.trigger0("change")},prepend:function(t){s.set(this.matrix),this.matrix.set(t),this.matrix.multiplyMatrix(s),this.invalidate()},append:function(t){this.matrix.multiplyMatrix(t),this.invalidate()},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},copy:function(){var t=new i(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed,t.inverseValid=this.inverseValid,t.transposeValid=this.transposeValid,t.inverseTransposeValid=this.inverseTransposeValid},getMatrix:function(){return this.matrix},getInverse:function(){return this.inverseValid||(this.inverseValid=!0,this.inverse.set(this.matrix),this.inverse.invert()),this.inverse},getMatrixTransposed:function(){return this.transposeValid||(this.transposeValid=!0,this.matrixTransposed.set(this.matrix),this.matrixTransposed.transpose()),this.matrixTransposed},getInverseTransposed:function(){return this.inverseTransposeValid||(this.inverseTransposeValid=!0,this.inverseTransposed.set(this.getInverse()),this.inverseTransposed.transpose()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===e.Matrix4.Types.IDENTITY},isFinite:function(){return this.matrix.isFinite()},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new e.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new e.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new e.Vector3(0,0,t)).z},transformRay:function(t){return new e.Ray3(this.transformPosition3(t.position),this.transformPosition3(t.position.plus(t.direction)).minus(this.transformPosition3(t.position)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(e.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new e.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new e.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new e.Vector3(0,0,t)).z},inverseRay:function(t){return new e.Ray3(this.inversePosition3(t.position),this.inversePosition3(t.position.plus(t.direction)).minus(this.inversePosition3(t.position)))}}),i}),e("DOT/main",["DOT/dot","DOT/BinPacker","DOT/Bounds2","DOT/Bounds3","DOT/Complex","DOT/ConvexHull2","DOT/DampedHarmonic","DOT/DelaunayTriangulation","DOT/Dimension2","DOT/EigenvalueDecomposition","DOT/LinearFunction","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/MatrixOps3","DOT/Permutation","DOT/Plane3","DOT/QRDecomposition","DOT/Quaternion","DOT/Random","DOT/Range","DOT/Ray2","DOT/Ray3","DOT/Rectangle","DOT/SingularValueDecomposition","DOT/Sphere3","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){"use strict";return t}),e("PHET_CORE/arrayDifference",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i,e,n,r){e=e||[],n=n||[],r=r||[],Array.prototype.push.apply(e,t),Array.prototype.push.apply(n,i);t:for(var s=0;s<e.length;s++)for(var h=e[s],o=0;o<n.length;o++){if(h===n[o]){if(r.push(h),e.splice(s,1),n.splice(o,1),o=0,s===e.length)break t;s-=1}}return e}return t("PHET_CORE/phetCore").register("arrayDifference",i),i}),e("PHET_CORE/collect",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){var i=[];return t(function(t){i.push(t)}),i}return t("PHET_CORE/phetCore").register("collect",i),i}),e("PHET_CORE/detectPrefix",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){return void 0!==t[i]?i:(i=i.charAt(0).toUpperCase()+i.slice(1),void 0!==t["moz"+i]?"moz"+i:void 0!==t["Moz"+i]?"Moz"+i:void 0!==t["webkit"+i]?"webkit"+i:void 0!==t["ms"+i]?"ms"+i:void 0!==t["o"+i]?"o"+i:void 0)}return t("PHET_CORE/phetCore").register("detectPrefix",i),i}),e("PHET_CORE/detectPrefixEvent",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i,e){return void 0!==t["on"+i]?i:void 0!==t["onmoz"+i]?"moz"+i:void 0!==t["onMoz"+i]?"Moz"+i:void 0!==t["onwebkit"+i]?"webkit"+i:void 0!==t["onms"+i]?"ms"+i:void 0!==t["ono"+i]?"o"+i:void 0}return t("PHET_CORE/phetCore").register("detectPrefixEvent",i),i}),e("PHET_CORE/dimensionForEach",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i,e){function n(t,i){return i.forEach(function(i,s){r.push(s),1===t?e.apply(null,[i].concat(r)):n(t-1,i),r.pop()})}var r=[];return n(t,i)}return t("PHET_CORE/phetCore").register("dimensionForEach",i),i}),e("PHET_CORE/dimensionMap",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i,e){function n(t,i){return i.map(function(i,s){r.push(s);var h=1===t?e.apply(null,[i].concat(r)):n(t-1,i);return r.pop(),h})}var r=[];return n(t,i)}return t("PHET_CORE/phetCore").register("dimensionMap",i),i}),e("PHET_CORE/escapeHTML",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;").replace(/\'/g,"&#x27;").replace(/\//g,"&#x2F;")}return t("PHET_CORE/phetCore").register("escapeHTML",i),i}),e("PHET_CORE/EventTimer",["require","PHET_CORE/inherit","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){this.eventModel=t,this.eventCallback=i,this.period=this.eventModel.getPeriodBeforeNextEvent(),this.timeBeforeNextEvent=this.period}var e=t("PHET_CORE/inherit");return t("PHET_CORE/phetCore").register("EventTimer",i),e(Object,i,{step:function(t){for(;t>=this.timeBeforeNextEvent;)t-=this.timeBeforeNextEvent,this.period=this.eventModel.getPeriodBeforeNextEvent(),this.timeBeforeNextEvent=this.period,this.eventCallback(t);this.timeBeforeNextEvent-=t},getRatio:function(){return(this.period-this.timeBeforeNextEvent)/this.period}}),i.ConstantEventModel=e(Object,function(t){this.rate=t},{getPeriodBeforeNextEvent:function(){return 1/this.rate}}),i.UniformEventModel=e(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return 2*t/this.rate}}),i.PoissonEventModel=e(Object,function(t,i){this.rate=t,this.pseudoRandomNumberSource=i},{getPeriodBeforeNextEvent:function(){var t=this.pseudoRandomNumberSource();return-Math.log(t)/this.rate}}),i}),e("PHET_CORE/extendDefined",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var e in i){var n=Object.getOwnPropertyDescriptor(i,e);!n||"function"!=typeof n.get&&void 0===i[e]||Object.defineProperty(t,e,n)}}),t}return t("PHET_CORE/phetCore").register("extendDefined",i),i}),e("PHET_CORE/inheritance",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){for(var i=[t],e=t.prototype;e&&(e=Object.getPrototypeOf(e));)e.constructor&&i.push(e.constructor);return i}return t("PHET_CORE/phetCore").register("inheritance",i),i}),e("PHET_CORE/interleave",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){for(var e=[],n=2*t.length-1,r=0;r<n;r++)r%2==0?e.push(t[r/2]):e.push(i((r-1)/2));return e}return t("PHET_CORE/phetCore").register("interleave",i),i}),e("PHET_CORE/loadScript",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){"string"==typeof t&&(t={src:t});var i=t.src,e=t.callback,n=void 0===t.async||t.async,r=void 0!==t.cacheBuster&&t.cacheBuster,s=!1,h=document.createElement("script");h.type="text/javascript",h.async=n,h.onload=h.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||s||(s=!0,e&&e())},h.src=i+(r?"?random="+Math.random().toFixed(10):"");var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(h,o)}return t("PHET_CORE/phetCore").register("loadScript",i),i}),e("PHET_CORE/mixedWith",["require","PHET_CORE/inherit","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){i=Array.prototype.slice.call(arguments,1);var n=t.name;i.forEach(function(t){n=n+"_"+t.name.replace(/bound /g,"_")});var r=[],s=new Function("return function( suptype, inits ) {  return function "+n+"() {    var self = this;    var args = Array.prototype.slice.call( arguments );    suptype.apply( this, args );    inits.forEach( function( init ) { init.apply( self, args ); } );  };};")()(t,r);return e(t,s),i.forEach(function(t){var i=t(s);"function"==typeof i&&r.push(i)}),s}var e=t("PHET_CORE/inherit");return t("PHET_CORE/phetCore").register("mixedWith",i),i}),e("PHET_CORE/pairs",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){var i=[],e=t.length;if(e>1)for(var n=0;n<e-1;n++)for(var r=t[n],s=n+1;s<e;s++)i.push([r,t[s]]);return i}return t("PHET_CORE/phetCore").register("pairs",i),i}),e("PHET_CORE/partition",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t,i){for(var e=[],n=[],r=t.length,s=0;s<r;s++)i(t[s])?e.push(t[s]):n.push(t[s]);return[e,n]}return t("PHET_CORE/phetCore").register("partition",i),i}),e("PHET_CORE/platform",["require","PHET_CORE/phetCore"],function(t){"use strict";function i(t){return n()===t}function e(){return!(!s.match(/(iPod|iPhone|iPad)/)||!s.match(/AppleWebKit/))}function n(){var t=-1;return"Microsoft Internet Explorer"===navigator.appName?null!==new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(s)&&(t=parseFloat(RegExp.$1)):"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(s)&&(t=parseFloat(RegExp.$1)),t}var r=t("PHET_CORE/phetCore"),s=navigator.userAgent,h={firefox:s.toLowerCase().indexOf("firefox")>-1,mobileSafari:e(),safari5:!!(s.match(/Version\/5\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari6:!!(s.match(/Version\/6\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari7:!!(s.match(/Version\/7\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari10:!!(s.match(/Version\/10\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari11:!!(s.match(/Version\/11\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari9:!!(s.match(/Version\/9\./)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),safari:e()||!!(s.match(/Version\//)&&s.match(/Safari\//)&&s.match(/AppleWebKit/)),ie:-1!==n(),ie9:i(9),ie10:i(10),ie11:i(11),android:s.indexOf("Android")>0,edge:!!s.match(/Edge\//),chromium:/chrom(e|ium)/.test(s.toLowerCase())&&!s.match(/Edge\//)};return r.register("platform",h),h}),e("PHET_CORE/timer",["require","AXON/Emitter","PHET_CORE/phetCore"],t=>{"use strict";const i=t("AXON/Emitter");class e extends i{setTimeout(t,i){let e=0;const n=r=>{1e3*(e+=r)>=i&&(t(),this.removeListener(n))};return this.addListener(n),n}clearTimeout(t){this.hasListener(t)&&this.removeListener(t)}setInterval(t,i){let e=0;const n=r=>{for(e+=r;1e3*e>=i&&-1!==this.hasListener(n);)t(),e-=i/1e3};return this.addListener(n),n}clearInterval(t){this.hasListener(t)&&this.removeListener(t)}}return t("PHET_CORE/phetCore").register("timer",new e)}),e("PHET_CORE/main",["PHET_CORE/phetCore","PHET_CORE/arrayDifference","PHET_CORE/arrayRemove","PHET_CORE/cleanArray","PHET_CORE/collect","PHET_CORE/detectPrefix","PHET_CORE/detectPrefixEvent","PHET_CORE/dimensionForEach","PHET_CORE/dimensionMap","PHET_CORE/escapeHTML","PHET_CORE/EventTimer","PHET_CORE/extend","PHET_CORE/extendDefined","PHET_CORE/inherit","PHET_CORE/inheritance","PHET_CORE/interleave","PHET_CORE/isArray","PHET_CORE/loadScript","PHET_CORE/mixedWith","PHET_CORE/Namespace","PHET_CORE/pairs","PHET_CORE/partition","PHET_CORE/platform","PHET_CORE/Poolable","PHET_CORE/timer"],function(t){"use strict";return t}),function(){"use strict";if(!window.hasOwnProperty("_"))throw new Error("Underscore/Lodash not found: _");e("dot-main",["require","AXON/main","DOT/main","PHET_CORE/main"],function(t){window.axon=t("AXON/main"),window.dot=t("DOT/main"),window.phetCore=t("PHET_CORE/main")})}(),window.axon=i("AXON/main"),window.dot=i("DOT/main"),window.phetCore=i("PHET_CORE/main")}();