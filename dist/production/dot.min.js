(function(){var t,i,s;(function(n){function r(t,i){return w.call(t,i)}function e(t,i){var s,n,r,e,h,m,o,a,u,c,f=i&&i.split("/"),x=v.map,l=x&&x["*"]||{};if(t&&"."===t.charAt(0))if(i){for(f=f.slice(0,f.length-1),t=f.concat(t.split("/")),a=0;t.length>a;a+=1)if(c=t[a],"."===c)t.splice(a,1),a-=1;else if(".."===c){if(1===a&&(".."===t[2]||".."===t[0]))break;a>0&&(t.splice(a-1,2),a-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((f||l)&&x){for(s=t.split("/"),a=s.length;a>0;a-=1){if(n=s.slice(0,a).join("/"),f)for(u=f.length;u>0;u-=1)if(r=x[f.slice(0,u).join("/")],r&&(r=r[n])){e=r,h=a;break}if(e)break;!m&&l&&l[n]&&(m=l[n],o=a)}!e&&m&&(e=m,h=o),e&&(s.splice(0,h,e),t=s.join("/"))}return t}function h(t,i){return function(){return x.apply(n,g.call(arguments,0).concat([t,i]))}}function m(t){return function(i){return e(i,t)}}function o(t){return function(i){y[t]=i}}function a(t){if(r(p,t)){var i=p[t];delete p[t],T[t]=!0,f.apply(n,i)}if(!r(y,t)&&!r(T,t))throw Error("No "+t);return y[t]}function u(t){var i,s=t?t.indexOf("!"):-1;return s>-1&&(i=t.substring(0,s),t=t.substring(s+1,t.length)),[i,t]}function c(t){return function(){return v&&v.config&&v.config[t]||{}}}var f,x,l,d,y={},p={},v={},T={},w=Object.prototype.hasOwnProperty,g=[].slice;l=function(t,i){var s,n=u(t),r=n[0];return t=n[1],r&&(r=e(r,i),s=a(r)),r?t=s&&s.normalize?s.normalize(t,m(i)):e(t,i):(t=e(t,i),n=u(t),r=n[0],t=n[1],r&&(s=a(r))),{f:r?r+"!"+t:t,n:t,pr:r,p:s}},d={require:function(t){return h(t)},exports:function(t){var i=y[t];return i!==void 0?i:y[t]={}},module:function(t){return{id:t,uri:"",exports:y[t],config:c(t)}}},f=function(t,i,s,e){var m,u,c,f,x,v,w=[];if(e=e||t,"function"==typeof s){for(i=!i.length&&s.length?["require","exports","module"]:i,x=0;i.length>x;x+=1)if(f=l(i[x],e),u=f.f,"require"===u)w[x]=d.require(t);else if("exports"===u)w[x]=d.exports(t),v=!0;else if("module"===u)m=w[x]=d.module(t);else if(r(y,u)||r(p,u)||r(T,u))w[x]=a(u);else{if(!f.p)throw Error(t+" missing "+u);f.p.load(f.n,h(e,!0),o(u),{}),w[x]=y[u]}c=s.apply(y[t],w),t&&(m&&m.exports!==n&&m.exports!==y[t]?y[t]=m.exports:c===n&&v||(y[t]=c))}else t&&(y[t]=s)},t=i=x=function(t,i,s,r,e){return"string"==typeof t?d[t]?d[t](i):a(l(t,i).f):(t.splice||(v=t,i.splice?(t=i,i=s,s=null):t=n),i=i||function(){},"function"==typeof s&&(s=r,r=e),r?f(n,t,i,s):setTimeout(function(){f(n,t,i,s)},4),x)},x.config=function(t){return v=t,v.deps&&x(v.deps,v.callback),x},s=function(t,i,s){i.splice||(s=i,i=[]),r(y,t)||r(p,t)||(p[t]=[t,i,s])},s.amd={jQuery:!0}})(),s("almond",function(){}),s("DOT/dot",["require"],function(){return function t(){switch(arguments.length){case 2:return new t.Vector2(arguments[0],arguments[1]);case 3:return new t.Vector3(arguments[0],arguments[1],arguments[2]);case 4:return new t.Vector4(arguments[0],arguments[1],arguments[2],arguments[3]);default:throw Error("dot takes 2-4 arguments")}}}),s("ASSERT/assert",["require"],function(){var t=function(t,i){var s="assert."+t,n=window.has&&void 0!==window.has(s),r=n?!window.has(s):i;return r?null:function(t,i){var s="function"==typeof t?t():t;if(!s)throw Error("Assertion failed: "+i)}};return t}),s("PHET_CORE/extend",["require"],function(){return function(t){return _.each(Array.prototype.slice.call(arguments,1),function(i){if(i)for(var s in i)Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(i,s))}),t}}),s("PHET_CORE/inherit",["require","PHET_CORE/extend"],function(t){function i(t,i,n){function r(){}r.prototype=i.prototype,t.prototype=s(new r,{constructor:t},n)}var s=t("PHET_CORE/extend");return i}),s("DOT/Util",["require","ASSERT/assert","DOT/dot"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot");s.Util={testAssert:function(){return"assert.dot: "+(i?"true":"false")},clamp:function(t,i,s){return i>t?i:t>s?s:t},rangeInclusive:function(t,i){if(t>i)return[];for(var s=Array(i-t+1),n=t;i>=n;n++)s[n-t]=n;return s},rangeExclusive:function(t,i){return n.rangeInclusive(t+1,i-1)},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},lineLineIntersection:function(t,i,n,r){return new s.Vector2(((t.x*i.y-t.y*i.x)*(n.x-r.x)-(t.x-i.x)*(n.x*r.y-n.y*r.x))/((t.x-i.x)*(n.y-r.y)-(t.y-i.y)*(n.x-r.x)),((t.x*i.y-t.y*i.x)*(n.y-r.y)-(t.y-i.y)*(n.x*r.y-n.y*r.x))/((t.x-i.x)*(n.y-r.y)-(t.y-i.y)*(n.x-r.x)))},solveQuadraticRootsReal:function(t,i,s){var n=i*i-4*t*s;if(0>n)return[];var r=Math.sqrt(n);return[(-i-r)/(2*t),(-i+r)/(2*t)]},solveCubicRootsReal:function(t,i,s,r){if(0===t)return n.solveQuadraticRootsReal(i,s,r);if(0===r)return n.solveQuadraticRootsReal(t,i,s);i/=t,s/=t,r/=t;var e=(3*s-i*i)/9,h=(-(27*r)+i*(9*s-2*i*i))/54,m=e*e*e+h*h,o=i/3;if(m>0){var a=Math.sqrt(m);return[n.cubeRoot(h+a)+n.cubeRoot(h-a)-o]}if(0===m){var u=n.cubeRoot(h),c=o-u;return[-o+2*u,c,c]}var f=-e*e*e;f=Math.acos(h/Math.sqrt(f));var x=2*Math.sqrt(-e);return[-o+x*Math.cos(f/3),-o+x*Math.cos((f+2*Math.PI)/3),-o+x*Math.cos((f+4*Math.PI)/3)]},cubeRoot:function(t){return t>=0?Math.pow(t,1/3):-Math.pow(-t,1/3)},linear:function(t,i,s,n,r){return(n-i)/(s-t)*(r-t)+i}};var n=s.Util;return s.testAssert=n.testAssert,s.clamp=n.clamp,s.rangeInclusive=n.rangeInclusive,s.rangeExclusive=n.rangeExclusive,s.toRadians=n.toRadians,s.toDegrees=n.toDegrees,n}),s("DOT/Vector2",["require","ASSERT/assert","DOT/dot","PHET_CORE/inherit","DOT/Util"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot"),n=t("PHET_CORE/inherit");t("DOT/Util"),s.Vector2=function r(t,s){this.x=t||0,this.y=s||0,i&&i("number"==typeof this.x,"x needs to be a number"),i&&i("number"==typeof this.y,"y needs to be a number")};var r=s.Vector2;r.createPolar=function(t,i){return new r(t*Math.cos(i),t*Math.sin(i))},r.prototype={constructor:r,isVector2:!0,dimension:2,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y},equals:function(t){return this.x===t.x&&this.y===t.y},equalsEpsilon:function(t,i){return i||(i=0),i>=Math.max(Math.abs(this.x-t.x),Math.abs(this.y-t.y))},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)},copy:function(){return new this.constructor(this.x,this.y)},crossScalar:function(t){return this.x*t.y-this.y*t.x},normalized:function(){var t=this.magnitude();if(0===t)throw Error("Cannot normalize a zero-magnitude vector");return new this.constructor(this.x/t,this.y/t)},timesScalar:function(t){return new this.constructor(this.x*t,this.y*t)},times:function(t){return i&&i(void 0===t.dimension),this.timesScalar(t)},componentTimes:function(t){return new this.constructor(this.x*t.x,this.y*t.y)},plus:function(t){return new this.constructor(this.x+t.x,this.y+t.y)},plusScalar:function(t){return new this.constructor(this.x+t,this.y+t)},minus:function(t){return new this.constructor(this.x-t.x,this.y-t.y)},minusScalar:function(t){return new this.constructor(this.x-t,this.y-t)},dividedScalar:function(t){return new this.constructor(this.x/t,this.y/t)},negated:function(){return new this.constructor(-this.x,-this.y)},angle:function(){return Math.atan2(this.y,this.x)},perpendicular:function(){return new this.constructor(this.y,-this.x)},angleBetween:function(t){return Math.acos(s.clamp(this.normalized().dot(t.normalized()),-1,1))},rotated:function(t){var i=this.angle()+t;return new this.constructor(Math.cos(i),Math.sin(i)).timesScalar(this.getMagnitude())},blend:function(t,i){return this.plus(t.minus(this).times(i))},toString:function(){return"Vector2("+this.x+", "+this.y+")"},toVector3:function(){return new s.Vector3(this.x,this.y)},set:function(t,i){return this.x=t,this.y=i,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},addScalar:function(t){return this.x+=t,this.y+=t,this},subtract:function(t){return this.x-=t.x,this.y-=t.y,this},subtractScalar:function(t){return this.x-=t,this.y-=t,this},componentMultiply:function(t){return this.x*=t.x,this.y*=t.y,this},divideScalar:function(t){return this.x/=t,this.y/=t,this},negate:function(){return this.x=-this.x,this.y=-this.y,this}},r.Immutable=function(t,i){r.call(this,t,i)};var e=r.Immutable;return n(e,r),e.mutableOverrideHelper=function(t){e.prototype[t]=function(){throw Error("Cannot call mutable method '"+t+"' on immutable Vector2")}},e.mutableOverrideHelper("set"),e.mutableOverrideHelper("setX"),e.mutableOverrideHelper("setY"),e.mutableOverrideHelper("copy"),e.mutableOverrideHelper("add"),e.mutableOverrideHelper("addScalar"),e.mutableOverrideHelper("subtract"),e.mutableOverrideHelper("subtractScalar"),e.mutableOverrideHelper("componentMultiply"),e.mutableOverrideHelper("divideScalar"),e.mutableOverrideHelper("negate"),r.ZERO=new e(0,0),r.X_UNIT=new e(1,0),r.Y_UNIT=new e(0,1),r}),s("DOT/Bounds2",["require","ASSERT/assert","DOT/dot","DOT/Vector2"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot");t("DOT/Vector2"),s.Bounds2=function n(t,s,n,r){i&&i(void 0!==r,"Bounds2 requires 4 parameters"),this.minX=t,this.minY=s,this.maxX=n,this.maxY=r};var n=s.Bounds2;return n.prototype={constructor:n,getWidth:function(){return this.maxX-this.minX},get width(){return this.getWidth()},getHeight:function(){return this.maxY-this.minY},get height(){return this.getHeight()},getX:function(){return this.minX},get x(){return this.getX()},getY:function(){return this.minY},get y(){return this.getY()},getCenter:function(){return new s.Vector2(this.getCenterX(),this.getCenterY())},get center(){return this.getCenter()},getCenterX:function(){return(this.maxX+this.minX)/2},get centerX(){return this.getCenterX()},getCenterY:function(){return(this.maxY+this.minY)/2},get centerY(){return this.getCenterY()},getMinX:function(){return this.minX},getMinY:function(){return this.minY},getMaxX:function(){return this.maxX},getMaxY:function(){return this.maxY},isEmpty:function(){return 0>this.getWidth()||0>this.getHeight()},isFinite:function(){return isFinite(this.minX)&&isFinite(this.minY)&&isFinite(this.maxX)&&isFinite(this.maxY)},isValid:function(){return!this.isEmpty()&&this.isFinite()},containsCoordinates:function(t,i){return t>=this.minX&&this.maxX>=t&&i>=this.minY&&this.maxY>=i},containsPoint:function(t){return this.containsCoordinates(t.x,t.y)},containsBounds:function(t){return this.minX<=t.minX&&this.maxX>=t.maxX&&this.minY<=t.minY&&this.maxY>=t.maxY},intersectsBounds:function(t){return!this.intersection(t).isEmpty()},toString:function(){return"[x:("+this.minX+","+this.maxX+"),y:("+this.minY+","+this.maxY+")]"},equals:function(t){return this.minX===t.minX&&this.minY===t.minY&&this.maxX===t.maxX&&this.maxY===t.maxY},copy:function(){return new n(this.minX,this.minY,this.maxX,this.maxY)},union:function(t){return new n(Math.min(this.minX,t.minX),Math.min(this.minY,t.minY),Math.max(this.maxX,t.maxX),Math.max(this.maxY,t.maxY))},intersection:function(t){return new n(Math.max(this.minX,t.minX),Math.max(this.minY,t.minY),Math.min(this.maxX,t.maxX),Math.min(this.maxY,t.maxY))},withCoordinates:function(t,i){return new n(Math.min(this.minX,t),Math.min(this.minY,i),Math.max(this.maxX,t),Math.max(this.maxY,i))},withPoint:function(t){return this.withCoordinates(t.x,t.y)},withMinX:function(t){return new n(t,this.minY,this.maxX,this.maxY)},withMinY:function(t){return new n(this.minX,t,this.maxX,this.maxY)},withMaxX:function(t){return new n(this.minX,this.minY,t,this.maxY)},withMaxY:function(t){return new n(this.minX,this.minY,this.maxX,t)},roundedOut:function(){return new n(Math.floor(this.minX),Math.floor(this.minY),Math.ceil(this.maxX),Math.ceil(this.maxY))},roundedIn:function(){return new n(Math.ceil(this.minX),Math.ceil(this.minY),Math.floor(this.maxX),Math.floor(this.maxY))},transformed:function(t){return this.copy().transform(t)},dilated:function(t){return new n(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},eroded:function(t){return this.dilated(-t)},shiftedX:function(t){return new n(this.minX+t,this.minY,this.maxX+t,this.maxY)},shiftedY:function(t){return new n(this.minX,this.minY+t,this.maxX,this.maxY+t)},shifted:function(t,i){return new n(this.minX+t,this.minY+i,this.maxX+t,this.maxY+i)},set:function(t,i,s,n){return this.minX=t,this.minY=i,this.maxX=s,this.maxY=n,this},setBounds:function(t){return this.set(t.minX,t.minY,t.maxX,t.maxY)},includeBounds:function(t){return this.minX=Math.min(this.minX,t.minX),this.minY=Math.min(this.minY,t.minY),this.maxX=Math.max(this.maxX,t.maxX),this.maxY=Math.max(this.maxY,t.maxY),this},constrainBounds:function(t){return this.minX=Math.max(this.minX,t.minX),this.minY=Math.max(this.minY,t.minY),this.maxX=Math.min(this.maxX,t.maxX),this.maxY=Math.min(this.maxY,t.maxY),this},addCoordinates:function(t,i){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i),this},addPoint:function(t){return this.addCoordinates(t.x,t.y)},setMinX:function(t){return this.minX=t,this},setMinY:function(t){return this.minY=t,this},setMaxX:function(t){return this.maxX=t,this},setMaxY:function(t){return this.maxY=t,this},roundOut:function(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this},roundIn:function(){return this.minX=Math.ceil(this.minX),this.minY=Math.ceil(this.minY),this.maxX=Math.floor(this.maxX),this.maxY=Math.floor(this.maxY),this},transform:function(t){if(this.isEmpty())return this;var i=this.minX,r=this.minY,e=this.maxX,h=this.maxY,m=new s.Vector2;return this.setBounds(n.NOTHING),this.addPoint(t.multiplyVector2(m.set(i,r))),this.addPoint(t.multiplyVector2(m.set(i,h))),this.addPoint(t.multiplyVector2(m.set(e,r))),this.addPoint(t.multiplyVector2(m.set(e,h))),this},dilate:function(t){return this.set(this.minX-t,this.minY-t,this.maxX+t,this.maxY+t)},erode:function(t){return this.dilate(-t)},shiftX:function(t){return this.setMinX(this.minX+t).setMaxX(this.maxX+t)},shiftY:function(t){return this.setMinY(this.minY+t).setMaxY(this.maxY+t)},shift:function(t,i){return this.shiftX(t).shiftY(i)}},n.EVERYTHING=new n(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),n.NOTHING=new n(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n}),s("DOT/Complex",["require","ASSERT/assert","DOT/dot","PHET_CORE/inherit","DOT/Vector2"],function(t){t("ASSERT/assert")("dot");var i=t("DOT/dot"),s=t("PHET_CORE/inherit"),n=t("DOT/Vector2");i.Complex=function r(t,i){n.call(this,t,i),this.real=t,this.imaginary=i};var r=i.Complex;return r.real=function(t){return new r(t,0)},r.imaginary=function(t){return new r(0,t)},r.createPolar=function(t,i){return new r(t*Math.cos(i),t*Math.sin(i))},s(r,n.Immutable,{phase:n.prototype.angle,times:function(t){return new r(this.real*t.real-this.imaginary*t.imaginary,this.real*t.imaginary+this.imaginary*t.real)},dividedBy:function(t){var i=t.magnitudeSquared();return new r((this.real*t.real+this.imaginary*t.imaginary)/i,(this.imaginary*t.real-this.real*t.imaginary)/i)},sqrt:function(){var t=this.magnitude();return new r(Math.sqrt((t+this.real)/2),(this.imaginary>=0?1:-1)*Math.sqrt((t-this.real)/2))},conjugate:function(){return new r(this.real,-this.imaginary)},exponentiated:function(){return r.createPolar(Math.exp(this.real),this.imaginary)},toString:function(){return"Complex("+this.x+", "+this.y+")"}}),r.ZERO=new r(0,0),r.ONE=new r(1,0),r.I=new r(0,1),r}),s("DOT/ConvexHull2",["require","ASSERT/assert","DOT/dot"],function(t){function i(t,i,s){return i.minus(t).crossScalar(s.minus(t))}t("ASSERT/assert")("dot");var s=t("DOT/dot");return s.ConvexHull2={grahamScan:function(t,s){if(2>=t.length)return t;var n=Number.POSITIVE_INFINITY,r=null;_.each(t,function(t){n>=t.y&&(t.y===n&&r?t.x<r.x&&(r=t):(n=t.y,r=t))}),t=_.sortBy(t,function(t){return t.minus(r).angle()}),t.splice(_.indexOf(t,r),1);var e=[r];return _.each(t,function(t){function n(){if(2>e.length)return!1;var n=i(e[e.length-2],e[e.length-1],t);return s?0>n:0>=n}if(r.x!==t.x||r.y!==t.y){for(;n();)e.pop();e.push(t)}}),e}},s.ConvexHull2}),s("DOT/Dimension2",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Dimension2=function s(t,i){this.width=t,this.height=i};var s=i.Dimension2;return s.prototype={constructor:s,toString:function(){return"["+this.width+"w, "+this.height+"h]"},equals:function(t){return this.width===t.width&&this.height===t.height}},s}),s("DOT/LUDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),s=window.Float32Array||Array;i.LUDecomposition=function n(t){var i,n,r;this.matrix=t,this.LU=t.getArrayCopy();var e=this.LU;this.m=t.getRowDimension();var h=this.m;this.n=t.getColumnDimension();var m=this.n;for(this.piv=new Uint32Array(h),i=0;h>i;i++)this.piv[i]=i;this.pivsign=1;var o=new s(h);for(n=0;m>n;n++){for(i=0;h>i;i++)o[i]=e[t.index(i,n)];for(i=0;h>i;i++){var a=Math.min(i,n),u=0;for(r=0;a>r;r++){var c=t.index(i,r);u+=e[c]*o[r]}o[i]-=u,e[t.index(i,n)]=o[i]}var f=n;for(i=n+1;h>i;i++)Math.abs(o[i])>Math.abs(o[f])&&(f=i);if(f!==n){for(r=0;m>r;r++){var x=t.index(f,r),l=t.index(n,r),d=e[x];e[x]=e[l],e[l]=d}r=this.piv[f],this.piv[f]=this.piv[n],this.piv[n]=r,this.pivsign=-this.pivsign}if(h>n&&0!==e[this.matrix.index(n,n)])for(i=n+1;h>i;i++)e[t.index(i,n)]/=e[t.index(n,n)]}};var n=i.LUDecomposition;return n.prototype={constructor:n,isNonsingular:function(){for(var t=0;this.n>t;t++){var i=this.matrix.index(t,t);if(0===this.LU[i])return!1}return!0},getL:function(){for(var t=new i.Matrix(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++)t.entries[t.index(s,n)]=s>n?this.LU[this.matrix.index(s,n)]:s===n?1:0;return t},getU:function(){for(var t=new i.Matrix(this.n,this.n),s=0;this.n>s;s++)for(var n=0;this.n>n;n++)t.entries[t.index(s,n)]=n>=s?this.LU[this.matrix.index(s,n)]:0;return t},getPivot:function(){for(var t=new Uint32Array(this.m),i=0;this.m>i;i++)t[i]=this.piv[i];return t},getDoublePivot:function(){for(var t=new s(this.m),i=0;this.m>i;i++)t[i]=this.piv[i];return t},det:function(){if(this.m!==this.n)throw Error("Matrix must be square.");for(var t=this.pivsign,i=0;this.n>i;i++)t*=this.LU[this.matrix.index(i,i)];return t},solve:function(t){var i,s,n;if(t.getRowDimension()!==this.m)throw Error("Matrix row dimensions must agree.");if(!this.isNonsingular())throw Error("Matrix is singular.");var r=t.getColumnDimension(),e=t.getArrayRowMatrix(this.piv,0,r-1);for(n=0;this.n>n;n++)for(i=n+1;this.n>i;i++)for(s=0;r>s;s++)e.entries[e.index(i,s)]-=e.entries[e.index(n,s)]*this.LU[this.matrix.index(i,n)];for(n=this.n-1;n>=0;n--){for(s=0;r>s;s++)e.entries[e.index(n,s)]/=this.LU[this.matrix.index(n,n)];for(i=0;n>i;i++)for(s=0;r>s;s++)e.entries[e.index(i,s)]-=e.entries[e.index(n,s)]*this.LU[this.matrix.index(i,n)]}return e}},n}),s("PHET_CORE/isArray",["require"],function(){return function(t){return"[object Array]"===Object.prototype.toString.call(t)}}),s("DOT/SingularValueDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),s=window.Float32Array||Array;i.SingularValueDecomposition=function n(t){this.matrix=t;var n=t,r=n.getArrayCopy();this.m=n.getRowDimension(),this.n=n.getColumnDimension();var e=this.m,h=this.n,m=Math.min,o=Math.max,a=Math.pow,u=Math.abs,c=m(e,h);this.s=new s(m(e+1,h));var f=this.s;this.U=new s(e*c);var x=this.U;this.V=new s(h*h);var l,d,y,p,v,T,w,g=this.V,D=new s(h),O=new s(e),M=!0,E=!0,I=i.Matrix.hypot,S=m(e-1,h),V=o(0,m(h-2,e));for(y=0;o(S,V)>y;y++){if(S>y){for(f[y]=0,l=y;e>l;l++)f[y]=I(f[y],r[l*h+y]);if(0!==f[y]){for(0>r[y*h+y]&&(f[y]=-f[y]),l=y;e>l;l++)r[l*h+y]/=f[y];r[y*h+y]+=1}f[y]=-f[y]}for(d=y+1;h>d;d++){if(S>y&&0!==f[y]){for(p=0,l=y;e>l;l++)p+=r[l*h+y]*r[l*h+d];for(p=-p/r[y*h+y],l=y;e>l;l++)r[l*h+d]+=p*r[l*h+y]}D[d]=r[y*h+d]}if(M&&S>y)for(l=y;e>l;l++)x[l*c+y]=r[l*h+y];if(V>y){for(D[y]=0,l=y+1;h>l;l++)D[y]=I(D[y],D[l]);if(0!==D[y]){for(0>D[y+1]&&(D[y]=-D[y]),l=y+1;h>l;l++)D[l]/=D[y];D[y+1]+=1}if(D[y]=-D[y],e>y+1&&0!==D[y]){for(l=y+1;e>l;l++)O[l]=0;for(d=y+1;h>d;d++)for(l=y+1;e>l;l++)O[l]+=D[d]*r[l*h+d];for(d=y+1;h>d;d++)for(p=-D[d]/D[y+1],l=y+1;e>l;l++)r[l*h+d]+=p*O[l]}if(E)for(l=y+1;h>l;l++)g[l*h+y]=D[l]}}var R=m(h,e+1);if(h>S&&(f[S]=r[S*h+S]),R>e&&(f[R-1]=0),R>V+1&&(D[V]=r[V*h+R-1]),D[R-1]=0,M){for(d=S;c>d;d++){for(l=0;e>l;l++)x[l*c+d]=0;x[d*c+d]=1}for(y=S-1;y>=0;y--)if(0!==f[y]){for(d=y+1;c>d;d++){for(p=0,l=y;e>l;l++)p+=x[l*c+y]*x[l*c+d];for(p=-p/x[y*c+y],l=y;e>l;l++)x[l*c+d]+=p*x[l*c+y]}for(l=y;e>l;l++)x[l*c+y]=-x[l*c+y];for(x[y*c+y]=1+x[y*c+y],l=0;y-1>l;l++)x[l*c+y]=0}else{for(l=0;e>l;l++)x[l*c+y]=0;x[y*c+y]=1}}if(E)for(y=h-1;y>=0;y--){if(V>y&&0!==D[y])for(d=y+1;c>d;d++){for(p=0,l=y+1;h>l;l++)p+=g[l*h+y]*g[l*h+d];for(p=-p/g[y+1*h+y],l=y+1;h>l;l++)g[l*h+d]+=p*g[l*h+y]}for(l=0;h>l;l++)g[l*h+y]=0;g[y*h+y]=1}for(var z=R-1,Y=0,b=a(2,-52),N=a(2,-966);R>0;){var A;for(y=R-2;y>=-1&&-1!==y;y--)if(u(D[y])<=N+b*(u(f[y])+u(f[y+1]))){D[y]=0;break}if(y===R-2)A=4;else{var X;for(X=R-1;X>=y&&X!==y;X--)if(p=(X!==R?u(D[X]):0)+(X!==y+1?u(D[X-1]):0),N+b*p>=u(f[X])){f[X]=0;break}X===y?A=3:X===R-1?A=1:(A=2,y=X)}switch(y++,A){case 1:for(v=D[R-2],D[R-2]=0,d=R-2;d>=y;d--)if(p=I(f[d],v),T=f[d]/p,w=v/p,f[d]=p,d!==y&&(v=-w*D[d-1],D[d-1]=T*D[d-1]),E)for(l=0;h>l;l++)p=T*g[l*h+d]+w*g[l*h+R-1],g[l*h+R-1]=-w*g[l*h+d]+T*g[l*h+R-1],g[l*h+d]=p;break;case 2:for(v=D[y-1],D[y-1]=0,d=y;R>d;d++)if(p=I(f[d],v),T=f[d]/p,w=v/p,f[d]=p,v=-w*D[d],D[d]=T*D[d],M)for(l=0;e>l;l++)p=T*x[l*c+d]+w*x[l*c+y-1],x[l*c+y-1]=-w*x[l*c+d]+T*x[l*c+y-1],x[l*c+d]=p;break;case 3:var C=o(o(o(o(u(f[R-1]),u(f[R-2])),u(D[R-2])),u(f[y])),u(D[y])),H=f[R-1]/C,P=f[R-2]/C,_=D[R-2]/C,q=f[y]/C,F=D[y]/C,L=((P+H)*(P-H)+_*_)/2,U=H*_*H*_,j=0;(0!==L||0!==U)&&(j=Math.sqrt(L*L+U),0>L&&(j=-j),j=U/(L+j)),v=(q+H)*(q-H)+j;var k=q*F;for(d=y;R-1>d;d++){if(p=I(v,k),T=v/p,w=k/p,d!==y&&(D[d-1]=p),v=T*f[d]+w*D[d],D[d]=T*D[d]-w*f[d],k=w*f[d+1],f[d+1]=T*f[d+1],E)for(l=0;h>l;l++)p=T*g[l*h+d]+w*g[l*h+d+1],g[l*h+d+1]=-w*g[l*h+d]+T*g[l*h+d+1],g[l*h+d]=p;if(p=I(v,k),T=v/p,w=k/p,f[d]=p,v=T*D[d]+w*f[d+1],f[d+1]=-w*D[d]+T*f[d+1],k=w*D[d+1],D[d+1]=T*D[d+1],M&&e-1>d)for(l=0;e>l;l++)p=T*x[l*c+d]+w*x[l*c+d+1],x[l*c+d+1]=-w*x[l*c+d]+T*x[l*c+d+1],x[l*c+d]=p}D[R-2]=v,Y+=1;break;case 4:if(0>=f[y]&&(f[y]=0>f[y]?-f[y]:0,E))for(l=0;z>=l;l++)g[l*h+y]=-g[l*h+y];for(;z>y&&!(f[y]>=f[y+1]);){if(p=f[y],f[y]=f[y+1],f[y+1]=p,E&&h-1>y)for(l=0;h>l;l++)p=g[l*h+y+1],g[l*h+y+1]=g[l*h+y],g[l*h+y]=p;if(M&&e-1>y)for(l=0;e>l;l++)p=x[l*c+y+1],x[l*c+y+1]=x[l*c+y],x[l*c+y]=p;y++}Y=0,R--}}};var n=i.SingularValueDecomposition;n.prototype={constructor:n,getU:function(){return new i.Matrix(this.m,Math.min(this.m+1,this.n),this.U,!0)},getV:function(){return new i.Matrix(this.n,this.n,this.V,!0)},getSingularValues:function(){return this.s},getS:function(){for(var t=new i.Matrix(this.n,this.n),s=0;this.n>s;s++){for(var n=0;this.n>n;n++)t.entries[t.index(s,n)]=0;t.entries[t.index(s,s)]=this.s[s]}return t},norm2:function(){return this.s[0]},cond:function(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},rank:function(){for(var t=Math.pow(2,-23),i=Math.max(this.m,this.n)*this.s[0]*t,s=0,n=0;this.s.length>n;n++)this.s[n]>i&&s++;return s}}}),s("DOT/QRDecomposition",["require","DOT/dot"],function(t){var i=t("DOT/dot"),s=window.Float32Array||Array;i.QRDecomposition=function n(t){this.matrix=t,this.QR=t.getArrayCopy();var n=this.QR;this.m=t.getRowDimension();var r=this.m;this.n=t.getColumnDimension();var e=this.n;this.Rdiag=new s(e);var h,m,o;for(o=0;e>o;o++){var a=0;for(h=o;r>h;h++)a=i.Matrix.hypot(a,n[this.matrix.index(h,o)]);if(0!==a){for(0>n[this.matrix.index(o,o)]&&(a=-a),h=o;r>h;h++)n[this.matrix.index(h,o)]/=a;for(n[this.matrix.index(o,o)]+=1,m=o+1;e>m;m++){var u=0;for(h=o;r>h;h++)u+=n[this.matrix.index(h,o)]*n[this.matrix.index(h,m)];for(u=-u/n[this.matrix.index(o,o)],h=o;r>h;h++)n[this.matrix.index(h,m)]+=u*n[this.matrix.index(h,o)]}}this.Rdiag[o]=-a}};var n=i.QRDecomposition;return n.prototype={constructor:n,isFullRank:function(){for(var t=0;this.n>t;t++)if(0===this.Rdiag[t])return!1;return!0},getH:function(){for(var t=new i.Matrix(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++)t.entries[t.index(s,n)]=s>=n?this.QR[this.matrix.index(s,n)]:0;return t},getR:function(){for(var t=new i.Matrix(this.n,this.n),s=0;this.n>s;s++)for(var n=0;this.n>n;n++)t.entries[t.index(s,n)]=n>s?this.QR[this.matrix.index(s,n)]:s===n?this.Rdiag[s]:0;return t},getQ:function(){var t,s,n,r=new i.Matrix(this.m,this.n);for(n=this.n-1;n>=0;n--){for(t=0;this.m>t;t++)r.entries[r.index(t,n)]=0;for(r.entries[r.index(n,n)]=1,s=n;this.n>s;s++)if(0!==this.QR[this.matrix.index(n,n)]){var e=0;for(t=n;this.m>t;t++)e+=this.QR[this.matrix.index(t,n)]*r.entries[r.index(t,s)];for(e=-e/this.QR[this.matrix.index(n,n)],t=n;this.m>t;t++)r.entries[r.index(t,s)]+=e*this.QR[this.matrix.index(t,n)]}}return r},solve:function(t){if(t.getRowDimension()!==this.m)throw Error("Matrix row dimensions must agree.");if(!this.isFullRank())throw Error("Matrix is rank deficient.");var s,n,r,e=t.getColumnDimension(),h=t.getArrayCopy();for(r=0;this.n>r;r++)for(n=0;e>n;n++){var m=0;for(s=r;this.m>s;s++)m+=this.QR[this.matrix.index(s,r)]*h[t.index(s,n)];for(m=-m/this.QR[this.matrix.index(r,r)],s=r;this.m>s;s++)h[t.index(s,n)]+=m*this.QR[this.matrix.index(s,r)]}for(r=this.n-1;r>=0;r--){for(n=0;e>n;n++)h[t.index(r,n)]/=this.Rdiag[r];for(s=0;r>s;s++)for(n=0;e>n;n++)h[t.index(s,n)]-=h[t.index(r,n)]*this.QR[this.matrix.index(s,r)]}return new i.Matrix(h,this.n,e).getMatrix(0,this.n-1,0,e-1)}},n}),s("DOT/Vector4",["require","ASSERT/assert","DOT/dot","DOT/Util"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot");t("DOT/Util"),s.Vector4=function n(t,i,s,n){this.x=t||0,this.y=i||0,this.z=s||0,this.w=void 0!==n?n:1};var n=s.Vector4;n.prototype={constructor:n,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)&&isFinite(this.w)},normalized:function(){var t=this.magnitude();if(0===t)throw Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t,this.w/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t,this.w*t)},times:function(t){return i&&i(void 0===t.dimension),this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z,this.w*t.w)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z,this.w+t.w)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t,this.w+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z,this.w-t.w)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t,this.w-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t,this.w/t)},negated:function(){return new n(-this.x,-this.y,-this.z,-this.w)},angleBetween:function(t){return Math.acos(s.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},toString:function(){return"Vector4("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},toVector3:function(){return new s.Vector3(this.x,this.y,this.z)},set:function(t,i,s,n){this.x=t,this.y=i,this.z=s,this.w=n},setX:function(t){this.x=t},setY:function(t){this.y=t},setZ:function(t){this.z=t},setW:function(t){this.w=t},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w},addScalar:function(t){this.x+=t,this.y+=t,this.z+=t,this.w+=t},subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w},subtractScalar:function(t){this.x-=t,this.y-=t,this.z-=t,this.w-=t},componentMultiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w},divideScalar:function(t){this.x/=t,this.y/=t,this.z/=t,this.w/=t},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},equalsEpsilon:function(t,i){return i||(i=0),i>=Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)+Math.abs(this.w-t.w)},isVector4:!0,dimension:4},n.Immutable=function(t,i,s,n){this.x=t||0,this.y=i||0,this.z=s||0,this.w=void 0!==n?n:1};var r=n.Immutable;return r.prototype=new n,r.prototype.constructor=r,r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw Error("Cannot call mutable method '"+t+"' on immutable Vector4")}},r.mutableOverrideHelper("set"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("setZ"),r.mutableOverrideHelper("setW"),r.mutableOverrideHelper("copy"),r.mutableOverrideHelper("add"),r.mutableOverrideHelper("addScalar"),r.mutableOverrideHelper("subtract"),r.mutableOverrideHelper("subtractScalar"),r.mutableOverrideHelper("componentMultiply"),r.mutableOverrideHelper("divideScalar"),r.mutableOverrideHelper("negate"),n.ZERO=new r(0,0,0,0),n.X_UNIT=new r(1,0,0,0),n.Y_UNIT=new r(0,1,0,0),n.Z_UNIT=new r(0,0,1,0),n.W_UNIT=new r(0,0,0,1),n}),s("DOT/Vector3",["require","ASSERT/assert","DOT/dot","DOT/Util","DOT/Vector2","DOT/Vector4"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot");t("DOT/Util"),t("DOT/Vector2"),t("DOT/Vector4"),s.Vector3=function n(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0};var n=s.Vector3;n.prototype={constructor:n,magnitude:function(){return Math.sqrt(this.magnitudeSquared())},magnitudeSquared:function(){return this.dot(this)},distance:function(t){return this.minus(t).magnitude()},distanceSquared:function(t){return this.minus(t).magnitudeSquared()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},isFinite:function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},cross:function(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)},normalized:function(){var t=this.magnitude();if(0===t)throw Error("Cannot normalize a zero-magnitude vector");return new n(this.x/t,this.y/t,this.z/t)},timesScalar:function(t){return new n(this.x*t,this.y*t,this.z*t)},times:function(t){return i&&i(void 0===t.dimension),this.timesScalar(t)},componentTimes:function(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)},plus:function(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)},plusScalar:function(t){return new n(this.x+t,this.y+t,this.z+t)},minus:function(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)},minusScalar:function(t){return new n(this.x-t,this.y-t,this.z-t)},dividedScalar:function(t){return new n(this.x/t,this.y/t,this.z/t)},negated:function(){return new n(-this.x,-this.y,-this.z)},angleBetween:function(t){return Math.acos(s.clamp(this.normalized().dot(t.normalized()),-1,1))},blend:function(t,i){return this.plus(t.minus(this).times(i))},toString:function(){return"Vector3("+this.x+", "+this.y+", "+this.z+")"},toVector2:function(){return new s.Vector2(this.x,this.y)},toVector4:function(){return new s.Vector4(this.x,this.y,this.z)},set:function(t,i,s){this.x=t,this.y=i,this.z=s},setX:function(t){this.x=t},setY:function(t){this.y=t},setZ:function(t){this.z=t},copy:function(t){this.x=t.x,this.y=t.y,this.z=t.z},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},addScalar:function(t){this.x+=t,this.y+=t,this.z+=t},subtract:function(t){this.x-=t.x,this.y-=t.y,this.z-=t.z},subtractScalar:function(t){this.x-=t,this.y-=t,this.z-=t},componentMultiply:function(t){this.x*=t.x,this.y*=t.y,this.z*=t.z},divideScalar:function(t){this.x/=t,this.y/=t,this.z/=t},negate:function(){this.x=-this.x,this.y=-this.y,this.z=-this.z},equals:function(t){return this.x===t.x&&this.y===t.y&&this.z===t.z},equalsEpsilon:function(t,i){return i||(i=0),i>=Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},isVector3:!0,dimension:3},n.Immutable=function(t,i,s){this.x=t||0,this.y=i||0,this.z=s||0};var r=n.Immutable;return r.prototype=new n,r.prototype.constructor=r,r.mutableOverrideHelper=function(t){r.prototype[t]=function(){throw Error("Cannot call mutable method '"+t+"' on immutable Vector3")
}},r.mutableOverrideHelper("set"),r.mutableOverrideHelper("setX"),r.mutableOverrideHelper("setY"),r.mutableOverrideHelper("setZ"),r.mutableOverrideHelper("copy"),r.mutableOverrideHelper("add"),r.mutableOverrideHelper("addScalar"),r.mutableOverrideHelper("subtract"),r.mutableOverrideHelper("subtractScalar"),r.mutableOverrideHelper("componentMultiply"),r.mutableOverrideHelper("divideScalar"),r.mutableOverrideHelper("negate"),n.ZERO=new r(0,0,0),n.X_UNIT=new r(1,0,0),n.Y_UNIT=new r(0,1,0),n.Z_UNIT=new r(0,0,1),n}),s("DOT/Matrix",["require","ASSERT/assert","DOT/dot","PHET_CORE/isArray","DOT/SingularValueDecomposition","DOT/LUDecomposition","DOT/QRDecomposition","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot"),n=window.Float32Array||Array,r=t("PHET_CORE/isArray");t("DOT/SingularValueDecomposition"),t("DOT/LUDecomposition"),t("DOT/QRDecomposition"),t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Vector4"),s.Matrix=function e(t,s,e,h){this.m=t,this.n=s;var m=t*s;this.size=m;var o;if(h)this.entries=e;else if(e||(e=0),this.entries=new n(m),r(e))for(i&&i(e.length===m),o=0;m>o;o++)this.entries[o]=e[o];else for(o=0;m>o;o++)this.entries[o]=e};var e=s.Matrix;return e.hypot=function(t,i){var s;return Math.abs(t)>Math.abs(i)?(s=i/t,s=Math.abs(t)*Math.sqrt(1+s*s)):0!==i?(s=t/i,s=Math.abs(i)*Math.sqrt(1+s*s)):s=0,s},e.prototype={constructor:e,copy:function(){for(var t=new e(this.m,this.n),i=0;this.size>i;i++)t.entries[i]=this.entries[i];return t},getArray:function(){return this.entries},getArrayCopy:function(){return new n(this.entries)},getRowDimension:function(){return this.m},getColumnDimension:function(){return this.n},index:function(t,i){return t*this.n+i},get:function(t,i){return this.entries[this.index(t,i)]},set:function(t,i,s){this.entries[this.index(t,i)]=s},getMatrix:function(t,i,s,n){for(var r=new e(i-t+1,n-s+1),h=t;i>=h;h++)for(var m=s;n>=m;m++)r.entries[r.index(h-t,m-s)]=this.entries[this.index(h,m)];return r},getArrayRowMatrix:function(t,i,s){for(var n=new e(t.length,s-i+1),r=0;t.length>r;r++)for(var h=i;s>=h;h++)n.entries[n.index(r,h-i)]=this.entries[this.index(t[r],h)];return n},transpose:function(){for(var t=new e(this.n,this.m),i=0;this.m>i;i++)for(var s=0;this.n>s;s++)t.entries[t.index(s,i)]=this.entries[this.index(i,s)];return t},norm1:function(){for(var t=0,i=0;this.n>i;i++){for(var s=0,n=0;this.m>n;n++)s+=Math.abs(this.entries[this.index(n,i)]);t=Math.max(t,s)}return t},norm2:function(){return new s.SingularValueDecomposition(this).norm2()},normInf:function(){for(var t=0,i=0;this.m>i;i++){for(var s=0,n=0;this.n>n;n++)s+=Math.abs(this.entries[this.index(i,n)]);t=Math.max(t,s)}return t},normF:function(){for(var t=0,i=0;this.m>i;i++)for(var s=0;this.n>s;s++)t=e.hypot(t,this.entries[this.index(i,s)]);return t},uminus:function(){for(var t=new e(this.m,this.n),i=0;this.m>i;i++)for(var s=0;this.n>s;s++)t.entries[t.index(i,s)]=-this.entries[this.index(i,s)];return t},plus:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++){var r=i.index(s,n);i.entries[r]=this.entries[r]+t.entries[r]}return i},plusEquals:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++){var r=i.index(s,n);this.entries[r]=this.entries[r]+t.entries[r]}return this},minus:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++){var r=this.index(s,n);i.entries[r]=this.entries[r]-t.entries[r]}return i},minusEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;this.m>i;i++)for(var s=0;this.n>s;s++){var n=this.index(i,s);this.entries[n]=this.entries[n]-t.entries[n]}return this},arrayTimes:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++){var r=i.index(s,n);i.entries[r]=this.entries[r]*t.entries[r]}return i},arrayTimesEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;this.m>i;i++)for(var s=0;this.n>s;s++){var n=this.index(i,s);this.entries[n]=this.entries[n]*t.entries[n]}return this},arrayRightDivide:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++){var r=this.index(s,n);i.entries[r]=this.entries[r]/t.entries[r]}return i},arrayRightDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;this.m>i;i++)for(var s=0;this.n>s;s++){var n=this.index(i,s);this.entries[n]=this.entries[n]/t.entries[n]}return this},arrayLeftDivide:function(t){this.checkMatrixDimensions(t);for(var i=new e(this.m,this.n),s=0;this.m>s;s++)for(var n=0;this.n>n;n++){var r=this.index(s,n);i.entries[r]=t.entries[r]/this.entries[r]}return i},arrayLeftDivideEquals:function(t){this.checkMatrixDimensions(t);for(var i=0;this.m>i;i++)for(var s=0;this.n>s;s++){var n=this.index(i,s);this.entries[n]=t.entries[n]/this.entries[n]}return this},times:function(t){var i,s,r,h,m,o;if(t.isMatrix){if(o=t,o.m!==this.n)throw Error("Matrix inner dimensions must agree.");i=new e(this.m,o.n);var a=new n(this.n);for(r=0;o.n>r;r++){for(h=0;this.n>h;h++)a[h]=o.entries[o.index(h,r)];for(s=0;this.m>s;s++){for(m=0,h=0;this.n>h;h++)m+=this.entries[this.index(s,h)]*a[h];i.entries[i.index(s,r)]=m}}return i}for(m=t,i=new e(this.m,this.n),s=0;this.m>s;s++)for(r=0;this.n>r;r++)i.entries[i.index(s,r)]=m*this.entries[this.index(s,r)];return i},timesEquals:function(t){for(var i=0;this.m>i;i++)for(var s=0;this.n>s;s++){var n=this.index(i,s);this.entries[n]=t*this.entries[n]}return this},solve:function(t){return this.m===this.n?new s.LUDecomposition(this).solve(t):new s.QRDecomposition(this).solve(t)},solveTranspose:function(t){return this.transpose().solve(t.transpose())},inverse:function(){return this.solve(e.identity(this.m,this.m))},det:function(){return new s.LUDecomposition(this).det()},rank:function(){return new s.SingularValueDecomposition(this).rank()},cond:function(){return new s.SingularValueDecomposition(this).cond()},trace:function(){for(var t=0,i=0;Math.min(this.m,this.n)>i;i++)t+=this.entries[this.index(i,i)];return t},checkMatrixDimensions:function(t){if(t.m!==this.m||t.n!==this.n)throw Error("Matrix dimensions must agree.")},toString:function(){var t="";t+="dim: "+this.getRowDimension()+"x"+this.getColumnDimension()+"\n";for(var i=0;this.getRowDimension()>i;i++){for(var s=0;this.getColumnDimension()>s;s++)t+=this.get(i,s)+" ";t+="\n"}return t},extractVector2:function(t){return i&&i(2===this.m),new s.Vector2(this.get(0,t),this.get(1,t))},extractVector3:function(t){return i&&i(3===this.m),new s.Vector3(this.get(0,t),this.get(1,t),this.get(2,t))},extractVector4:function(t){return i&&i(4===this.m),new s.Vector4(this.get(0,t),this.get(1,t),this.get(2,t),this.get(3,t))},isMatrix:!0},e.identity=function(t,i){for(var s=new e(t,i),n=0;t>n;n++)for(var r=0;i>r;r++)s.entries[s.index(n,r)]=n===r?1:0;return s},e.rowVector2=function(t){return new e(1,2,[t.x,t.y])},e.rowVector3=function(t){return new e(1,3,[t.x,t.y,t.z])},e.rowVector4=function(t){return new e(1,4,[t.x,t.y,t.z,t.w])},e.rowVector=function(t){if(t.isVector2)return e.rowVector2(t);if(t.isVector3)return e.rowVector3(t);if(t.isVector4)return e.rowVector4(t);throw Error("undetected type of vector: "+(""+t))},e.columnVector2=function(t){return new e(2,1,[t.x,t.y])},e.columnVector3=function(t){return new e(3,1,[t.x,t.y,t.z])},e.columnVector4=function(t){return new e(4,1,[t.x,t.y,t.z,t.w])},e.columnVector=function(t){if(t.isVector2)return e.columnVector2(t);if(t.isVector3)return e.columnVector3(t);if(t.isVector4)return e.columnVector4(t);throw Error("undetected type of vector: "+(""+t))},e.fromVectors2=function(t){for(var i=2,s=t.length,r=new n(i*s),h=0;s>h;h++){var m=t[h];r[h]=m.x,r[h+s]=m.y}return new e(i,s,r,!0)},e.fromVectors3=function(t){for(var i=3,s=t.length,r=new n(i*s),h=0;s>h;h++){var m=t[h];r[h]=m.x,r[h+s]=m.y,r[h+2*s]=m.z}return new e(i,s,r,!0)},e.fromVectors4=function(t){for(var i=4,s=t.length,r=new n(i*s),h=0;s>h;h++){var m=t[h];r[h]=m.x,r[h+s]=m.y,r[h+2*s]=m.z,r[h+3*s]=m.w}return new e(i,s,r,!0)},e}),s("DOT/Matrix4",["require","DOT/dot","DOT/Vector3","DOT/Vector4"],function(t){var i=t("DOT/dot");t("DOT/Vector3"),t("DOT/Vector4");var s=window.Float32Array||Array;i.Matrix4=function n(t,i,n,r,e,h,m,o,a,u,c,f,x,l,d,y,p){this.entries=new s(16),this.rowMajor(void 0===t?1:t,i||0,n||0,r||0,e||0,void 0===h?1:h,m||0,o||0,a||0,u||0,void 0===c?1:c,f||0,x||0,l||0,d||0,void 0===y?1:y,p)};var n=i.Matrix4;n.Types={OTHER:0,IDENTITY:1,TRANSLATION_3D:2,SCALING:3};var r=n.Types;return n.identity=function(){return new n(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,r.IDENTITY)},n.translation=function(t,i,s){return new n(1,0,0,t,0,1,0,i,0,0,1,s,0,0,0,1,r.TRANSLATION_3D)},n.translationFromVector=function(t){return n.translation(t.x,t.y,t.z)},n.scaling=function(t,i,s){return i=void 0===i?t:i,s=void 0===s?t:s,new n(t,0,0,0,0,i,0,0,0,0,s,0,0,0,0,1,r.SCALING)},n.rotationAxisAngle=function(t,i){var s=Math.cos(i),e=Math.sin(i),h=1-s;return new n(t.x*t.x*h+s,t.x*t.y*h-t.z*e,t.x*t.z*h+t.y*e,0,t.y*t.x*h+t.z*e,t.y*t.y*h+s,t.y*t.z*h-t.x*e,0,t.z*t.x*h-t.y*e,t.z*t.y*h+t.x*e,t.z*t.z*h+s,0,0,0,0,1,r.OTHER)},n.rotationX=function(t){var i=Math.cos(t),s=Math.sin(t);return new n(1,0,0,0,0,i,-s,0,0,s,i,0,0,0,0,1,r.OTHER)},n.rotationY=function(t){var i=Math.cos(t),s=Math.sin(t);return new n(i,0,s,0,0,1,0,0,-s,0,i,0,0,0,0,1,r.OTHER)},n.rotationZ=function(t){var i=Math.cos(t),s=Math.sin(t);return new n(i,-s,0,0,s,i,0,0,0,0,1,0,0,0,0,1,r.OTHER)},n.gluPerspective=function(t,i,s,r){var e=Math.cos(t)/Math.sin(t);return new n(e/i,0,0,0,0,e,0,0,0,0,(r+s)/(s-r),2*r*s/(s-r),0,0,-1,0)},n.prototype={constructor:n,rowMajor:function(t,i,s,n,e,h,m,o,a,u,c,f,x,l,d,y,p){this.entries[0]=t,this.entries[1]=e,this.entries[2]=a,this.entries[3]=x,this.entries[4]=i,this.entries[5]=h,this.entries[6]=u,this.entries[7]=l,this.entries[8]=s,this.entries[9]=m,this.entries[10]=c,this.entries[11]=d,this.entries[12]=n,this.entries[13]=o,this.entries[14]=f,this.entries[15]=y,this.type=void 0===p?r.OTHER:p},columnMajor:function(t,i,s,n,r,e,h,m,o,a,u,c,f,x,l,d,y){this.rowMajor(t,r,o,f,i,e,a,x,s,h,u,l,n,m,c,d,y)},m00:function(){return this.entries[0]},m01:function(){return this.entries[4]},m02:function(){return this.entries[8]},m03:function(){return this.entries[12]},m10:function(){return this.entries[1]},m11:function(){return this.entries[5]},m12:function(){return this.entries[9]},m13:function(){return this.entries[13]},m20:function(){return this.entries[2]},m21:function(){return this.entries[6]},m22:function(){return this.entries[10]},m23:function(){return this.entries[14]},m30:function(){return this.entries[3]},m31:function(){return this.entries[7]},m32:function(){return this.entries[11]},m33:function(){return this.entries[15]},plus:function(t){return new n(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m03()+t.m03(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m13()+t.m13(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22(),this.m23()+t.m23(),this.m30()+t.m30(),this.m31()+t.m31(),this.m32()+t.m32(),this.m33()+t.m33())},minus:function(t){return new n(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m03()-t.m03(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m13()-t.m13(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22(),this.m23()-t.m23(),this.m30()-t.m30(),this.m31()-t.m31(),this.m32()-t.m32(),this.m33()-t.m33())},transposed:function(){return new n(this.m00(),this.m10(),this.m20(),this.m30(),this.m01(),this.m11(),this.m21(),this.m31(),this.m02(),this.m12(),this.m22(),this.m32(),this.m03(),this.m13(),this.m23(),this.m33())},negated:function(){return new n(-this.m00(),-this.m01(),-this.m02(),-this.m03(),-this.m10(),-this.m11(),-this.m12(),-this.m13(),-this.m20(),-this.m21(),-this.m22(),-this.m23(),-this.m30(),-this.m31(),-this.m32(),-this.m33())},inverted:function(){var t=this.determinant();if(0!==t)return new n((-this.m31()*this.m22()*this.m13()+this.m21()*this.m32()*this.m13()+this.m31()*this.m12()*this.m23()-this.m11()*this.m32()*this.m23()-this.m21()*this.m12()*this.m33()+this.m11()*this.m22()*this.m33())/t,(this.m31()*this.m22()*this.m03()-this.m21()*this.m32()*this.m03()-this.m31()*this.m02()*this.m23()+this.m01()*this.m32()*this.m23()+this.m21()*this.m02()*this.m33()-this.m01()*this.m22()*this.m33())/t,(-this.m31()*this.m12()*this.m03()+this.m11()*this.m32()*this.m03()+this.m31()*this.m02()*this.m13()-this.m01()*this.m32()*this.m13()-this.m11()*this.m02()*this.m33()+this.m01()*this.m12()*this.m33())/t,(this.m21()*this.m12()*this.m03()-this.m11()*this.m22()*this.m03()-this.m21()*this.m02()*this.m13()+this.m01()*this.m22()*this.m13()+this.m11()*this.m02()*this.m23()-this.m01()*this.m12()*this.m23())/t,(this.m30()*this.m22()*this.m13()-this.m20()*this.m32()*this.m13()-this.m30()*this.m12()*this.m23()+this.m10()*this.m32()*this.m23()+this.m20()*this.m12()*this.m33()-this.m10()*this.m22()*this.m33())/t,(-this.m30()*this.m22()*this.m03()+this.m20()*this.m32()*this.m03()+this.m30()*this.m02()*this.m23()-this.m00()*this.m32()*this.m23()-this.m20()*this.m02()*this.m33()+this.m00()*this.m22()*this.m33())/t,(this.m30()*this.m12()*this.m03()-this.m10()*this.m32()*this.m03()-this.m30()*this.m02()*this.m13()+this.m00()*this.m32()*this.m13()+this.m10()*this.m02()*this.m33()-this.m00()*this.m12()*this.m33())/t,(-this.m20()*this.m12()*this.m03()+this.m10()*this.m22()*this.m03()+this.m20()*this.m02()*this.m13()-this.m00()*this.m22()*this.m13()-this.m10()*this.m02()*this.m23()+this.m00()*this.m12()*this.m23())/t,(-this.m30()*this.m21()*this.m13()+this.m20()*this.m31()*this.m13()+this.m30()*this.m11()*this.m23()-this.m10()*this.m31()*this.m23()-this.m20()*this.m11()*this.m33()+this.m10()*this.m21()*this.m33())/t,(this.m30()*this.m21()*this.m03()-this.m20()*this.m31()*this.m03()-this.m30()*this.m01()*this.m23()+this.m00()*this.m31()*this.m23()+this.m20()*this.m01()*this.m33()-this.m00()*this.m21()*this.m33())/t,(-this.m30()*this.m11()*this.m03()+this.m10()*this.m31()*this.m03()+this.m30()*this.m01()*this.m13()-this.m00()*this.m31()*this.m13()-this.m10()*this.m01()*this.m33()+this.m00()*this.m11()*this.m33())/t,(this.m20()*this.m11()*this.m03()-this.m10()*this.m21()*this.m03()-this.m20()*this.m01()*this.m13()+this.m00()*this.m21()*this.m13()+this.m10()*this.m01()*this.m23()-this.m00()*this.m11()*this.m23())/t,(this.m30()*this.m21()*this.m12()-this.m20()*this.m31()*this.m12()-this.m30()*this.m11()*this.m22()+this.m10()*this.m31()*this.m22()+this.m20()*this.m11()*this.m32()-this.m10()*this.m21()*this.m32())/t,(-this.m30()*this.m21()*this.m02()+this.m20()*this.m31()*this.m02()+this.m30()*this.m01()*this.m22()-this.m00()*this.m31()*this.m22()-this.m20()*this.m01()*this.m32()+this.m00()*this.m21()*this.m32())/t,(this.m30()*this.m11()*this.m02()-this.m10()*this.m31()*this.m02()-this.m30()*this.m01()*this.m12()+this.m00()*this.m31()*this.m12()+this.m10()*this.m01()*this.m32()-this.m00()*this.m11()*this.m32())/t,(-this.m20()*this.m11()*this.m02()+this.m10()*this.m21()*this.m02()+this.m20()*this.m01()*this.m12()-this.m00()*this.m21()*this.m12()-this.m10()*this.m01()*this.m22()+this.m00()*this.m11()*this.m22())/t);throw Error("Matrix could not be inverted, determinant === 0")},timesMatrix:function(t){var i=r.OTHER;return this.type===r.TRANSLATION_3D&&t.type===r.TRANSLATION_3D&&(i=r.TRANSLATION_3D),this.type===r.SCALING&&t.type===r.SCALING&&(i=r.SCALING),this.type===r.IDENTITY&&(i=t.type),t.type===r.IDENTITY&&(i=this.type),new n(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20()+this.m03()*t.m30(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21()+this.m03()*t.m31(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22()+this.m03()*t.m32(),this.m00()*t.m03()+this.m01()*t.m13()+this.m02()*t.m23()+this.m03()*t.m33(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20()+this.m13()*t.m30(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21()+this.m13()*t.m31(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22()+this.m13()*t.m32(),this.m10()*t.m03()+this.m11()*t.m13()+this.m12()*t.m23()+this.m13()*t.m33(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20()+this.m23()*t.m30(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21()+this.m23()*t.m31(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22()+this.m23()*t.m32(),this.m20()*t.m03()+this.m21()*t.m13()+this.m22()*t.m23()+this.m23()*t.m33(),this.m30()*t.m00()+this.m31()*t.m10()+this.m32()*t.m20()+this.m33()*t.m30(),this.m30()*t.m01()+this.m31()*t.m11()+this.m32()*t.m21()+this.m33()*t.m31(),this.m30()*t.m02()+this.m31()*t.m12()+this.m32()*t.m22()+this.m33()*t.m32(),this.m30()*t.m03()+this.m31()*t.m13()+this.m32()*t.m23()+this.m33()*t.m33(),i)},timesVector4:function(t){var s=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z+this.m03()*t.w,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z+this.m13()*t.w,r=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z+this.m23()*t.w,e=this.m30()*t.x+this.m31()*t.y+this.m32()*t.z+this.m33()*t.w;return new i.Vector4(s,n,r,e)},timesVector3:function(t){return this.timesVector4(t.toVector4()).toVector3()},timesTransposeVector4:function(t){var s=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z+this.m30()*t.w,n=this.m01()*t.x+this.m11()*t.y+this.m21()*t.z+this.m31()*t.w,r=this.m02()*t.x+this.m12()*t.y+this.m22()*t.z+this.m32()*t.w,e=this.m03()*t.x+this.m13()*t.y+this.m23()*t.z+this.m33()*t.w;return new i.Vector4(s,n,r,e)},timesTransposeVector3:function(t){return this.timesTransposeVector4(t.toVector4()).toVector3()},timesRelativeVector3:function(t){var s=this.m00()*t.x+this.m10()*t.y+this.m20()*t.z,n=this.m01()*t.y+this.m11()*t.y+this.m21()*t.z,r=this.m02()*t.z+this.m12()*t.y+this.m22()*t.z;return new i.Vector3(s,n,r)},determinant:function(){return this.m03()*this.m12()*this.m21()*this.m30()-this.m02()*this.m13()*this.m21()*this.m30()-this.m03()*this.m11()*this.m22()*this.m30()+this.m01()*this.m13()*this.m22()*this.m30()+this.m02()*this.m11()*this.m23()*this.m30()-this.m01()*this.m12()*this.m23()*this.m30()-this.m03()*this.m12()*this.m20()*this.m31()+this.m02()*this.m13()*this.m20()*this.m31()+this.m03()*this.m10()*this.m22()*this.m31()-this.m00()*this.m13()*this.m22()*this.m31()-this.m02()*this.m10()*this.m23()*this.m31()+this.m00()*this.m12()*this.m23()*this.m31()+this.m03()*this.m11()*this.m20()*this.m32()-this.m01()*this.m13()*this.m20()*this.m32()-this.m03()*this.m10()*this.m21()*this.m32()+this.m00()*this.m13()*this.m21()*this.m32()+this.m01()*this.m10()*this.m23()*this.m32()-this.m00()*this.m11()*this.m23()*this.m32()-this.m02()*this.m11()*this.m20()*this.m33()+this.m01()*this.m12()*this.m20()*this.m33()+this.m02()*this.m10()*this.m21()*this.m33()-this.m00()*this.m12()*this.m21()*this.m33()-this.m01()*this.m10()*this.m22()*this.m33()+this.m00()*this.m11()*this.m22()*this.m33()},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+" "+this.m03()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+" "+this.m13()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()+" "+this.m23()+"\n"+this.m30()+" "+this.m31()+" "+this.m32()+" "+this.m33()},translation:function(){return new i.Vector3(this.m03(),this.m13(),this.m23())},scaling:function(){return new i.Vector3(this.m00(),this.m11(),this.m22())},makeImmutable:function(){this.rowMajor=function(){throw Error("Cannot modify immutable matrix")}}},n.IDENTITY=new n,n.IDENTITY.makeImmutable(),n}),s("DOT/Matrix3",["require","DOT/dot","DOT/Vector2","DOT/Vector3","DOT/Matrix4"],function(t){var i=t("DOT/dot");t("DOT/Vector2"),t("DOT/Vector3"),t("DOT/Matrix4"),i.Matrix3=function s(t,i,s,n,r,e,h,m,o,a){this.entries=Array(9),this.rowMajor(void 0===t?1:t,i||0,s||0,n||0,void 0===r?1:r,e||0,h||0,m||0,void 0===o?1:o,a)};var s=i.Matrix3;s.Types={OTHER:0,IDENTITY:1,TRANSLATION_2D:2,SCALING:3,AFFINE:4};var n=s.Types;return s.identity=function(){return new s(1,0,0,0,1,0,0,0,1,n.IDENTITY)},s.translation=function(t,i){return new s(1,0,t,0,1,i,0,0,1,n.TRANSLATION_2D)},s.translationFromVector=function(t){return s.translation(t.x,t.y)},s.scaling=function(t,i){return i=void 0===i?t:i,new s(t,0,0,0,i,0,0,0,1,n.SCALING)},s.scale=s.scaling,s.affine=function(t,i,r,e,h,m){return new s(t,r,h,i,e,m,0,0,1,n.AFFINE)},s.rotationAxisAngle=function(t,i){var r=Math.cos(i),e=Math.sin(i),h=1-r;return new s(t.x*t.x*h+r,t.x*t.y*h-t.z*e,t.x*t.z*h+t.y*e,t.y*t.x*h+t.z*e,t.y*t.y*h+r,t.y*t.z*h-t.x*e,t.z*t.x*h-t.y*e,t.z*t.y*h+t.x*e,t.z*t.z*h+r,n.OTHER)},s.rotationX=function(t){var i=Math.cos(t),r=Math.sin(t);return new s(1,0,0,0,i,-r,0,r,i,n.OTHER)},s.rotationY=function(t){var i=Math.cos(t),r=Math.sin(t);return new s(i,0,r,0,1,0,-r,0,i,n.OTHER)},s.rotationZ=function(t){var i=Math.cos(t),r=Math.sin(t);return new s(i,-r,0,r,i,0,0,0,1,n.AFFINE)},s.rotation2=s.rotationZ,s.fromSVGMatrix=function(t){return new s(t.a,t.c,t.e,t.b,t.d,t.f,0,0,1,n.AFFINE)},s.rotateAToB=function(t,n){var r,e,h,m=t,o=n,a=1e-4,u=m.cross(o);if(r=m.dot(o),h=0>r?-r:r,h>1-a){var c,f,x,l=new i.Vector3(m.x>0?m.x:-m.x,m.y>0?m.y:-m.y,m.z>0?m.z:-m.z);l=l.x<l.y?l.x<l.z?i.Vector3.X_UNIT:i.Vector3.Z_UNIT:l.y<l.z?i.Vector3.Y_UNIT:i.Vector3.Z_UNIT;var d=l.minus(m);return u=l.minus(o),c=2/d.dot(d),f=2/u.dot(u),x=c*f*d.dot(u),s.IDENTITY.plus(s.rowMajor(-c*d.x*d.x-f*u.x*u.x+x*u.x*d.x,-c*d.x*d.y-f*u.x*u.y+x*u.x*d.y,-c*d.x*d.z-f*u.x*u.z+x*u.x*d.z,-c*d.y*d.x-f*u.y*u.x+x*u.y*d.x,-c*d.y*d.y-f*u.y*u.y+x*u.y*d.y,-c*d.y*d.z-f*u.y*u.z+x*u.y*d.z,-c*d.z*d.x-f*u.z*u.x+x*u.z*d.x,-c*d.z*d.y-f*u.z*u.y+x*u.z*d.y,-c*d.z*d.z-f*u.z*u.z+x*u.z*d.z))}var y,p,v,T,w;return e=1/(1+r),y=e*u.x,p=e*u.z,v=y*u.y,T=y*u.z,w=p*u.y,s.rowMajor(r+y*u.x,v-u.z,T+u.y,v+u.z,r+e*u.y*u.y,w-u.x,T-u.y,w+u.x,r+p*u.z)},s.prototype={constructor:s,m00:function(){return this.entries[0]},m01:function(){return this.entries[3]},m02:function(){return this.entries[6]},m10:function(){return this.entries[1]},m11:function(){return this.entries[4]},m12:function(){return this.entries[7]},m20:function(){return this.entries[2]},m21:function(){return this.entries[5]},m22:function(){return this.entries[8]},isAffine:function(){return this.type===n.AFFINE||0===this.m20()&&0===this.m21()&&1===this.m22()},getDeterminant:function(){return this.m00()*this.m11()*this.m22()+this.m01()*this.m12()*this.m20()+this.m02()*this.m10()*this.m21()-this.m02()*this.m11()*this.m20()-this.m01()*this.m10()*this.m22()-this.m00()*this.m12()*this.m21()},get determinant(){return this.getDeterminant()},getTranslation:function(){return new i.Vector2(this.m02(),this.m12())},get translation(){return this.getTranslation()},getScaleVector:function(){return new i.Vector2(Math.sqrt(this.m00()*this.m00()+this.m10()*this.m10()),Math.sqrt(this.m01()*this.m01()+this.m11()*this.m11()))},get scaleVector(){return this.getScaleVector()},getRotation:function(){var t=this.timesVector2(i.Vector2.X_UNIT).minus(this.timesVector2(i.Vector2.ZERO));return Math.atan2(t.y,t.x)},get rotation(){return this.getRotation()},toMatrix4:function(){return new i.Matrix4(this.m00(),this.m01(),this.m02(),0,this.m10(),this.m11(),this.m12(),0,this.m20(),this.m21(),this.m22(),0,0,0,0,1)},toString:function(){return this.m00()+" "+this.m01()+" "+this.m02()+"\n"+this.m10()+" "+this.m11()+" "+this.m12()+"\n"+this.m20()+" "+this.m21()+" "+this.m22()},toSVGMatrix:function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix();return t.a=this.m00(),t.b=this.m10(),t.c=this.m01(),t.d=this.m11(),t.e=this.m02(),t.f=this.m12(),t},getCSSTransform:function(){function t(t){return t.toFixed(20)}return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"},get cssTransform(){return this.getCSSTransform()},getSVGTransform:function(){function t(t){return t.toFixed(20)}switch(this.type){case n.IDENTITY:return"";case n.TRANSLATION_2D:return"translate("+t(this.entries[6])+","+this.entries[7]+")";case n.SCALING:return"scale("+t(this.entries[0])+(this.entries[0]===this.entries[4]?"":","+t(this.entries[4]))+")";default:return"matrix("+t(this.entries[0])+","+t(this.entries[1])+","+t(this.entries[3])+","+t(this.entries[4])+","+t(this.entries[6])+","+t(this.entries[7])+")"}},get svgTransform(){return this.getSVGTransform()},getCSSTransformStyles:function(){var t=this.getCSSTransform();return{"-webkit-perspective":1e3,"-webkit-backface-visibility":"hidden","-webkit-transform":t+" translateZ(0)","-moz-transform":t+" translateZ(0)","-ms-transform":t,"-o-transform":t,transform:t,"transform-origin":"top left","-ms-transform-origin":"top left"}},get cssTransformStyles(){return this.getCSSTransformStyles()},equals:function(t){return this.m00()===t.m00()&&this.m01()===t.m01()&&this.m02()===t.m02()&&this.m10()===t.m10()&&this.m11()===t.m11()&&this.m12()===t.m12()&&this.m20()===t.m20()&&this.m21()===t.m21()&&this.m22()===t.m22()},equalsEpsilon:function(t,i){return i>Math.abs(this.m00()-t.m00())&&i>Math.abs(this.m01()-t.m01())&&i>Math.abs(this.m02()-t.m02())&&i>Math.abs(this.m10()-t.m10())&&i>Math.abs(this.m11()-t.m11())&&i>Math.abs(this.m12()-t.m12())&&i>Math.abs(this.m20()-t.m20())&&i>Math.abs(this.m21()-t.m21())&&i>Math.abs(this.m22()-t.m22())},copy:function(){return new s(this.m00(),this.m01(),this.m02(),this.m10(),this.m11(),this.m12(),this.m20(),this.m21(),this.m22(),this.type)},plus:function(t){return new s(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},minus:function(t){return new s(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transposed:function(){return new s(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===n.IDENTITY||this.type===n.SCALING?this.type:void 0)},negated:function(){return new s(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},inverted:function(){var t;switch(this.type){case n.IDENTITY:return this;case n.TRANSLATION_2D:return new s(1,0,-this.m02(),0,1,-this.m12(),0,0,1,n.TRANSLATION_2D);case n.SCALING:return new s(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),n.SCALING);case n.AFFINE:if(t=this.getDeterminant(),0!==t)return new s((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,n.AFFINE);throw Error("Matrix could not be inverted, determinant === 0");case n.OTHER:if(t=this.getDeterminant(),0!==t)return new s((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,n.OTHER);throw Error("Matrix could not be inverted, determinant === 0");default:throw Error("Matrix3.inverted with unknown type: "+this.type)}},timesMatrix:function(t){if(this.type===n.IDENTITY||t.type===n.IDENTITY)return this.type===n.IDENTITY?t:this;if(this.type===t.type){if(this.type===n.TRANSLATION_2D)return new s(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,n.TRANSLATION_2D);if(this.type===n.SCALING)return new s(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,n.SCALING)}return this.type!==n.OTHER&&t.type!==n.OTHER?new s(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,n.AFFINE):new s(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},timesVector2:function(t){var s=this.m00()*t.x+this.m01()*t.y+this.m02(),n=this.m10()*t.x+this.m11()*t.y+this.m12();return new i.Vector2(s,n)},timesVector3:function(t){var s=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,n=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,r=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return new i.Vector3(s,n,r)},timesTransposeVector2:function(t){var s=this.m00()*t.x+this.m10()*t.y,n=this.m01()*t.x+this.m11()*t.y;return new i.Vector2(s,n)},timesRelativeVector2:function(t){var s=this.m00()*t.x+this.m01()*t.y,n=this.m10()*t.y+this.m11()*t.y;return new i.Vector2(s,n)},makeImmutable:function(){return this.rowMajor=function(){throw Error("Cannot modify immutable matrix")},this},rowMajor:function(t,i,s,r,e,h,m,o,a,u){return this.entries[0]=t,this.entries[1]=r,this.entries[2]=m,this.entries[3]=i,this.entries[4]=e,this.entries[5]=o,this.entries[6]=s,this.entries[7]=h,this.entries[8]=a,this.type=void 0===u?0===m&&0===o&&1===a?n.AFFINE:n.OTHER:u,this},columnMajor:function(t,i,s,n,r,e,h,m,o,a){return this.rowMajor(t,n,h,i,r,m,s,e,o,a)},add:function(t){return this.rowMajor(this.m00()+t.m00(),this.m01()+t.m01(),this.m02()+t.m02(),this.m10()+t.m10(),this.m11()+t.m11(),this.m12()+t.m12(),this.m20()+t.m20(),this.m21()+t.m21(),this.m22()+t.m22())},subtract:function(t){return this.rowMajor(this.m00()-t.m00(),this.m01()-t.m01(),this.m02()-t.m02(),this.m10()-t.m10(),this.m11()-t.m11(),this.m12()-t.m12(),this.m20()-t.m20(),this.m21()-t.m21(),this.m22()-t.m22())},transpose:function(){return this.rowMajor(this.m00(),this.m10(),this.m20(),this.m01(),this.m11(),this.m21(),this.m02(),this.m12(),this.m22(),this.type===n.IDENTITY||this.type===n.SCALING?this.type:void 0)},negate:function(){return this.rowMajor(-this.m00(),-this.m01(),-this.m02(),-this.m10(),-this.m11(),-this.m12(),-this.m20(),-this.m21(),-this.m22())},invert:function(){var t;switch(this.type){case n.IDENTITY:return this;case n.TRANSLATION_2D:return this.rowMajor(1,0,-this.m02(),0,1,-this.m12(),0,0,1,n.TRANSLATION_2D);case n.SCALING:return this.rowMajor(1/this.m00(),0,0,0,1/this.m11(),0,0,0,1/this.m22(),n.SCALING);case n.AFFINE:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,0,0,1,n.AFFINE);throw Error("Matrix could not be inverted, determinant === 0");case n.OTHER:if(t=this.getDeterminant(),0!==t)return this.rowMajor((-this.m12()*this.m21()+this.m11()*this.m22())/t,(this.m02()*this.m21()-this.m01()*this.m22())/t,(-this.m02()*this.m11()+this.m01()*this.m12())/t,(this.m12()*this.m20()-this.m10()*this.m22())/t,(-this.m02()*this.m20()+this.m00()*this.m22())/t,(this.m02()*this.m10()-this.m00()*this.m12())/t,(-this.m11()*this.m20()+this.m10()*this.m21())/t,(this.m01()*this.m20()-this.m00()*this.m21())/t,(-this.m01()*this.m10()+this.m00()*this.m11())/t,n.OTHER);throw Error("Matrix could not be inverted, determinant === 0");default:throw Error("Matrix3.inverted with unknown type: "+this.type)}},multiplyMatrix:function(t){if(this.type===n.IDENTITY||t.type===n.IDENTITY)return this.type===n.IDENTITY?t:this;if(this.type===t.type){if(this.type===n.TRANSLATION_2D)return this.rowMajor(1,0,this.m02()+t.m02(),0,1,this.m12()+t.m12(),0,0,1,n.TRANSLATION_2D);if(this.type===n.SCALING)return this.rowMajor(this.m00()*t.m00(),0,0,0,this.m11()*t.m11(),0,0,0,1,n.SCALING)
}return this.type!==n.OTHER&&t.type!==n.OTHER?this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10(),this.m00()*t.m01()+this.m01()*t.m11(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02(),this.m10()*t.m00()+this.m11()*t.m10(),this.m10()*t.m01()+this.m11()*t.m11(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12(),0,0,1,n.AFFINE):this.rowMajor(this.m00()*t.m00()+this.m01()*t.m10()+this.m02()*t.m20(),this.m00()*t.m01()+this.m01()*t.m11()+this.m02()*t.m21(),this.m00()*t.m02()+this.m01()*t.m12()+this.m02()*t.m22(),this.m10()*t.m00()+this.m11()*t.m10()+this.m12()*t.m20(),this.m10()*t.m01()+this.m11()*t.m11()+this.m12()*t.m21(),this.m10()*t.m02()+this.m11()*t.m12()+this.m12()*t.m22(),this.m20()*t.m00()+this.m21()*t.m10()+this.m22()*t.m20(),this.m20()*t.m01()+this.m21()*t.m11()+this.m22()*t.m21(),this.m20()*t.m02()+this.m21()*t.m12()+this.m22()*t.m22())},multiplyVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02(),s=this.m10()*t.x+this.m11()*t.y+this.m12();return t.setX(i),t.setY(s),t},multiplyVector3:function(t){var i=this.m00()*t.x+this.m01()*t.y+this.m02()*t.z,s=this.m10()*t.x+this.m11()*t.y+this.m12()*t.z,n=this.m20()*t.x+this.m21()*t.y+this.m22()*t.z;return t.setX(i),t.setY(s),t.setZ(n),t},multiplyTransposeVector2:function(t){var i=this.m00()*t.x+this.m10()*t.y,s=this.m01()*t.x+this.m11()*t.y;return t.setX(i),t.setY(s),t},multiplyRelativeVector2:function(t){var i=this.m00()*t.x+this.m01()*t.y,s=this.m10()*t.y+this.m11()*t.y;return t.setX(i),t.setY(s),t},canvasSetTransform:function(t){t.setTransform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])},canvasAppendTransform:function(t){this.type!==n.IDENTITY&&t.transform(this.entries[0],this.entries[1],this.entries[3],this.entries[4],this.entries[6],this.entries[7])}},s.IDENTITY=new s(1,0,0,0,1,0,0,0,1,n.IDENTITY),s.IDENTITY.makeImmutable(),s.X_REFLECTION=new s(-1,0,0,0,1,0,0,0,1,n.AFFINE),s.X_REFLECTION.makeImmutable(),s.Y_REFLECTION=new s(1,0,0,0,-1,0,0,0,1,n.AFFINE),s.Y_REFLECTION.makeImmutable(),s.printer={print:function(t){console.log(""+t)}},s}),s("DOT/Permutation",["require","ASSERT/assert","DOT/dot","PHET_CORE/isArray","DOT/Util"],function(t){function i(t,s,n){if(0===t.length)n.call(void 0,s);else for(var r=0;t.length>r;r++){var e=t[r],h=t.slice(0);h.splice(r,1);var m=s.slice(0);m.push(e),i(h,m,n)}}var s=t("ASSERT/assert")("dot"),n=t("DOT/dot"),r=t("PHET_CORE/isArray");t("DOT/Util");var e=function e(t){this.indices=t};return e.identity=function(t){s&&s(t>=0);for(var i=Array(t),n=0;t>n;n++)i[n]=n;return new e(i)},e.permutations=function(t){var i=[];return e.forEachPermutation(n.rangeInclusive(0,t-1),function(t){i.push(new e(t))}),i},e.forEachPermutation=function(t,s){i(t,[],s)},e.prototype={constructor:e,size:function(){return this.indices.length},apply:function(t){if(r(t)){if(t.length!==this.size())throw Error("Permutation length "+this.size()+" not equal to list length "+t.length);for(var i=Array(t.length),s=0;t.length>s;s++)i[s]=t[this.indices[s]];return i}return this.indices[t]},inverted:function(){for(var t=Array(this.size()),i=0;this.size()>i;i++)t[this.indices[i]]=i;return new e(t)},withIndicesPermuted:function(t){var i=[],s=this;return e.forEachPermutation(t,function(n){for(var r=s.indices,h=r.slice(0),m=0;t.length>m;m++)h[t[m]]=r[n[m]];i.push(new e(h))}),i},toString:function(){return"P["+this.indices.join(", ")+"]"}},e.testMe=function(t){var i=new e([1,4,3,2,0]);t.log(""+i);var s=i.inverted();t.log(""+s),t.log(""+s.withIndicesPermuted([0,3,4])),t.log(""+e.permutations(4))},e}),s("DOT/Ray2",["require","ASSERT/assert","DOT/dot"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot");s.Ray2=function n(t,s){this.pos=t,this.dir=s,i&&i(.01>Math.abs(s.magnitude()-1))};var n=s.Ray2;return n.prototype={constructor:n,shifted:function(t){return new n(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return""+this.pos+" => "+(""+this.dir)}},n}),s("DOT/Ray3",["require","DOT/dot"],function(t){var i=t("DOT/dot");i.Ray3=function s(t,i){this.pos=t,this.dir=i};var s=i.Ray3;return s.prototype={constructor:s,shifted:function(t){return new s(this.pointAtDistance(t),this.dir)},pointAtDistance:function(t){return this.pos.plus(this.dir.timesScalar(t))},toString:function(){return""+this.pos+" => "+(""+this.dir)}},s}),s("DOT/Transform3",["require","ASSERT/assert","DOT/dot","DOT/Matrix3","DOT/Vector2","DOT/Ray2"],function(t){var i=t("ASSERT/assert")("dot"),s=t("DOT/dot");t("DOT/Matrix3"),t("DOT/Vector2"),t("DOT/Ray2"),s.Transform3=function n(t){this.listeners=[],this.set(void 0===t?s.Matrix3.IDENTITY:t)};var n=s.Transform3;return n.prototype={constructor:n,set:function(t){i&&i(t instanceof s.Matrix3);var n,r=this.matrix,e=this.listeners.length;for(n=0;e>n;n++)this.listeners[n].before(t,r);for(this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null,n=0;e>n;n++)this.listeners[n].after(t,r)},prepend:function(t){this.set(t.timesMatrix(this.matrix))},append:function(t){this.set(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m02(),this.matrix.m12())},copy:function(){var t=new n(this.matrix);t.inverse=this.inverse,t.matrixTransposed=this.matrixTransposed,t.inverseTransposed=this.inverseTransposed},deepCopy:function(){var t=new n(this.matrix.copy());t.inverse=this.inverse?this.inverse.copy():null,t.matrixTransposed=this.matrixTransposed?this.matrixTransposed.copy():null,t.inverseTransposed=this.inverseTransposed?this.inverseTransposed.copy():null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},isIdentity:function(){return this.matrix.type===s.Matrix3.Types.IDENTITY},transformPosition2:function(t){return this.matrix.timesVector2(t)},transformDelta2:function(t){return this.transformPosition2(t).minus(this.transformPosition2(s.Vector2.ZERO))},transformNormal2:function(t){return this.getInverse().timesTransposeVector2(t)},transformDeltaX:function(t){return this.transformDelta2(new s.Vector2(t,0)).x},transformDeltaY:function(t){return this.transformDelta2(new s.Vector2(0,t)).y},transformBounds2:function(t){return t.transformed(this.matrix)},transformShape:function(t){return t.transformed(this.matrix)},transformRay2:function(t){return new s.Ray2(this.transformPosition2(t.pos),this.transformDelta2(t.dir).normalized())},inversePosition2:function(t){return this.getInverse().timesVector2(t)},inverseDelta2:function(t){return this.inversePosition2(t).minus(this.inversePosition2(s.Vector2.ZERO))},inverseNormal2:function(t){return this.matrix.timesTransposeVector2(t)},inverseDeltaX:function(t){return this.inverseDelta2(new s.Vector2(t,0)).x},inverseDeltaY:function(t){return this.inverseDelta2(new s.Vector2(0,t)).y},inverseBounds2:function(t){return t.transformed(this.getInverse())},inverseShape:function(t){return t.transformed(this.getInverse())},inverseRay2:function(t){return new s.Ray2(this.inversePosition2(t.pos),this.inverseDelta2(t.dir).normalized())},addTransformListener:function(t){i&&i(!_.contains(this.listeners,t)),this.listeners.push(t)},removeTransformListener:function(t){i&&i(_.contains(this.listeners,t)),this.listeners.splice(_.indexOf(this.listeners,t),1)}},n}),s("DOT/Transform4",["require","DOT/dot","DOT/Matrix4","DOT/Vector3","DOT/Ray3"],function(t){var i=t("DOT/dot");t("DOT/Matrix4"),t("DOT/Vector3"),t("DOT/Ray3"),i.Transform4=function s(t){this.set(void 0===t?i.Matrix4.IDENTITY:t)};var s=i.Transform4;return s.prototype={constructor:s,set:function(t){this.matrix=t,this.inverse=null,this.matrixTransposed=null,this.inverseTransposed=null},getMatrix:function(){return this.matrix},getInverse:function(){return null===this.inverse&&(this.inverse=this.matrix.inverted()),this.inverse},getMatrixTransposed:function(){return null===this.matrixTransposed&&(this.matrixTransposed=this.matrix.transposed()),this.matrixTransposed},getInverseTransposed:function(){return null===this.inverseTransposed&&(this.inverseTransposed=this.getInverse().transposed()),this.inverseTransposed},prepend:function(t){this.set(t.timesMatrix(this.matrix))},append:function(t){this.set(this.matrix.timesMatrix(t))},prependTransform:function(t){this.prepend(t.matrix)},appendTransform:function(t){this.append(t.matrix)},isIdentity:function(){return this.matrix.type===i.Matrix4.Types.IDENTITY},applyToCanvasContext:function(t){t.setTransform(this.matrix.m00(),this.matrix.m10(),this.matrix.m01(),this.matrix.m11(),this.matrix.m03(),this.matrix.m13())},transformPosition3:function(t){return this.matrix.timesVector3(t)},transformDelta3:function(t){return this.matrix.timesRelativeVector3(t)},transformNormal3:function(t){return this.getInverse().timesTransposeVector3(t)},transformDeltaX:function(t){return this.transformDelta3(new i.Vector3(t,0,0)).x},transformDeltaY:function(t){return this.transformDelta3(new i.Vector3(0,t,0)).y},transformDeltaZ:function(t){return this.transformDelta3(new i.Vector3(0,0,t)).z},transformRay:function(t){return new i.Ray3(this.transformPosition3(t.pos),this.transformPosition3(t.pos.plus(t.dir)).minus(this.transformPosition3(t.pos)))},inversePosition3:function(t){return this.getInverse().timesVector3(t)},inverseDelta3:function(t){return this.inversePosition3(t).minus(this.inversePosition3(i.Vector3.ZERO))},inverseNormal3:function(t){return this.matrix.timesTransposeVector3(t)},inverseDeltaX:function(t){return this.inverseDelta3(new i.Vector3(t,0,0)).x},inverseDeltaY:function(t){return this.inverseDelta3(new i.Vector3(0,t,0)).y},inverseDeltaZ:function(t){return this.inverseDelta3(new i.Vector3(0,0,t)).z},inverseRay:function(t){return new i.Ray3(this.inversePosition3(t.pos),this.inversePosition3(t.pos.plus(t.dir)).minus(this.inversePosition3(t.pos)))}},s}),s("main",["DOT/dot","DOT/Bounds2","DOT/Complex","DOT/ConvexHull2","DOT/Dimension2","DOT/LUDecomposition","DOT/Matrix","DOT/Matrix3","DOT/Matrix4","DOT/Permutation","DOT/QRDecomposition","DOT/Ray2","DOT/Ray3","DOT/SingularValueDecomposition","DOT/Transform3","DOT/Transform4","DOT/Util","DOT/Vector2","DOT/Vector3","DOT/Vector4"],function(t){return t}),s("PHET_CORE/callSuper",["require"],function(){function t(t,i,s){(function(){var s=t.prototype[i];Function.call.apply(s,arguments)})(s)}return t}),s("PHET_CORE/inheritPrototype",["require"],function(){function t(t,i){var s=Object(i.prototype);s.constructor=t,t.prototype=s}return t}),s("PHET_CORE/loadScript",["require"],function(){return function(t){"string"==typeof t&&(t={src:t});var i=t.src,s=t.callback,n=void 0===t.async?!0:t.async,r=void 0===t.cacheBuster?!1:t.cacheBuster,e=!1,h=document.createElement("script");h.type="text/javascript",h.async=n,h.onload=h.onreadystatechange=function(){var t=this.readyState;t&&"complete"!==t&&"loaded"!==t||e||(e=!0,s&&s())},h.src=i+(r?"?random="+Math.random().toFixed(10):"");var m=document.getElementsByTagName("script")[0];m.parentNode.insertBefore(h,m)}}),s("PHET_CORE/main",["require","PHET_CORE/callSuper","PHET_CORE/inherit","PHET_CORE/inheritPrototype","PHET_CORE/isArray","PHET_CORE/extend","PHET_CORE/loadScript"],function(t){return{callSuper:t("PHET_CORE/callSuper"),inherit:t("PHET_CORE/inherit"),inheritPrototype:t("PHET_CORE/inheritPrototype"),isArray:t("PHET_CORE/isArray"),extend:t("PHET_CORE/extend"),loadScript:t("PHET_CORE/loadScript")}}),window.has&&window.has.add("assert.dot",function(){return!1}),window.loadedDotConfig=!0,i.config({deps:["main","PHET_CORE/main"],paths:{underscore:"../contrib/lodash.min-1.0.0-rc.3",DOT:".",PHET_CORE:"../common/phet-core/js",ASSERT:"../common/assert/js"},shim:{underscore:{exports:"_"}},urlArgs:(new Date).getTime()}),s("production-config",function(){}),window.dot=i("main")})();
//@ sourceMappingURL=dot.min.js.map